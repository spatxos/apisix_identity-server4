{"plugins":{"identity-server4":{"priority":2599,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","dependencies":{"introspect_type":{"oneOf":[{"required":["introspect_type","public_key"],"properties":{"public_key":{"type":"string"},"introspect_type":{"type":"string","enum":["public_key"]}}},{"required":["introspect_type","identity_server_uri","apisix_api_secrets","apisix_api_name"],"properties":{"apisix_api_name":{"type":"string"},"introspect_type":{"type":"string","enum":["identity_server"]},"apisix_api_secrets":{"type":"string"},"identity_server_uri":{"type":"string"}}}]}},"required":["introspect_type"],"properties":{"disable":{"type":"boolean"},"identity_server_uri":{"type":"string","minItems":1},"apisix_api_name":{"type":"string","minItems":1},"apisix_api_secrets":{"type":"string","minItems":1},"public_key":{"type":"string","minItems":1},"introspect_type":{"type":"string","enum":["public_key","identity_server"]}}},"version":0.1,"type":"auth"},"openid-connect":{"priority":2599,"schema":{"type":"object","required":["client_id","client_secret","discovery"],"$comment":"this is a mark for our injected plugin schema","properties":{"scope":{"type":"string","default":"openid"},"introspection_endpoint_auth_method":{"type":"string","default":"client_secret_basic"},"bearer_only":{"type":"boolean","default":false},"realm":{"type":"string","default":"apisix"},"logout_path":{"type":"string","default":"\/logout"},"redirect_uri":{"type":"string","description":"use ngx.var.request_uri if not configured"},"token_signing_alg_values_expected":{"type":"string"},"set_access_token_header":{"description":"Whether the access token should be added as a header to the request for downstream","type":"boolean","default":true},"introspection_endpoint":{"type":"string"},"access_token_in_authorization_header":{"description":"Whether the access token should be added in the Authorization header as opposed to the X-Access-Token header.","type":"boolean","default":false},"client_id":{"type":"string"},"set_id_token_header":{"description":"Whether the ID token should be added in the X-ID-Token header to the request for downstream.","type":"boolean","default":true},"timeout":{"type":"integer","description":"timeout in seconds","default":3,"minimum":1},"disable":{"type":"boolean"},"ssl_verify":{"type":"boolean","default":false},"set_userinfo_header":{"description":"Whether the user info token should be added in the X-Userinfo header to the request for downstream.","type":"boolean","default":true},"discovery":{"type":"string"},"public_key":{"type":"string"},"client_secret":{"type":"string"}}},"version":0.1},"consumer-restriction":{"priority":2400,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","anyOf":[{"required":["blacklist"]},{"required":["whitelist"]},{"required":["allowed_by_methods"]}],"properties":{"type":{"type":"string","enum":["consumer_name","service_id"],"default":"consumer_name"},"blacklist":{"type":"array","items":{"type":"string"},"minItems":1},"whitelist":{"type":"array","items":{"type":"string"},"minItems":1},"disable":{"type":"boolean"},"allowed_by_methods":{"type":"array","items":{"type":"object","properties":{"user":{"type":"string"},"methods":{"type":"array","items":{"type":"string","enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE"]},"minItems":1}}}},"rejected_code":{"type":"integer","default":403,"minimum":200}}},"version":0.1},"tcp-logger":{"priority":405,"schema":{"type":"object","required":["host","port"],"$comment":"this is a mark for our injected plugin schema","properties":{"host":{"type":"string"},"disable":{"type":"boolean"},"timeout":{"type":"integer","default":1000,"minimum":1},"tls":{"type":"boolean","default":false},"name":{"type":"string","default":"tcp logger"},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"inactive_timeout":{"type":"integer","default":5,"minimum":1},"max_retry_count":{"type":"integer","default":0,"minimum":0},"retry_delay":{"type":"integer","default":1,"minimum":0},"buffer_duration":{"type":"integer","default":60,"minimum":1},"tls_options":{"type":"string"},"port":{"type":"integer","minimum":0},"include_req_body":{"type":"boolean","default":false}}},"version":0.1},"request-validation":{"priority":2800,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","anyOf":[{"title":"Body schema","required":["body_schema"],"properties":{"body_schema":{"type":"object"}}},{"title":"Header schema","required":["header_schema"],"properties":{"header_schema":{"type":"object"}}}],"properties":{"disable":{"type":"boolean"}}},"version":0.1,"type":"validation"},"grpc-transcode":{"priority":506,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["proto_id","service","method"],"additionalProperties":true,"properties":{"deadline":{"description":"deadline for grpc, millisecond","type":"number","default":0},"pb_option":{"type":"array","minItems":1,"items":{"type":"string","anyOf":[{"description":"enum as result","enum":["int64_as_number","int64_as_string","int64_as_hexstring"],"type":"string"},{"description":"int64 as result","enum":["enum_as_name","enum_as_value"],"type":"string"},{"description":"default values option","enum":["auto_default_values","no_default_values","use_default_values","use_default_metatable"],"type":"string"},{"description":"hooks option","enum":["enable_hooks","disable_hooks"],"type":"string"}]}},"proto_id":{"anyOf":[{"type":"string","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"disable":{"type":"boolean"},"method":{"description":"the method name in the grpc service.","type":"string"},"service":{"description":"the grpc service name","type":"string"}}},"version":0.1},"proxy-mirror":{"priority":1010,"schema":{"type":"object","minProperties":1,"$comment":"this is a mark for our injected plugin schema","required":["host"],"properties":{"host":{"type":"string","pattern":"^http(s)?:\\\/\\\/[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+(:[0-9]{1,5})?$"},"disable":{"type":"boolean"}}},"version":0.1},"zipkin":{"priority":11011,"schema":{"type":"object","required":["endpoint","sample_ratio"],"$comment":"this is a mark for our injected plugin schema","properties":{"endpoint":{"type":"string"},"sample_ratio":{"type":"number","maximum":1,"minimum":1e-05},"span_version":{"enum":[1,2],"default":2},"disable":{"type":"boolean"},"server_addr":{"type":"string","description":"default is $server_addr, you can specify your external ip address","pattern":"^[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}$"},"service_name":{"type":"string","description":"service name for zipkin reporter","default":"APISIX"}}},"version":0.1},"key-auth":{"priority":2500,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","additionalProperties":false,"properties":{"disable":{"type":"boolean"}}},"version":0.1,"consumer_schema":{"type":"object","required":["key"],"additionalProperties":false,"properties":{"key":{"type":"string"}}},"type":"auth"},"mqtt-proxy":{"priority":1000,"schema":{"type":"object","required":["protocol_name","protocol_level","upstream"],"$comment":"this is a mark for our injected plugin schema","properties":{"protocol_name":{"type":"string"},"protocol_level":{"type":"integer"},"upstream":{"type":"object","properties":{"ip":{"type":"string"},"port":{"type":"number"}}},"disable":{"type":"boolean"}}},"version":0.1},"proxy-rewrite":{"priority":1008,"schema":{"type":"object","minProperties":1,"$comment":"this is a mark for our injected plugin schema","additionalProperties":false,"properties":{"scheme":{"description":"new scheme for upstream","enum":["http","https"],"type":"string"},"host":{"description":"new host for upstream","type":"string","pattern":"^[0-9a-zA-Z-.]+(:\\d{1,5})?$"},"regex_uri":{"description":"new uri that substitute from client uri for upstream, lower priority than uri property","items":{"description":"regex uri","type":"string"},"type":"array","maxItems":2,"minItems":2},"headers":{"description":"new headers for request","minProperties":1,"type":"object"},"disable":{"type":"boolean"},"uri":{"description":"new uri for upstream","maxLength":4096,"pattern":"^\\\/.*","type":"string","minLength":1}}},"version":0.1},"serverless-pre-function":{"priority":10000,"schema":{"type":"object","required":["functions"],"$comment":"this is a mark for our injected plugin schema","properties":{"functions":{"type":"array","minItems":1,"items":{"type":"string"}},"disable":{"type":"boolean"},"phase":{"type":"string","enum":["rewrite","access","header_filter","body_filter","log","balancer"],"default":"access"}}},"version":0.1},"limit-conn":{"priority":1003,"schema":{"type":"object","required":["conn","burst","default_conn_delay","key"],"$comment":"this is a mark for our injected plugin schema","properties":{"burst":{"type":"integer","minimum":0},"default_conn_delay":{"type":"number","exclusiveMinimum":0},"conn":{"type":"integer","exclusiveMinimum":0},"disable":{"type":"boolean"},"key":{"type":"string","enum":["remote_addr","server_addr","http_x_real_ip","http_x_forwarded_for","consumer_name"]},"rejected_code":{"type":"integer","default":503,"maximum":599,"minimum":200}}},"version":0.1},"node-status":{"priority":1000,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","additionalProperties":false,"properties":{"disable":{"type":"boolean"}}},"version":0.1},"http-logger":{"priority":410,"schema":{"type":"object","required":["uri"],"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"timeout":{"type":"integer","default":3,"minimum":1},"concat_method":{"type":"string","enum":["json","new_line"],"default":"json"},"name":{"type":"string","default":"http logger"},"include_req_body":{"type":"boolean","default":false},"auth_header":{"type":"string","default":""},"max_retry_count":{"type":"integer","default":0,"minimum":0},"retry_delay":{"type":"integer","default":1,"minimum":0},"buffer_duration":{"type":"integer","default":60,"minimum":1},"inactive_timeout":{"type":"integer","default":5,"minimum":1},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"uri":{"type":"string","pattern":"^[^\\\/]+:\\\/\\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?"}}},"version":0.1,"metadata_schema":{"type":"object","additionalProperties":false,"properties":{"log_format":{"type":"object","default":{"client_ip":"$remote_addr","host":"$host","@timestamp":"$time_iso8601"}}}}},"response-rewrite":{"priority":899,"schema":{"type":"object","minProperties":1,"$comment":"this is a mark for our injected plugin schema","additionalProperties":false,"properties":{"vars":{"type":"array"},"disable":{"type":"boolean"},"headers":{"description":"new headers for response","minProperties":1,"type":"object"},"body_base64":{"description":"whether new body for response need base64 decode before return","type":"boolean","default":false},"body":{"description":"new body for response","type":"string"},"status_code":{"description":"new status code for response","maximum":598,"type":"integer","minimum":200}}},"version":0.1},"basic-auth":{"priority":2520,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","title":"work with route or service object","additionalProperties":false,"properties":{"disable":{"type":"boolean"}}},"version":0.1,"consumer_schema":{"type":"object","title":"work with consumer object","required":["username","password"],"additionalProperties":false,"properties":{"username":{"type":"string"},"password":{"type":"string"}}},"type":"auth"},"cors":{"priority":4000,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"allow_origins":{"description":"you can use '*' to allow all origins when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple origin use ',' to split. default: *.","type":"string","default":"*"},"allow_origins_by_regex":{"type":"array","uniqueItems":true,"items":{"type":"string","maxLength":4096,"minLength":1},"description":"you can use regex to allow specific origins when no credentials,for example use [.*\\.test.com] to allow a.test.com and b.test.com","minItems":1},"expose_headers":{"description":"you can use '*' to expose all header when no credentials,multiple header use ',' to split. default: *.","type":"string","default":"*"},"max_age":{"description":"maximum number of seconds the results can be cached.-1 mean no cached,the max value is depend on browser,more detail plz check MDN. default: 5.","type":"integer","default":5},"allow_methods":{"description":"you can use '*' to allow all methods when no credentials and '**','**' to allow forcefully(it will bring some security risks, be carefully),multiple method use ',' to split. default: *.","type":"string","default":"*"},"disable":{"type":"boolean"},"allow_credential":{"description":"allow client append credential. according to CORS specification,if you set this option to 'true', you can not use '*' for other options.","type":"boolean","default":false},"allow_headers":{"description":"you can use '*' to allow all header when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple header use ',' to split. default: *.","type":"string","default":"*"}}},"version":0.1},"limit-count":{"priority":1002,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","dependencies":{"policy":{"oneOf":[{"properties":{"policy":{"enum":["local"]}}},{"required":["redis_host"],"properties":{"redis_host":{"type":"string","minLength":2},"redis_port":{"type":"integer","default":6379,"minimum":1},"redis_password":{"type":"string","minLength":0},"redis_database":{"type":"integer","default":0,"minimum":0},"redis_timeout":{"type":"integer","default":1000,"minimum":1},"policy":{"enum":["redis"]}}},{"required":["redis_cluster_nodes"],"properties":{"redis_timeout":{"type":"integer","default":1000,"minimum":1},"redis_cluster_nodes":{"type":"array","items":{"type":"string","maxLength":100,"minLength":2},"minItems":2},"redis_password":{"type":"string","minLength":0},"policy":{"enum":["redis-cluster"]}}}]}},"required":["count","time_window"],"properties":{"disable":{"type":"boolean"},"time_window":{"type":"integer","exclusiveMinimum":0},"count":{"type":"integer","exclusiveMinimum":0},"policy":{"type":"string","enum":["local","redis","redis-cluster"],"default":"local"},"key":{"type":"string","enum":["remote_addr","server_addr","http_x_real_ip","http_x_forwarded_for","consumer_name","service_id"],"default":"remote_addr"},"rejected_code":{"type":"integer","default":503,"maximum":599,"minimum":200}}},"version":0.4},"udp-logger":{"priority":400,"schema":{"type":"object","required":["host","port"],"$comment":"this is a mark for our injected plugin schema","properties":{"host":{"type":"string"},"timeout":{"type":"integer","default":3,"minimum":1},"name":{"type":"string","default":"udp logger"},"disable":{"type":"boolean"},"port":{"type":"integer","minimum":0},"buffer_duration":{"type":"integer","default":60,"minimum":1},"inactive_timeout":{"type":"integer","default":5,"minimum":1},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"include_req_body":{"type":"boolean","default":false}}},"version":0.1},"traffic-split":{"priority":966,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","additionalProperties":false,"properties":{"rules":{"type":"array","items":{"type":"object","additionalProperties":false,"properties":{"weighted_upstreams":{"type":"array","default":[{"weight":1}],"maxItems":20,"items":{"type":"object","properties":{"weight":{"description":"used to split traffic between differentupstreams for plugin configuration","minimum":0,"type":"integer","default":1},"upstream":{"type":"object","oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}],"additionalProperties":false,"properties":{"hash_on":{"type":"string","enum":["vars","header","cookie","consumer","vars_combinations"],"default":"vars"},"service_name":{"type":"string","maxLength":256,"minLength":1},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"labels":{"description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","maxLength":64,"pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object","maxProperties":16},"name":{"type":"string","maxLength":100,"minLength":1},"desc":{"type":"string","maxLength":256},"type":{"description":"algorithms of load balancing","enum":["chash","roundrobin","ewma","least_conn"],"type":"string"},"scheme":{"enum":["grpc","grpcs","http","https"],"default":"http"},"id":{"anyOf":[{"type":"string","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"send":{"type":"number","exclusiveMinimum":0},"read":{"type":"number","exclusiveMinimum":0},"connect":{"type":"number","exclusiveMinimum":0}}},"pass_host":{"description":"mod of host passing","type":"string","enum":["pass","node","rewrite"],"default":"pass"},"update_time":{"type":"integer"},"create_time":{"type":"integer"},"retries":{"type":"integer","minimum":0},"discovery_type":{"description":"discovery type","type":"string"},"checks":{"type":"object","anyOf":[{"required":["active"]},{"required":["active","passive"]}],"additionalProperties":false,"properties":{"passive":{"type":"object","properties":{"type":{"type":"string","enum":["http","https","tcp"],"default":"http"},"healthy":{"type":"object","properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"minItems":1},"successes":{"type":"integer","default":5,"maximum":254,"minimum":1}}},"unhealthy":{"type":"object","properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"default":[429,500,503],"minItems":1},"timeouts":{"type":"integer","default":7,"maximum":254,"minimum":1},"tcp_failures":{"type":"integer","default":2,"maximum":254,"minimum":1},"http_failures":{"type":"integer","default":5,"maximum":254,"minimum":1}}}}},"active":{"type":"object","properties":{"type":{"type":"string","enum":["http","https","tcp"],"default":"http"},"healthy":{"type":"object","properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"default":[200,302],"minItems":1},"successes":{"type":"integer","default":2,"maximum":254,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1}}},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"timeout":{"type":"number","default":1},"unhealthy":{"type":"object","properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"default":[429,404,500,501,502,503,504,505],"minItems":1},"timeouts":{"type":"integer","default":3,"maximum":254,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1},"tcp_failures":{"type":"integer","default":2,"maximum":254,"minimum":1},"http_failures":{"type":"integer","default":5,"maximum":254,"minimum":1}}},"concurrency":{"type":"integer","default":10},"http_path":{"type":"string","default":"\/"},"https_verify_certificate":{"type":"boolean","default":true},"port":{"type":"integer","maximum":65535,"minimum":1},"req_headers":{"type":"array","items":{"type":"string","uniqueItems":true},"minItems":1}}}}},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"description":"weight of node","type":"integer","minimum":0}}},{"type":"array","items":{"type":"object","required":["host","port","weight"],"properties":{"priority":{"description":"priority of node","type":"integer","default":0},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"metadata":{"description":"metadata of node","type":"object"},"port":{"description":"port of node","type":"integer","minimum":1},"weight":{"description":"weight of node","type":"integer","minimum":0}}}}]}}},"upstream_id":{"anyOf":[{"type":"string","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]}}},"minItems":1},"match":{"type":"array","default":[{"vars":[["server_port",">",0]]}],"items":{"type":"object","properties":{"vars":{"type":"array"}}}}}}},"disable":{"type":"boolean"}}},"version":0.1},"prometheus":{"priority":500,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","additionalProperties":false,"properties":{"disable":{"type":"boolean"}}},"version":0.2},"echo":{"priority":412,"schema":{"type":"object","minProperties":1,"$comment":"this is a mark for our injected plugin schema","anyOf":[{"required":["before_body"]},{"required":["body"]},{"required":["after_body"]}],"additionalProperties":false,"properties":{"before_body":{"description":"body before the filter phase.","type":"string"},"after_body":{"description":"body after the modification of filter phase.","type":"string"},"disable":{"type":"boolean"},"headers":{"description":"new headers for response","minProperties":1,"type":"object"},"body":{"description":"body to replace upstream response.","type":"string"},"auth_value":{"description":"auth value","type":"string"}}},"version":0.1},"redirect":{"priority":900,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","oneOf":[{"required":["uri"]},{"required":["http_to_https"]}],"properties":{"disable":{"type":"boolean"},"ret_code":{"type":"integer","default":302,"minimum":200},"http_to_https":{"type":"boolean"},"uri":{"type":"string","minLength":2,"pattern":"(\\\\\\$[0-9a-zA-Z_]+)|\\$\\{([0-9a-zA-Z_]+)\\}|\\$([0-9a-zA-Z_]+)|(\\$|[^$\\\\]+)"}}},"version":0.1},"ip-restriction":{"priority":3000,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"}},"oneOf":[{"title":"whitelist","required":["whitelist"],"additionalProperties":false,"properties":{"whitelist":{"type":"array","minItems":1,"items":{"anyOf":[{"title":"IPv4","format":"ipv4","type":"string"},{"title":"IPv4\/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","format":"ipv6","type":"string"},{"title":"IPv6\/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}]}}}},{"title":"blacklist","required":["blacklist"],"additionalProperties":false,"properties":{"blacklist":{"type":"array","minItems":1,"items":{"anyOf":[{"title":"IPv4","format":"ipv4","type":"string"},{"title":"IPv4\/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","format":"ipv6","type":"string"},{"title":"IPv6\/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}]}}}}]},"version":0.1},"wolf-rbac":{"priority":2555,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"header_prefix":{"type":"string","default":"X-"},"appid":{"type":"string","default":"unset"},"server":{"type":"string","default":"http:\/\/127.0.0.1:10080"}}},"version":0.1,"type":"auth"},"proxy-cache":{"priority":1009,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"cache_method":{"type":"array","uniqueItems":true,"items":{"description":"http method","enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE"],"type":"string"},"default":["GET","HEAD"],"minItems":1},"cache_zone":{"type":"string","maxLength":100,"minLength":1,"default":"disk_cache_one"},"cache_key":{"type":"array","default":["$host","$request_uri"],"items":{"description":"a key for caching","type":"string","pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)"},"minItems":1},"cache_bypass":{"type":"array","items":{"type":"string","pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)"},"minItems":1},"no_cache":{"type":"array","items":{"type":"string","pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)"},"minItems":1},"hide_cache_headers":{"type":"boolean","default":false},"cache_http_status":{"type":"array","uniqueItems":true,"items":{"description":"http response status","maximum":599,"type":"integer","minimum":200},"default":[200,301,404],"minItems":1}}},"version":0.1},"server-info":{"priority":990,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","additionalProperties":false,"properties":{"disable":{"type":"boolean"}}},"version":0.1},"fault-injection":{"priority":11000,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","minProperties":1,"properties":{"disable":{"type":"boolean"},"delay":{"type":"object","required":["duration"],"properties":{"percentage":{"type":"integer","maximum":100,"minimum":0},"duration":{"type":"number","minimum":0},"vars":{"type":"array","item":{"type":"array"},"maxItems":20}}},"abort":{"type":"object","required":["http_status"],"properties":{"percentage":{"type":"integer","maximum":100,"minimum":0},"vars":{"type":"array","item":{"type":"array"},"maxItems":20},"body":{"type":"string","minLength":0},"http_status":{"type":"integer","minimum":200}}}}},"version":0.1},"uri-blocker":{"priority":2900,"schema":{"type":"object","required":["block_rules"],"$comment":"this is a mark for our injected plugin schema","properties":{"block_rules":{"type":"array","uniqueItems":true,"items":{"type":"string","maxLength":4096,"minLength":1}},"disable":{"type":"boolean"},"rejected_code":{"type":"integer","default":403,"minimum":200}}},"version":0.1},"batch-requests":{"priority":4010,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","additionalProperties":false,"properties":{"disable":{"type":"boolean"}}},"version":0.1,"metadata_schema":{"type":"object","additionalProperties":false,"properties":{"max_body_size":{"description":"max pipeline body size in bytes","type":"integer","exclusiveMinimum":0,"default":1048576}}}},"referer-restriction":{"priority":2990,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["whitelist"],"additionalProperties":false,"properties":{"whitelist":{"type":"array","minItems":1,"items":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"}},"disable":{"type":"boolean"},"bypass_missing":{"type":"boolean","default":false}}},"version":0.1},"authz-keycloak":{"priority":2000,"schema":{"type":"object","allOf":[{"anyOf":[{"required":["discovery"]},{"required":["token_endpoint"]}]},{"anyOf":[{"required":["client_id"]},{"required":["audience"]}]},{"anyOf":[{"properties":{"lazy_load_paths":{"enum":[false]}}},{"anyOf":[{"required":["discovery"]},{"required":["resource_registration_endpoint"]}],"properties":{"lazy_load_paths":{"enum":[true]}}}]}],"$comment":"this is a mark for our injected plugin schema","properties":{"audience":{"type":"string","maxLength":100,"description":"Deprecated, use `client_id` instead.","minLength":1},"policy_enforcement_mode":{"type":"string","enum":["ENFORCING","PERMISSIVE"],"default":"ENFORCING"},"disable":{"type":"boolean"},"permissions":{"type":"array","uniqueItems":true,"items":{"type":"string","maxLength":100,"minLength":1}},"lazy_load_paths":{"type":"boolean","default":false},"http_method_as_scope":{"type":"boolean","default":false},"cache_ttl_seconds":{"type":"integer","default":86400,"minimum":1},"client_id":{"type":"string","maxLength":100,"minLength":1},"keepalive_timeout":{"type":"integer","default":60000,"minimum":1000},"token_endpoint":{"type":"string","maxLength":4096,"minLength":1},"keepalive":{"type":"boolean","default":true},"keepalive_pool":{"type":"integer","default":5,"minimum":1},"client_secret":{"type":"string","maxLength":100,"minLength":1},"ssl_verify":{"type":"boolean","default":true},"grant_type":{"type":"string","maxLength":100,"default":"urn:ietf:params:oauth:grant-type:uma-ticket","enum":["urn:ietf:params:oauth:grant-type:uma-ticket"],"minLength":1},"discovery":{"type":"string","maxLength":4096,"minLength":1},"timeout":{"type":"integer","default":3000,"minimum":1000},"resource_registration_endpoint":{"type":"string","maxLength":4096,"minLength":1}}},"version":0.1},"api-breaker":{"priority":1005,"schema":{"type":"object","required":["break_response_code"],"$comment":"this is a mark for our injected plugin schema","properties":{"healthy":{"type":"object","default":{"http_statuses":[200],"successes":3},"properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":499,"minimum":200},"default":[200],"minItems":1},"successes":{"type":"integer","default":3,"minimum":1}}},"break_response_code":{"type":"integer","maximum":599,"minimum":200},"max_breaker_sec":{"type":"integer","default":300,"minimum":3},"unhealthy":{"type":"object","default":{"http_statuses":[500],"failures":3},"properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":500},"default":[500],"minItems":1},"failures":{"type":"integer","default":3,"minimum":1}}},"disable":{"type":"boolean"}}},"version":0.1},"syslog":{"priority":401,"schema":{"type":"object","required":["host","port"],"$comment":"this is a mark for our injected plugin schema","properties":{"max_retry_times":{"type":"integer","default":1,"minimum":1},"retry_interval":{"type":"integer","default":1,"minimum":0},"host":{"type":"string"},"disable":{"type":"boolean"},"timeout":{"type":"integer","default":3,"minimum":1},"include_req_body":{"type":"boolean","default":false},"name":{"type":"string","default":"sys logger"},"port":{"type":"integer"},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"pool_size":{"type":"integer","default":5,"minimum":5},"tls":{"type":"boolean","default":false},"buffer_duration":{"type":"integer","default":60,"minimum":1},"flush_limit":{"type":"integer","default":4096,"minimum":1},"drop_limit":{"type":"integer","default":1048576},"sock_type":{"type":"string","enum":["tcp","udp"],"default":"tcp"}}},"version":0.1},"serverless-post-function":{"priority":-2000,"schema":{"type":"object","required":["functions"],"$comment":"this is a mark for our injected plugin schema","properties":{"functions":{"type":"array","minItems":1,"items":{"type":"string"}},"disable":{"type":"boolean"},"phase":{"type":"string","enum":["rewrite","access","header_filter","body_filter","log","balancer"],"default":"access"}}},"version":0.1},"limit-req":{"priority":1001,"schema":{"type":"object","required":["rate","burst","key"],"$comment":"this is a mark for our injected plugin schema","properties":{"burst":{"type":"number","minimum":0},"key":{"type":"string","enum":["remote_addr","server_addr","http_x_real_ip","http_x_forwarded_for","consumer_name"]},"disable":{"type":"boolean"},"rate":{"type":"number","exclusiveMinimum":0},"rejected_code":{"type":"integer","default":503,"maximum":599,"minimum":200}}},"version":0.1},"request-id":{"priority":11010,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"header_name":{"type":"string","default":"X-Request-Id"},"disable":{"type":"boolean"},"include_in_response":{"type":"boolean","default":true}}},"version":0.1},"hmac-auth":{"priority":2530,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","title":"work with route or service object","additionalProperties":false,"properties":{"disable":{"type":"boolean"}}},"version":0.1,"consumer_schema":{"type":"object","title":"work with consumer object","required":["access_key","secret_key"],"additionalProperties":false,"properties":{"clock_skew":{"type":"integer","default":0},"signed_headers":{"type":"array","items":{"type":"string","maxLength":50,"minLength":1}},"keep_headers":{"type":"boolean","title":"whether to keep the http request header","default":false},"access_key":{"type":"string","maxLength":256,"minLength":1},"algorithm":{"type":"string","enum":["hmac-sha1","hmac-sha256","hmac-sha512"],"default":"hmac-sha256"},"secret_key":{"type":"string","maxLength":256,"minLength":1},"encode_uri_params":{"type":"boolean","title":"Whether to escape the uri parameter","default":true}}},"type":"auth"},"jwt-auth":{"priority":2510,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","additionalProperties":false,"properties":{"disable":{"type":"boolean"}}},"version":0.1,"consumer_schema":{"type":"object","required":["key"],"dependencies":{"algorithm":{"oneOf":[{"properties":{"algorithm":{"enum":["HS256","HS512"],"default":"HS256"}}},{"required":["public_key","private_key"],"properties":{"private_key":{"type":"string"},"public_key":{"type":"string"},"algorithm":{"enum":["RS256"]}}}]}},"properties":{"secret":{"type":"string"},"exp":{"type":"integer","default":86400,"minimum":1},"key":{"type":"string"},"base64_secret":{"type":"boolean","default":false},"algorithm":{"type":"string","enum":["HS256","HS512","RS256"],"default":"HS256"}}},"type":"auth"},"sls-logger":{"priority":406,"schema":{"type":"object","required":["host","port","project","logstore","access_key_id","access_key_secret"],"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"host":{"type":"string"},"access_key_secret":{"type":"string"},"project":{"type":"string"},"timeout":{"type":"integer","default":5000,"minimum":1},"access_key_id":{"type":"string"},"name":{"type":"string","default":"sls-logger"},"logstore":{"type":"string"},"port":{"type":"integer"},"max_retry_count":{"type":"integer","default":0,"minimum":0},"retry_delay":{"type":"integer","default":1,"minimum":0},"buffer_duration":{"type":"integer","default":60,"minimum":1},"inactive_timeout":{"type":"integer","default":5,"minimum":1},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"include_req_body":{"type":"boolean","default":false}}},"version":0.1},"kafka-logger":{"priority":403,"schema":{"type":"object","required":["broker_list","kafka_topic"],"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"key":{"type":"string"},"meta_format":{"type":"string","enum":["default","origin"],"default":"default"},"timeout":{"type":"integer","default":3,"minimum":1},"name":{"type":"string","default":"kafka logger"},"kafka_topic":{"type":"string"},"broker_list":{"type":"object"},"max_retry_count":{"type":"integer","default":0,"minimum":0},"retry_delay":{"type":"integer","default":1,"minimum":0},"buffer_duration":{"type":"integer","default":60,"minimum":1},"inactive_timeout":{"type":"integer","default":5,"minimum":1},"batch_max_size":{"type":"integer","default":1000,"minimum":1},"include_req_body":{"type":"boolean","default":false}}},"version":0.1}},"main":{"plugin_config":{"type":"object","required":["id","plugins"],"additionalProperties":false,"properties":{"update_time":{"type":"integer"},"desc":{"type":"string","maxLength":256},"id":{"anyOf":[{"type":"string","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"plugins":{"type":"object"},"labels":{"description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","maxLength":64,"pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object","maxProperties":16},"create_time":{"type":"integer"}}},"upstream":{"type":"object","oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}],"additionalProperties":false,"properties":{"hash_on":{"type":"string","enum":["vars","header","cookie","consumer","vars_combinations"],"default":"vars"},"service_name":{"type":"string","maxLength":256,"minLength":1},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"labels":{"description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","maxLength":64,"pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object","maxProperties":16},"name":{"type":"string","maxLength":100,"minLength":1},"desc":{"type":"string","maxLength":256},"type":{"description":"algorithms of load balancing","enum":["chash","roundrobin","ewma","least_conn"],"type":"string"},"scheme":{"enum":["grpc","grpcs","http","https"],"default":"http"},"id":{"anyOf":[{"type":"string","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"send":{"type":"number","exclusiveMinimum":0},"read":{"type":"number","exclusiveMinimum":0},"connect":{"type":"number","exclusiveMinimum":0}}},"pass_host":{"description":"mod of host passing","type":"string","enum":["pass","node","rewrite"],"default":"pass"},"update_time":{"type":"integer"},"create_time":{"type":"integer"},"retries":{"type":"integer","minimum":0},"discovery_type":{"description":"discovery type","type":"string"},"checks":{"type":"object","anyOf":[{"required":["active"]},{"required":["active","passive"]}],"additionalProperties":false,"properties":{"passive":{"type":"object","properties":{"type":{"type":"string","enum":["http","https","tcp"],"default":"http"},"healthy":{"type":"object","properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"minItems":1},"successes":{"type":"integer","default":5,"maximum":254,"minimum":1}}},"unhealthy":{"type":"object","properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"default":[429,500,503],"minItems":1},"timeouts":{"type":"integer","default":7,"maximum":254,"minimum":1},"tcp_failures":{"type":"integer","default":2,"maximum":254,"minimum":1},"http_failures":{"type":"integer","default":5,"maximum":254,"minimum":1}}}}},"active":{"type":"object","properties":{"type":{"type":"string","enum":["http","https","tcp"],"default":"http"},"healthy":{"type":"object","properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"default":[200,302],"minItems":1},"successes":{"type":"integer","default":2,"maximum":254,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1}}},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"timeout":{"type":"number","default":1},"unhealthy":{"type":"object","properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"default":[429,404,500,501,502,503,504,505],"minItems":1},"timeouts":{"type":"integer","default":3,"maximum":254,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1},"tcp_failures":{"type":"integer","default":2,"maximum":254,"minimum":1},"http_failures":{"type":"integer","default":5,"maximum":254,"minimum":1}}},"concurrency":{"type":"integer","default":10},"http_path":{"type":"string","default":"\/"},"https_verify_certificate":{"type":"boolean","default":true},"port":{"type":"integer","maximum":65535,"minimum":1},"req_headers":{"type":"array","items":{"type":"string","uniqueItems":true},"minItems":1}}}}},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"description":"weight of node","type":"integer","minimum":0}}},{"type":"array","items":{"type":"object","required":["host","port","weight"],"properties":{"priority":{"description":"priority of node","type":"integer","default":0},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"metadata":{"description":"metadata of node","type":"object"},"port":{"description":"port of node","type":"integer","minimum":1},"weight":{"description":"weight of node","type":"integer","minimum":0}}}}]}}},"service":{"type":"object","additionalProperties":false,"properties":{"script":{"type":"string","maxLength":102400,"minLength":10},"upstream":{"type":"object","oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}],"additionalProperties":false,"properties":{"hash_on":{"type":"string","enum":["vars","header","cookie","consumer","vars_combinations"],"default":"vars"},"service_name":{"type":"string","maxLength":256,"minLength":1},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"labels":{"description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","maxLength":64,"pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object","maxProperties":16},"name":{"type":"string","maxLength":100,"minLength":1},"desc":{"type":"string","maxLength":256},"type":{"description":"algorithms of load balancing","enum":["chash","roundrobin","ewma","least_conn"],"type":"string"},"scheme":{"enum":["grpc","grpcs","http","https"],"default":"http"},"id":{"anyOf":[{"type":"string","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"send":{"type":"number","exclusiveMinimum":0},"read":{"type":"number","exclusiveMinimum":0},"connect":{"type":"number","exclusiveMinimum":0}}},"pass_host":{"description":"mod of host passing","type":"string","enum":["pass","node","rewrite"],"default":"pass"},"update_time":{"type":"integer"},"create_time":{"type":"integer"},"retries":{"type":"integer","minimum":0},"discovery_type":{"description":"discovery type","type":"string"},"checks":{"type":"object","anyOf":[{"required":["active"]},{"required":["active","passive"]}],"additionalProperties":false,"properties":{"passive":{"type":"object","properties":{"type":{"type":"string","enum":["http","https","tcp"],"default":"http"},"healthy":{"type":"object","properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"minItems":1},"successes":{"type":"integer","default":5,"maximum":254,"minimum":1}}},"unhealthy":{"type":"object","properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"default":[429,500,503],"minItems":1},"timeouts":{"type":"integer","default":7,"maximum":254,"minimum":1},"tcp_failures":{"type":"integer","default":2,"maximum":254,"minimum":1},"http_failures":{"type":"integer","default":5,"maximum":254,"minimum":1}}}}},"active":{"type":"object","properties":{"type":{"type":"string","enum":["http","https","tcp"],"default":"http"},"healthy":{"type":"object","properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"default":[200,302],"minItems":1},"successes":{"type":"integer","default":2,"maximum":254,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1}}},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"timeout":{"type":"number","default":1},"unhealthy":{"type":"object","properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"default":[429,404,500,501,502,503,504,505],"minItems":1},"timeouts":{"type":"integer","default":3,"maximum":254,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1},"tcp_failures":{"type":"integer","default":2,"maximum":254,"minimum":1},"http_failures":{"type":"integer","default":5,"maximum":254,"minimum":1}}},"concurrency":{"type":"integer","default":10},"http_path":{"type":"string","default":"\/"},"https_verify_certificate":{"type":"boolean","default":true},"port":{"type":"integer","maximum":65535,"minimum":1},"req_headers":{"type":"array","items":{"type":"string","uniqueItems":true},"minItems":1}}}}},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"description":"weight of node","type":"integer","minimum":0}}},{"type":"array","items":{"type":"object","required":["host","port","weight"],"properties":{"priority":{"description":"priority of node","type":"integer","default":0},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"metadata":{"description":"metadata of node","type":"object"},"port":{"description":"port of node","type":"integer","minimum":1},"weight":{"description":"weight of node","type":"integer","minimum":0}}}}]}}},"id":{"anyOf":[{"type":"string","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"plugins":{"type":"object"},"labels":{"description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","maxLength":64,"pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object","maxProperties":16},"name":{"type":"string","maxLength":100,"minLength":1},"update_time":{"type":"integer"},"desc":{"type":"string","maxLength":256},"enable_websocket":{"description":"enable websocket for request","type":"boolean"},"create_time":{"type":"integer"},"upstream_id":{"anyOf":[{"type":"string","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]}}},"plugins":{"type":"array","items":{"type":"object","required":["name"],"properties":{"additionalProperties":false,"stream":{"type":"boolean"},"name":{"type":"string","minLength":1}}}},"ssl":{"type":"object","additionalProperties":false,"oneOf":[{"required":["sni","key","cert"]},{"required":["snis","key","cert"]}],"properties":{"exptime":{"type":"integer","minimum":1588262400},"id":{"anyOf":[{"type":"string","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"key":{"type":"string","maxLength":65536,"minLength":128},"sni":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-.]+$"},"labels":{"description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","maxLength":64,"pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object","maxProperties":16},"snis":{"type":"array","minItems":1,"items":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-.]+$"}},"certs":{"type":"array","items":{"type":"string","maxLength":65536,"minLength":128}},"update_time":{"type":"integer"},"validity_end":{"type":"integer"},"validity_start":{"type":"integer"},"keys":{"type":"array","items":{"type":"string","maxLength":65536,"minLength":128}},"status":{"description":"ssl status, 1 to enable, 0 to disable","type":"integer","enum":[1,0],"default":1},"create_time":{"type":"integer"},"cert":{"type":"string","maxLength":65536,"minLength":128}}},"consumer":{"type":"object","required":["username"],"additionalProperties":false,"properties":{"update_time":{"type":"integer"},"create_time":{"type":"integer"},"username":{"type":"string","maxLength":32,"minLength":1,"pattern":"^[a-zA-Z0-9_]+$"},"plugins":{"type":"object"},"labels":{"description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","maxLength":64,"pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object","maxProperties":16},"desc":{"type":"string","maxLength":256}}},"upstream_hash_vars_schema":{"type":"string","pattern":"^((uri|server_name|server_addr|request_uri|remote_port|remote_addr|query_string|host|hostname)|arg_[0-9a-zA-z_-]+)$"},"proto":{"type":"object","required":["content"],"additionalProperties":false,"properties":{"update_time":{"type":"integer"},"create_time":{"type":"integer"},"id":{"anyOf":[{"type":"string","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"desc":{"type":"string","maxLength":256},"content":{"type":"string","maxLength":1048576,"minLength":1}}},"global_rule":{"type":"object","required":["plugins"],"additionalProperties":false,"properties":{"update_time":{"type":"integer"},"plugins":{"type":"object"},"create_time":{"type":"integer"},"id":{"anyOf":[{"type":"string","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]}}},"stream_route":{"type":"object","properties":{"upstream":{"type":"object","oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}],"additionalProperties":false,"properties":{"hash_on":{"type":"string","enum":["vars","header","cookie","consumer","vars_combinations"],"default":"vars"},"service_name":{"type":"string","maxLength":256,"minLength":1},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"labels":{"description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","maxLength":64,"pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object","maxProperties":16},"name":{"type":"string","maxLength":100,"minLength":1},"desc":{"type":"string","maxLength":256},"type":{"description":"algorithms of load balancing","enum":["chash","roundrobin","ewma","least_conn"],"type":"string"},"scheme":{"enum":["grpc","grpcs","http","https"],"default":"http"},"id":{"anyOf":[{"type":"string","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"send":{"type":"number","exclusiveMinimum":0},"read":{"type":"number","exclusiveMinimum":0},"connect":{"type":"number","exclusiveMinimum":0}}},"pass_host":{"description":"mod of host passing","type":"string","enum":["pass","node","rewrite"],"default":"pass"},"update_time":{"type":"integer"},"create_time":{"type":"integer"},"retries":{"type":"integer","minimum":0},"discovery_type":{"description":"discovery type","type":"string"},"checks":{"type":"object","anyOf":[{"required":["active"]},{"required":["active","passive"]}],"additionalProperties":false,"properties":{"passive":{"type":"object","properties":{"type":{"type":"string","enum":["http","https","tcp"],"default":"http"},"healthy":{"type":"object","properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"minItems":1},"successes":{"type":"integer","default":5,"maximum":254,"minimum":1}}},"unhealthy":{"type":"object","properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"default":[429,500,503],"minItems":1},"timeouts":{"type":"integer","default":7,"maximum":254,"minimum":1},"tcp_failures":{"type":"integer","default":2,"maximum":254,"minimum":1},"http_failures":{"type":"integer","default":5,"maximum":254,"minimum":1}}}}},"active":{"type":"object","properties":{"type":{"type":"string","enum":["http","https","tcp"],"default":"http"},"healthy":{"type":"object","properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"default":[200,302],"minItems":1},"successes":{"type":"integer","default":2,"maximum":254,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1}}},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"timeout":{"type":"number","default":1},"unhealthy":{"type":"object","properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"default":[429,404,500,501,502,503,504,505],"minItems":1},"timeouts":{"type":"integer","default":3,"maximum":254,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1},"tcp_failures":{"type":"integer","default":2,"maximum":254,"minimum":1},"http_failures":{"type":"integer","default":5,"maximum":254,"minimum":1}}},"concurrency":{"type":"integer","default":10},"http_path":{"type":"string","default":"\/"},"https_verify_certificate":{"type":"boolean","default":true},"port":{"type":"integer","maximum":65535,"minimum":1},"req_headers":{"type":"array","items":{"type":"string","uniqueItems":true},"minItems":1}}}}},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"description":"weight of node","type":"integer","minimum":0}}},{"type":"array","items":{"type":"object","required":["host","port","weight"],"properties":{"priority":{"description":"priority of node","type":"integer","default":0},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"metadata":{"description":"metadata of node","type":"object"},"port":{"description":"port of node","type":"integer","minimum":1},"weight":{"description":"weight of node","type":"integer","minimum":0}}}}]}}},"id":{"anyOf":[{"type":"string","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"plugins":{"type":"object"},"update_time":{"type":"integer"},"create_time":{"type":"integer"},"server_port":{"description":"server port","type":"integer"},"remote_addr":{"description":"client IP","anyOf":[{"title":"IPv4","format":"ipv4","type":"string"},{"title":"IPv4\/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","format":"ipv6","type":"string"},{"title":"IPv6\/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}],"type":"string"},"desc":{"type":"string","maxLength":256},"server_addr":{"description":"server IP","anyOf":[{"title":"IPv4","format":"ipv4","type":"string"},{"title":"IPv4\/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","format":"ipv6","type":"string"},{"title":"IPv6\/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}],"type":"string"},"upstream_id":{"anyOf":[{"type":"string","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]}}},"route":{"type":"object","allOf":[{"oneOf":[{"required":["uri"]},{"required":["uris"]}]},{"oneOf":[{"not":{"anyOf":[{"required":["host"]},{"required":["hosts"]}]}},{"required":["host"]},{"required":["hosts"]}]},{"oneOf":[{"not":{"anyOf":[{"required":["remote_addr"]},{"required":["remote_addrs"]}]}},{"required":["remote_addr"]},{"required":["remote_addrs"]}]}],"anyOf":[{"required":["plugins","uri"]},{"required":["upstream","uri"]},{"required":["upstream_id","uri"]},{"required":["service_id","uri"]},{"required":["plugins","uris"]},{"required":["upstream","uris"]},{"required":["upstream_id","uris"]},{"required":["service_id","uris"]},{"required":["script","uri"]},{"required":["script","uris"]}],"additionalProperties":false,"not":{"anyOf":[{"required":["script","plugins"]},{"required":["script","plugin_config_id"]}]},"properties":{"script":{"type":"string","maxLength":102400,"minLength":10},"vars":{"type":"array"},"plugins":{"type":"object"},"labels":{"description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","maxLength":64,"pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object","maxProperties":16},"name":{"type":"string","maxLength":100,"minLength":1},"desc":{"type":"string","maxLength":256},"id":{"anyOf":[{"type":"string","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"status":{"description":"route status, 1 to enable, 0 to disable","type":"integer","enum":[1,0],"default":1},"service_id":{"anyOf":[{"type":"string","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"upstream_id":{"anyOf":[{"type":"string","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"priority":{"type":"integer","default":0},"service_protocol":{"enum":["grpc","http"]},"uris":{"type":"array","uniqueItems":true,"minItems":1,"items":{"description":"HTTP uri","type":"string"}},"enable_websocket":{"description":"enable websocket for request","type":"boolean"},"methods":{"type":"array","uniqueItems":true,"items":{"description":"HTTP method","enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE"],"type":"string"}},"upstream":{"type":"object","oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}],"additionalProperties":false,"properties":{"hash_on":{"type":"string","enum":["vars","header","cookie","consumer","vars_combinations"],"default":"vars"},"service_name":{"type":"string","maxLength":256,"minLength":1},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"labels":{"description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","maxLength":64,"pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object","maxProperties":16},"name":{"type":"string","maxLength":100,"minLength":1},"desc":{"type":"string","maxLength":256},"type":{"description":"algorithms of load balancing","enum":["chash","roundrobin","ewma","least_conn"],"type":"string"},"scheme":{"enum":["grpc","grpcs","http","https"],"default":"http"},"id":{"anyOf":[{"type":"string","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"send":{"type":"number","exclusiveMinimum":0},"read":{"type":"number","exclusiveMinimum":0},"connect":{"type":"number","exclusiveMinimum":0}}},"pass_host":{"description":"mod of host passing","type":"string","enum":["pass","node","rewrite"],"default":"pass"},"update_time":{"type":"integer"},"create_time":{"type":"integer"},"retries":{"type":"integer","minimum":0},"discovery_type":{"description":"discovery type","type":"string"},"checks":{"type":"object","anyOf":[{"required":["active"]},{"required":["active","passive"]}],"additionalProperties":false,"properties":{"passive":{"type":"object","properties":{"type":{"type":"string","enum":["http","https","tcp"],"default":"http"},"healthy":{"type":"object","properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"minItems":1},"successes":{"type":"integer","default":5,"maximum":254,"minimum":1}}},"unhealthy":{"type":"object","properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"default":[429,500,503],"minItems":1},"timeouts":{"type":"integer","default":7,"maximum":254,"minimum":1},"tcp_failures":{"type":"integer","default":2,"maximum":254,"minimum":1},"http_failures":{"type":"integer","default":5,"maximum":254,"minimum":1}}}}},"active":{"type":"object","properties":{"type":{"type":"string","enum":["http","https","tcp"],"default":"http"},"healthy":{"type":"object","properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"default":[200,302],"minItems":1},"successes":{"type":"integer","default":2,"maximum":254,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1}}},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"timeout":{"type":"number","default":1},"unhealthy":{"type":"object","properties":{"http_statuses":{"type":"array","uniqueItems":true,"items":{"type":"integer","maximum":599,"minimum":200},"default":[429,404,500,501,502,503,504,505],"minItems":1},"timeouts":{"type":"integer","default":3,"maximum":254,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1},"tcp_failures":{"type":"integer","default":2,"maximum":254,"minimum":1},"http_failures":{"type":"integer","default":5,"maximum":254,"minimum":1}}},"concurrency":{"type":"integer","default":10},"http_path":{"type":"string","default":"\/"},"https_verify_certificate":{"type":"boolean","default":true},"port":{"type":"integer","maximum":65535,"minimum":1},"req_headers":{"type":"array","items":{"type":"string","uniqueItems":true},"minItems":1}}}}},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"description":"weight of node","type":"integer","minimum":0}}},{"type":"array","items":{"type":"object","required":["host","port","weight"],"properties":{"priority":{"description":"priority of node","type":"integer","default":0},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"metadata":{"description":"metadata of node","type":"object"},"port":{"description":"port of node","type":"integer","minimum":1},"weight":{"description":"weight of node","type":"integer","minimum":0}}}}]}}},"hosts":{"type":"array","uniqueItems":true,"minItems":1,"items":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"}},"remote_addrs":{"type":"array","uniqueItems":true,"minItems":1,"items":{"description":"client IP","anyOf":[{"title":"IPv4","format":"ipv4","type":"string"},{"title":"IPv4\/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","format":"ipv6","type":"string"},{"title":"IPv6\/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}],"type":"string"}},"filter_func":{"type":"string","minLength":10,"pattern":"^function"},"update_time":{"type":"integer"},"script_id":{"anyOf":[{"type":"string","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"plugin_config_id":{"anyOf":[{"type":"string","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"remote_addr":{"description":"client IP","anyOf":[{"title":"IPv4","format":"ipv4","type":"string"},{"title":"IPv4\/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","format":"ipv6","type":"string"},{"title":"IPv6\/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}],"type":"string"},"create_time":{"type":"integer"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"uri":{"type":"string","maxLength":4096,"minLength":1}}},"upstream_hash_header_schema":{"type":"string","pattern":"^[a-zA-Z0-9-_]+$"}}}
