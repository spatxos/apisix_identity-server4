{"main":{"plugins":{"type":"array","items":{"type":"object","properties":{"additionalProperties":false,"name":{"type":"string","minLength":1},"stream":{"type":"boolean"}},"required":["name"]}},"plugin_config":{"type":"object","properties":{"plugins":{"type":"object"},"desc":{"type":"string","maxLength":256},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64},{"type":"integer","minimum":1}]},"update_time":{"type":"integer"},"labels":{"type":"object","maxProperties":16,"patternProperties":{".*":{"type":"string","description":"value of label","pattern":"^\\S+$","minLength":1,"maxLength":64}},"description":"key\/value pairs to specify attributes"},"create_time":{"type":"integer"}},"additionalProperties":false,"required":["id","plugins"]},"upstream_hash_vars_schema":{"type":"string","pattern":"^((uri|server_name|server_addr|request_uri|remote_port|remote_addr|query_string|host|hostname)|arg_[0-9a-zA-z_-]+)$"},"proto":{"type":"object","properties":{"content":{"type":"string","minLength":1,"maxLength":1048576},"desc":{"type":"string","maxLength":256},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64},{"type":"integer","minimum":1}]},"update_time":{"type":"integer"},"create_time":{"type":"integer"}},"additionalProperties":false,"required":["content"]},"service":{"type":"object","properties":{"plugins":{"type":"object"},"desc":{"type":"string","maxLength":256},"name":{"type":"string","minLength":1,"maxLength":100},"upstream_id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64},{"type":"integer","minimum":1}]},"update_time":{"type":"integer"},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64},{"type":"integer","minimum":1}]},"create_time":{"type":"integer"},"script":{"type":"string","minLength":10,"maxLength":102400},"upstream":{"type":"object","properties":{"create_time":{"type":"integer"},"retries":{"type":"integer","minimum":0},"type":{"type":"string","enum":["chash","roundrobin","ewma","least_conn"],"description":"algorithms of load balancing"},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64},{"type":"integer","minimum":1}]},"labels":{"type":"object","maxProperties":16,"patternProperties":{".*":{"type":"string","description":"value of label","pattern":"^\\S+$","minLength":1,"maxLength":64}},"description":"key\/value pairs to specify attributes"},"discovery_type":{"type":"string","description":"discovery type"},"timeout":{"type":"object","properties":{"connect":{"type":"number","exclusiveMinimum":0},"send":{"type":"number","exclusiveMinimum":0},"read":{"type":"number","exclusiveMinimum":0}},"required":["connect","send","read"]},"desc":{"type":"string","maxLength":256},"checks":{"type":"object","properties":{"active":{"type":"object","properties":{"concurrency":{"type":"integer","default":10},"http_path":{"type":"string","default":"\/"},"https_verify_certificate":{"type":"boolean","default":true},"port":{"type":"integer","minimum":1,"maximum":65535},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"req_headers":{"type":"array","minItems":1,"items":{"type":"string","uniqueItems":true}},"unhealthy":{"type":"object","properties":{"timeouts":{"type":"integer","minimum":1,"maximum":254,"default":3},"interval":{"type":"integer","minimum":1,"default":1},"http_statuses":{"type":"array","default":[429,404,500,501,502,503,504,505],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":599},"uniqueItems":true},"http_failures":{"type":"integer","minimum":1,"maximum":254,"default":5},"tcp_failures":{"type":"integer","minimum":1,"maximum":254,"default":2}}},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"healthy":{"type":"object","properties":{"successes":{"type":"integer","minimum":1,"maximum":254,"default":2},"interval":{"type":"integer","minimum":1,"default":1},"http_statuses":{"type":"array","default":[200,302],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":599},"uniqueItems":true}}},"timeout":{"type":"number","default":1}}},"passive":{"type":"object","properties":{"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"unhealthy":{"type":"object","properties":{"timeouts":{"type":"integer","minimum":1,"maximum":254,"default":7},"http_statuses":{"type":"array","default":[429,500,503],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":599},"uniqueItems":true},"http_failures":{"type":"integer","minimum":1,"maximum":254,"default":5},"tcp_failures":{"type":"integer","minimum":1,"maximum":254,"default":2}}},"healthy":{"type":"object","properties":{"successes":{"type":"integer","minimum":1,"maximum":254,"default":5},"http_statuses":{"type":"array","default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":599},"uniqueItems":true}}}}}},"additionalProperties":false,"anyOf":[{"required":["active"]},{"required":["active","passive"]}]},"pass_host":{"type":"string","default":"pass","enum":["pass","node","rewrite"],"description":"mod of host passing"},"update_time":{"type":"integer"},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"scheme":{"enum":["grpc","grpcs","http","https"],"default":"http"},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"type":"integer","minimum":0,"description":"weight of node"}}},{"type":"array","items":{"type":"object","properties":{"weight":{"type":"integer","minimum":0,"description":"weight of node"},"priority":{"type":"integer","default":0,"description":"priority of node"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"metadata":{"type":"object","description":"metadata of node"},"port":{"type":"integer","minimum":1,"description":"port of node"}},"required":["host","port","weight"]}}]},"service_name":{"type":"string","minLength":1,"maxLength":256},"key":{"type":"string","description":"the key of chash for dynamic load balancing"},"hash_on":{"type":"string","default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"]},"name":{"type":"string","minLength":1,"maxLength":100}},"additionalProperties":false,"oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}]},"enable_websocket":{"type":"boolean","description":"enable websocket for request"},"labels":{"type":"object","maxProperties":16,"patternProperties":{".*":{"type":"string","description":"value of label","pattern":"^\\S+$","minLength":1,"maxLength":64}},"description":"key\/value pairs to specify attributes"}},"additionalProperties":false},"upstream_hash_header_schema":{"type":"string","pattern":"^[a-zA-Z0-9-_]+$"},"ssl":{"type":"object","properties":{"create_time":{"type":"integer"},"validity_start":{"type":"integer"},"update_time":{"type":"integer"},"status":{"type":"integer","default":1,"enum":[1,0],"description":"ssl status, 1 to enable, 0 to disable"},"validity_end":{"type":"integer"},"snis":{"type":"array","minItems":1,"items":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-.]+$"}},"certs":{"type":"array","items":{"type":"string","minLength":128,"maxLength":65536}},"labels":{"type":"object","maxProperties":16,"patternProperties":{".*":{"type":"string","description":"value of label","pattern":"^\\S+$","minLength":1,"maxLength":64}},"description":"key\/value pairs to specify attributes"},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64},{"type":"integer","minimum":1}]},"keys":{"type":"array","items":{"type":"string","minLength":128,"maxLength":65536}},"key":{"type":"string","minLength":128,"maxLength":65536},"cert":{"type":"string","minLength":128,"maxLength":65536},"exptime":{"type":"integer","minimum":1588262400},"sni":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-.]+$"}},"additionalProperties":false,"oneOf":[{"required":["sni","key","cert"]},{"required":["snis","key","cert"]}]},"upstream":{"type":"object","properties":{"create_time":{"type":"integer"},"retries":{"type":"integer","minimum":0},"type":{"type":"string","enum":["chash","roundrobin","ewma","least_conn"],"description":"algorithms of load balancing"},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64},{"type":"integer","minimum":1}]},"labels":{"type":"object","maxProperties":16,"patternProperties":{".*":{"type":"string","description":"value of label","pattern":"^\\S+$","minLength":1,"maxLength":64}},"description":"key\/value pairs to specify attributes"},"discovery_type":{"type":"string","description":"discovery type"},"timeout":{"type":"object","properties":{"connect":{"type":"number","exclusiveMinimum":0},"send":{"type":"number","exclusiveMinimum":0},"read":{"type":"number","exclusiveMinimum":0}},"required":["connect","send","read"]},"desc":{"type":"string","maxLength":256},"checks":{"type":"object","properties":{"active":{"type":"object","properties":{"concurrency":{"type":"integer","default":10},"http_path":{"type":"string","default":"\/"},"https_verify_certificate":{"type":"boolean","default":true},"port":{"type":"integer","minimum":1,"maximum":65535},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"req_headers":{"type":"array","minItems":1,"items":{"type":"string","uniqueItems":true}},"unhealthy":{"type":"object","properties":{"timeouts":{"type":"integer","minimum":1,"maximum":254,"default":3},"interval":{"type":"integer","minimum":1,"default":1},"http_statuses":{"type":"array","default":[429,404,500,501,502,503,504,505],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":599},"uniqueItems":true},"http_failures":{"type":"integer","minimum":1,"maximum":254,"default":5},"tcp_failures":{"type":"integer","minimum":1,"maximum":254,"default":2}}},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"healthy":{"type":"object","properties":{"successes":{"type":"integer","minimum":1,"maximum":254,"default":2},"interval":{"type":"integer","minimum":1,"default":1},"http_statuses":{"type":"array","default":[200,302],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":599},"uniqueItems":true}}},"timeout":{"type":"number","default":1}}},"passive":{"type":"object","properties":{"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"unhealthy":{"type":"object","properties":{"timeouts":{"type":"integer","minimum":1,"maximum":254,"default":7},"http_statuses":{"type":"array","default":[429,500,503],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":599},"uniqueItems":true},"http_failures":{"type":"integer","minimum":1,"maximum":254,"default":5},"tcp_failures":{"type":"integer","minimum":1,"maximum":254,"default":2}}},"healthy":{"type":"object","properties":{"successes":{"type":"integer","minimum":1,"maximum":254,"default":5},"http_statuses":{"type":"array","default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":599},"uniqueItems":true}}}}}},"additionalProperties":false,"anyOf":[{"required":["active"]},{"required":["active","passive"]}]},"pass_host":{"type":"string","default":"pass","enum":["pass","node","rewrite"],"description":"mod of host passing"},"update_time":{"type":"integer"},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"scheme":{"enum":["grpc","grpcs","http","https"],"default":"http"},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"type":"integer","minimum":0,"description":"weight of node"}}},{"type":"array","items":{"type":"object","properties":{"weight":{"type":"integer","minimum":0,"description":"weight of node"},"priority":{"type":"integer","default":0,"description":"priority of node"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"metadata":{"type":"object","description":"metadata of node"},"port":{"type":"integer","minimum":1,"description":"port of node"}},"required":["host","port","weight"]}}]},"service_name":{"type":"string","minLength":1,"maxLength":256},"key":{"type":"string","description":"the key of chash for dynamic load balancing"},"hash_on":{"type":"string","default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"]},"name":{"type":"string","minLength":1,"maxLength":100}},"additionalProperties":false,"oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}]},"global_rule":{"type":"object","properties":{"plugins":{"type":"object"},"create_time":{"type":"integer"},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64},{"type":"integer","minimum":1}]},"update_time":{"type":"integer"}},"additionalProperties":false,"required":["plugins"]},"stream_route":{"type":"object","properties":{"server_port":{"type":"integer","description":"server port"},"desc":{"type":"string","maxLength":256},"upstream_id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64},{"type":"integer","minimum":1}]},"update_time":{"type":"integer"},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64},{"type":"integer","minimum":1}]},"plugins":{"type":"object"},"create_time":{"type":"integer"},"upstream":{"type":"object","properties":{"create_time":{"type":"integer"},"retries":{"type":"integer","minimum":0},"type":{"type":"string","enum":["chash","roundrobin","ewma","least_conn"],"description":"algorithms of load balancing"},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64},{"type":"integer","minimum":1}]},"labels":{"type":"object","maxProperties":16,"patternProperties":{".*":{"type":"string","description":"value of label","pattern":"^\\S+$","minLength":1,"maxLength":64}},"description":"key\/value pairs to specify attributes"},"discovery_type":{"type":"string","description":"discovery type"},"timeout":{"type":"object","properties":{"connect":{"type":"number","exclusiveMinimum":0},"send":{"type":"number","exclusiveMinimum":0},"read":{"type":"number","exclusiveMinimum":0}},"required":["connect","send","read"]},"desc":{"type":"string","maxLength":256},"checks":{"type":"object","properties":{"active":{"type":"object","properties":{"concurrency":{"type":"integer","default":10},"http_path":{"type":"string","default":"\/"},"https_verify_certificate":{"type":"boolean","default":true},"port":{"type":"integer","minimum":1,"maximum":65535},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"req_headers":{"type":"array","minItems":1,"items":{"type":"string","uniqueItems":true}},"unhealthy":{"type":"object","properties":{"timeouts":{"type":"integer","minimum":1,"maximum":254,"default":3},"interval":{"type":"integer","minimum":1,"default":1},"http_statuses":{"type":"array","default":[429,404,500,501,502,503,504,505],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":599},"uniqueItems":true},"http_failures":{"type":"integer","minimum":1,"maximum":254,"default":5},"tcp_failures":{"type":"integer","minimum":1,"maximum":254,"default":2}}},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"healthy":{"type":"object","properties":{"successes":{"type":"integer","minimum":1,"maximum":254,"default":2},"interval":{"type":"integer","minimum":1,"default":1},"http_statuses":{"type":"array","default":[200,302],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":599},"uniqueItems":true}}},"timeout":{"type":"number","default":1}}},"passive":{"type":"object","properties":{"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"unhealthy":{"type":"object","properties":{"timeouts":{"type":"integer","minimum":1,"maximum":254,"default":7},"http_statuses":{"type":"array","default":[429,500,503],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":599},"uniqueItems":true},"http_failures":{"type":"integer","minimum":1,"maximum":254,"default":5},"tcp_failures":{"type":"integer","minimum":1,"maximum":254,"default":2}}},"healthy":{"type":"object","properties":{"successes":{"type":"integer","minimum":1,"maximum":254,"default":5},"http_statuses":{"type":"array","default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":599},"uniqueItems":true}}}}}},"additionalProperties":false,"anyOf":[{"required":["active"]},{"required":["active","passive"]}]},"pass_host":{"type":"string","default":"pass","enum":["pass","node","rewrite"],"description":"mod of host passing"},"update_time":{"type":"integer"},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"scheme":{"enum":["grpc","grpcs","http","https"],"default":"http"},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"type":"integer","minimum":0,"description":"weight of node"}}},{"type":"array","items":{"type":"object","properties":{"weight":{"type":"integer","minimum":0,"description":"weight of node"},"priority":{"type":"integer","default":0,"description":"priority of node"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"metadata":{"type":"object","description":"metadata of node"},"port":{"type":"integer","minimum":1,"description":"port of node"}},"required":["host","port","weight"]}}]},"service_name":{"type":"string","minLength":1,"maxLength":256},"key":{"type":"string","description":"the key of chash for dynamic load balancing"},"hash_on":{"type":"string","default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"]},"name":{"type":"string","minLength":1,"maxLength":100}},"additionalProperties":false,"oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}]},"server_addr":{"type":"string","anyOf":[{"title":"IPv4","format":"ipv4","type":"string"},{"title":"IPv4\/CIDR","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$","type":"string"},{"title":"IPv6","format":"ipv6","type":"string"},{"title":"IPv6\/CIDR","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$","type":"string"}],"description":"server IP"},"remote_addr":{"type":"string","anyOf":[{"title":"IPv4","format":"ipv4","type":"string"},{"title":"IPv4\/CIDR","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$","type":"string"},{"title":"IPv6","format":"ipv6","type":"string"},{"title":"IPv6\/CIDR","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$","type":"string"}],"description":"client IP"}}},"route":{"type":"object","properties":{"plugins":{"type":"object"},"script_id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64},{"type":"integer","minimum":1}]},"upstream_id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64},{"type":"integer","minimum":1}]},"status":{"type":"integer","default":1,"enum":[1,0],"description":"route status, 1 to enable, 0 to disable"},"vars":{"type":"array"},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64},{"type":"integer","minimum":1}]},"priority":{"type":"integer","default":0},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"enable_websocket":{"type":"boolean","description":"enable websocket for request"},"plugin_config_id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64},{"type":"integer","minimum":1}]},"service_id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64},{"type":"integer","minimum":1}]},"desc":{"type":"string","maxLength":256},"name":{"type":"string","minLength":1,"maxLength":100},"service_protocol":{"enum":["grpc","http"]},"update_time":{"type":"integer"},"labels":{"type":"object","maxProperties":16,"patternProperties":{".*":{"type":"string","description":"value of label","pattern":"^\\S+$","minLength":1,"maxLength":64}},"description":"key\/value pairs to specify attributes"},"upstream":{"type":"object","properties":{"create_time":{"type":"integer"},"retries":{"type":"integer","minimum":0},"type":{"type":"string","enum":["chash","roundrobin","ewma","least_conn"],"description":"algorithms of load balancing"},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64},{"type":"integer","minimum":1}]},"labels":{"type":"object","maxProperties":16,"patternProperties":{".*":{"type":"string","description":"value of label","pattern":"^\\S+$","minLength":1,"maxLength":64}},"description":"key\/value pairs to specify attributes"},"discovery_type":{"type":"string","description":"discovery type"},"timeout":{"type":"object","properties":{"connect":{"type":"number","exclusiveMinimum":0},"send":{"type":"number","exclusiveMinimum":0},"read":{"type":"number","exclusiveMinimum":0}},"required":["connect","send","read"]},"desc":{"type":"string","maxLength":256},"checks":{"type":"object","properties":{"active":{"type":"object","properties":{"concurrency":{"type":"integer","default":10},"http_path":{"type":"string","default":"\/"},"https_verify_certificate":{"type":"boolean","default":true},"port":{"type":"integer","minimum":1,"maximum":65535},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"req_headers":{"type":"array","minItems":1,"items":{"type":"string","uniqueItems":true}},"unhealthy":{"type":"object","properties":{"timeouts":{"type":"integer","minimum":1,"maximum":254,"default":3},"interval":{"type":"integer","minimum":1,"default":1},"http_statuses":{"type":"array","default":[429,404,500,501,502,503,504,505],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":599},"uniqueItems":true},"http_failures":{"type":"integer","minimum":1,"maximum":254,"default":5},"tcp_failures":{"type":"integer","minimum":1,"maximum":254,"default":2}}},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"healthy":{"type":"object","properties":{"successes":{"type":"integer","minimum":1,"maximum":254,"default":2},"interval":{"type":"integer","minimum":1,"default":1},"http_statuses":{"type":"array","default":[200,302],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":599},"uniqueItems":true}}},"timeout":{"type":"number","default":1}}},"passive":{"type":"object","properties":{"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"unhealthy":{"type":"object","properties":{"timeouts":{"type":"integer","minimum":1,"maximum":254,"default":7},"http_statuses":{"type":"array","default":[429,500,503],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":599},"uniqueItems":true},"http_failures":{"type":"integer","minimum":1,"maximum":254,"default":5},"tcp_failures":{"type":"integer","minimum":1,"maximum":254,"default":2}}},"healthy":{"type":"object","properties":{"successes":{"type":"integer","minimum":1,"maximum":254,"default":5},"http_statuses":{"type":"array","default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":599},"uniqueItems":true}}}}}},"additionalProperties":false,"anyOf":[{"required":["active"]},{"required":["active","passive"]}]},"pass_host":{"type":"string","default":"pass","enum":["pass","node","rewrite"],"description":"mod of host passing"},"update_time":{"type":"integer"},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"scheme":{"enum":["grpc","grpcs","http","https"],"default":"http"},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"type":"integer","minimum":0,"description":"weight of node"}}},{"type":"array","items":{"type":"object","properties":{"weight":{"type":"integer","minimum":0,"description":"weight of node"},"priority":{"type":"integer","default":0,"description":"priority of node"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"metadata":{"type":"object","description":"metadata of node"},"port":{"type":"integer","minimum":1,"description":"port of node"}},"required":["host","port","weight"]}}]},"service_name":{"type":"string","minLength":1,"maxLength":256},"key":{"type":"string","description":"the key of chash for dynamic load balancing"},"hash_on":{"type":"string","default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"]},"name":{"type":"string","minLength":1,"maxLength":100}},"additionalProperties":false,"oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}]},"create_time":{"type":"integer"},"uri":{"type":"string","minLength":1,"maxLength":4096},"uris":{"type":"array","minItems":1,"items":{"type":"string","description":"HTTP uri"},"uniqueItems":true},"remote_addr":{"type":"string","anyOf":[{"title":"IPv4","format":"ipv4","type":"string"},{"title":"IPv4\/CIDR","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$","type":"string"},{"title":"IPv6","format":"ipv6","type":"string"},{"title":"IPv6\/CIDR","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$","type":"string"}],"description":"client IP"},"methods":{"type":"array","items":{"type":"string","enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE"],"description":"HTTP method"},"uniqueItems":true},"script":{"type":"string","minLength":10,"maxLength":102400},"hosts":{"type":"array","minItems":1,"items":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"uniqueItems":true},"remote_addrs":{"type":"array","minItems":1,"items":{"type":"string","anyOf":[{"title":"IPv4","format":"ipv4","type":"string"},{"title":"IPv4\/CIDR","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$","type":"string"},{"title":"IPv6","format":"ipv6","type":"string"},{"title":"IPv6\/CIDR","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$","type":"string"}],"description":"client IP"},"uniqueItems":true},"filter_func":{"type":"string","pattern":"^function","minLength":10}},"anyOf":[{"required":["plugins","uri"]},{"required":["upstream","uri"]},{"required":["upstream_id","uri"]},{"required":["service_id","uri"]},{"required":["plugins","uris"]},{"required":["upstream","uris"]},{"required":["upstream_id","uris"]},{"required":["service_id","uris"]},{"required":["script","uri"]},{"required":["script","uris"]}],"additionalProperties":false,"not":{"anyOf":[{"required":["script","plugins"]},{"required":["script","plugin_config_id"]}]},"allOf":[{"oneOf":[{"required":["uri"]},{"required":["uris"]}]},{"oneOf":[{"not":{"anyOf":[{"required":["host"]},{"required":["hosts"]}]}},{"required":["host"]},{"required":["hosts"]}]},{"oneOf":[{"not":{"anyOf":[{"required":["remote_addr"]},{"required":["remote_addrs"]}]}},{"required":["remote_addr"]},{"required":["remote_addrs"]}]}]},"consumer":{"type":"object","properties":{"plugins":{"type":"object"},"create_time":{"type":"integer"},"update_time":{"type":"integer"},"labels":{"type":"object","maxProperties":16,"patternProperties":{".*":{"type":"string","description":"value of label","pattern":"^\\S+$","minLength":1,"maxLength":64}},"description":"key\/value pairs to specify attributes"},"desc":{"type":"string","maxLength":256},"username":{"type":"string","pattern":"^[a-zA-Z0-9_]+$","minLength":1,"maxLength":32}},"additionalProperties":false,"required":["username"]}},"plugins":{"kafka-logger":{"schema":{"type":"object","properties":{"kafka_topic":{"type":"string"},"max_retry_count":{"type":"integer","minimum":0,"default":0},"retry_delay":{"type":"integer","minimum":0,"default":1},"buffer_duration":{"type":"integer","minimum":1,"default":60},"inactive_timeout":{"type":"integer","minimum":1,"default":5},"batch_max_size":{"type":"integer","minimum":1,"default":1000},"include_req_body":{"type":"boolean","default":false},"disable":{"type":"boolean"},"broker_list":{"type":"object"},"key":{"type":"string"},"meta_format":{"type":"string","default":"default","enum":["default","origin"]},"name":{"type":"string","default":"kafka logger"},"timeout":{"type":"integer","minimum":1,"default":3}},"$comment":"this is a mark for our injected plugin schema","required":["broker_list","kafka_topic"]},"priority":403,"version":0.1},"proxy-cache":{"schema":{"type":"object","properties":{"cache_zone":{"type":"string","default":"disk_cache_one","minLength":1,"maxLength":100},"cache_key":{"type":"array","minItems":1,"items":{"type":"string","pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)","description":"a key for caching"},"default":["$host","$request_uri"]},"cache_bypass":{"type":"array","minItems":1,"items":{"type":"string","pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)"}},"no_cache":{"type":"array","minItems":1,"items":{"type":"string","pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)"}},"disable":{"type":"boolean"},"cache_http_status":{"type":"array","default":[200,301,404],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":599,"description":"http response status"},"uniqueItems":true},"hide_cache_headers":{"type":"boolean","default":false},"cache_method":{"type":"array","default":["GET","HEAD"],"minItems":1,"items":{"type":"string","enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE"],"description":"http method"},"uniqueItems":true}},"$comment":"this is a mark for our injected plugin schema"},"priority":1009,"version":0.1},"uri-blocker":{"schema":{"type":"object","properties":{"rejected_code":{"type":"integer","minimum":200,"default":403},"block_rules":{"type":"array","items":{"type":"string","minLength":1,"maxLength":4096},"uniqueItems":true},"disable":{"type":"boolean"}},"$comment":"this is a mark for our injected plugin schema","required":["block_rules"]},"priority":2900,"version":0.1},"limit-count":{"schema":{"type":"object","properties":{"rejected_code":{"type":"integer","minimum":200,"maximum":599,"default":503},"policy":{"type":"string","default":"local","enum":["local","redis","redis-cluster"]},"count":{"type":"integer","exclusiveMinimum":0},"time_window":{"type":"integer","exclusiveMinimum":0},"disable":{"type":"boolean"},"key":{"type":"string","default":"remote_addr","enum":["remote_addr","server_addr","http_x_real_ip","http_x_forwarded_for","consumer_name","service_id"]}},"$comment":"this is a mark for our injected plugin schema","dependencies":{"policy":{"oneOf":[{"properties":{"policy":{"enum":["local"]}}},{"required":["redis_host"],"properties":{"redis_timeout":{"type":"integer","minimum":1,"default":1000},"policy":{"enum":["redis"]},"redis_host":{"type":"string","minLength":2},"redis_port":{"type":"integer","minimum":1,"default":6379},"redis_password":{"type":"string","minLength":0},"redis_database":{"type":"integer","minimum":0,"default":0}}},{"required":["redis_cluster_nodes"],"properties":{"redis_timeout":{"type":"integer","minimum":1,"default":1000},"redis_cluster_nodes":{"type":"array","minItems":2,"items":{"type":"string","minLength":2,"maxLength":100}},"redis_password":{"type":"string","minLength":0},"policy":{"enum":["redis-cluster"]}}}]}},"required":["count","time_window"]},"priority":1002,"version":0.4},"traffic-split":{"schema":{"type":"object","properties":{"rules":{"type":"array","items":{"type":"object","properties":{"match":{"type":"array","default":[{"vars":[["server_port",">",0]]}],"items":{"type":"object","properties":{"vars":{"type":"array"}}}},"weighted_upstreams":{"type":"array","maxItems":20,"default":[{"weight":1}],"items":{"type":"object","properties":{"upstream":{"type":"object","properties":{"create_time":{"type":"integer"},"retries":{"type":"integer","minimum":0},"type":{"type":"string","enum":["chash","roundrobin","ewma","least_conn"],"description":"algorithms of load balancing"},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64},{"type":"integer","minimum":1}]},"labels":{"type":"object","maxProperties":16,"patternProperties":{".*":{"type":"string","description":"value of label","pattern":"^\\S+$","minLength":1,"maxLength":64}},"description":"key\/value pairs to specify attributes"},"discovery_type":{"type":"string","description":"discovery type"},"timeout":{"type":"object","properties":{"connect":{"type":"number","exclusiveMinimum":0},"send":{"type":"number","exclusiveMinimum":0},"read":{"type":"number","exclusiveMinimum":0}},"required":["connect","send","read"]},"desc":{"type":"string","maxLength":256},"checks":{"type":"object","properties":{"active":{"type":"object","properties":{"concurrency":{"type":"integer","default":10},"http_path":{"type":"string","default":"\/"},"https_verify_certificate":{"type":"boolean","default":true},"port":{"type":"integer","minimum":1,"maximum":65535},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"req_headers":{"type":"array","minItems":1,"items":{"type":"string","uniqueItems":true}},"unhealthy":{"type":"object","properties":{"timeouts":{"type":"integer","minimum":1,"maximum":254,"default":3},"interval":{"type":"integer","minimum":1,"default":1},"http_statuses":{"type":"array","default":[429,404,500,501,502,503,504,505],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":599},"uniqueItems":true},"http_failures":{"type":"integer","minimum":1,"maximum":254,"default":5},"tcp_failures":{"type":"integer","minimum":1,"maximum":254,"default":2}}},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"healthy":{"type":"object","properties":{"successes":{"type":"integer","minimum":1,"maximum":254,"default":2},"interval":{"type":"integer","minimum":1,"default":1},"http_statuses":{"type":"array","default":[200,302],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":599},"uniqueItems":true}}},"timeout":{"type":"number","default":1}}},"passive":{"type":"object","properties":{"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"unhealthy":{"type":"object","properties":{"timeouts":{"type":"integer","minimum":1,"maximum":254,"default":7},"http_statuses":{"type":"array","default":[429,500,503],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":599},"uniqueItems":true},"http_failures":{"type":"integer","minimum":1,"maximum":254,"default":5},"tcp_failures":{"type":"integer","minimum":1,"maximum":254,"default":2}}},"healthy":{"type":"object","properties":{"successes":{"type":"integer","minimum":1,"maximum":254,"default":5},"http_statuses":{"type":"array","default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":599},"uniqueItems":true}}}}}},"additionalProperties":false,"anyOf":[{"required":["active"]},{"required":["active","passive"]}]},"pass_host":{"type":"string","default":"pass","enum":["pass","node","rewrite"],"description":"mod of host passing"},"update_time":{"type":"integer"},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"scheme":{"enum":["grpc","grpcs","http","https"],"default":"http"},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"type":"integer","minimum":0,"description":"weight of node"}}},{"type":"array","items":{"type":"object","properties":{"weight":{"type":"integer","minimum":0,"description":"weight of node"},"priority":{"type":"integer","default":0,"description":"priority of node"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"metadata":{"type":"object","description":"metadata of node"},"port":{"type":"integer","minimum":1,"description":"port of node"}},"required":["host","port","weight"]}}]},"service_name":{"type":"string","minLength":1,"maxLength":256},"key":{"type":"string","description":"the key of chash for dynamic load balancing"},"hash_on":{"type":"string","default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"]},"name":{"type":"string","minLength":1,"maxLength":100}},"additionalProperties":false,"oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}]},"weight":{"type":"integer","default":1,"minimum":0,"description":"used to split traffic between differentupstreams for plugin configuration"},"upstream_id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64},{"type":"integer","minimum":1}]}}},"minItems":1}},"additionalProperties":false}},"disable":{"type":"boolean"}},"additionalProperties":false,"$comment":"this is a mark for our injected plugin schema"},"priority":966,"version":0.1},"response-rewrite":{"schema":{"type":"object","properties":{"status_code":{"type":"integer","minimum":200,"maximum":598,"description":"new status code for response"},"vars":{"type":"array"},"body":{"type":"string","description":"new body for response"},"disable":{"type":"boolean"},"headers":{"type":"object","minProperties":1,"description":"new headers for response"},"body_base64":{"type":"boolean","default":false,"description":"whether new body for response need base64 decode before return"}},"additionalProperties":false,"$comment":"this is a mark for our injected plugin schema","minProperties":1},"priority":899,"version":0.1},"referer-restriction":{"schema":{"type":"object","properties":{"whitelist":{"type":"array","minItems":1,"items":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"}},"disable":{"type":"boolean"},"bypass_missing":{"type":"boolean","default":false}},"additionalProperties":false,"$comment":"this is a mark for our injected plugin schema","required":["whitelist"]},"priority":2990,"version":0.1},"key-auth":{"type":"auth","consumer_schema":{"type":"object","properties":{"key":{"type":"string"}},"additionalProperties":false,"required":["key"]},"priority":2500,"schema":{"type":"object","properties":{"disable":{"type":"boolean"}},"additionalProperties":false,"$comment":"this is a mark for our injected plugin schema"},"version":0.1},"limit-req":{"schema":{"type":"object","properties":{"rejected_code":{"type":"integer","minimum":200,"maximum":599,"default":503},"rate":{"type":"number","exclusiveMinimum":0},"burst":{"type":"number","minimum":0},"disable":{"type":"boolean"},"key":{"type":"string","enum":["remote_addr","server_addr","http_x_real_ip","http_x_forwarded_for","consumer_name"]}},"$comment":"this is a mark for our injected plugin schema","required":["rate","burst","key"]},"priority":1001,"version":0.1},"proxy-mirror":{"schema":{"type":"object","properties":{"disable":{"type":"boolean"},"host":{"type":"string","pattern":"^http(s)?:\\\/\\\/[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+(:[0-9]{1,5})?$"}},"$comment":"this is a mark for our injected plugin schema","minProperties":1,"required":["host"]},"priority":1010,"version":0.1},"http-logger":{"metadata_schema":{"type":"object","properties":{"log_format":{"type":"object","default":{"host":"$host","@timestamp":"$time_iso8601","client_ip":"$remote_addr"}}},"additionalProperties":false},"schema":{"type":"object","properties":{"max_retry_count":{"type":"integer","minimum":0,"default":0},"retry_delay":{"type":"integer","minimum":0,"default":1},"buffer_duration":{"type":"integer","minimum":1,"default":60},"inactive_timeout":{"type":"integer","minimum":1,"default":5},"batch_max_size":{"type":"integer","minimum":1,"default":1000},"include_req_body":{"type":"boolean","default":false},"uri":{"type":"string","pattern":"^[^\\\/]+:\\\/\\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?"},"disable":{"type":"boolean"},"concat_method":{"type":"string","default":"json","enum":["json","new_line"]},"name":{"type":"string","default":"http logger"},"auth_header":{"type":"string","default":""},"timeout":{"type":"integer","minimum":1,"default":3}},"$comment":"this is a mark for our injected plugin schema","required":["uri"]},"version":0.1,"priority":410},"consumer-restriction":{"schema":{"type":"object","properties":{"type":{"type":"string","default":"consumer_name","enum":["consumer_name","service_id"]},"blacklist":{"type":"array","minItems":1,"items":{"type":"string"}},"allowed_by_methods":{"type":"array","items":{"type":"object","properties":{"methods":{"type":"array","minItems":1,"items":{"type":"string","enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE"]}},"user":{"type":"string"}}}},"disable":{"type":"boolean"},"rejected_code":{"type":"integer","minimum":200,"default":403},"whitelist":{"type":"array","minItems":1,"items":{"type":"string"}}},"anyOf":[{"required":["blacklist"]},{"required":["whitelist"]},{"required":["allowed_by_methods"]}],"$comment":"this is a mark for our injected plugin schema"},"priority":2400,"version":0.1},"limit-conn":{"schema":{"type":"object","properties":{"rejected_code":{"type":"integer","minimum":200,"maximum":599,"default":503},"conn":{"type":"integer","exclusiveMinimum":0},"default_conn_delay":{"type":"number","exclusiveMinimum":0},"burst":{"type":"integer","minimum":0},"disable":{"type":"boolean"},"key":{"type":"string","enum":["remote_addr","server_addr","http_x_real_ip","http_x_forwarded_for","consumer_name"]}},"$comment":"this is a mark for our injected plugin schema","required":["conn","burst","default_conn_delay","key"]},"priority":1003,"version":0.1},"grpc-transcode":{"version":0.1,"priority":506,"schema":{"type":"object","properties":{"pb_option":{"type":"array","minItems":1,"items":{"type":"string","anyOf":[{"type":"string","enum":["int64_as_number","int64_as_string","int64_as_hexstring"],"description":"enum as result"},{"type":"string","enum":["enum_as_name","enum_as_value"],"description":"int64 as result"},{"type":"string","enum":["auto_default_values","no_default_values","use_default_values","use_default_metatable"],"description":"default values option"},{"type":"string","enum":["enable_hooks","disable_hooks"],"description":"hooks option"}]}},"method":{"type":"string","description":"the method name in the grpc service."},"service":{"type":"string","description":"the grpc service name"},"disable":{"type":"boolean"},"deadline":{"type":"number","default":0,"description":"deadline for grpc, millisecond"},"proto_id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64},{"type":"integer","minimum":1}]}},"additionalProperties":true,"$comment":"this is a mark for our injected plugin schema","required":["proto_id","service","method"]}},"sls-logger":{"schema":{"type":"object","properties":{"disable":{"type":"boolean"},"name":{"type":"string","default":"sls-logger"},"retry_delay":{"type":"integer","minimum":0,"default":1},"buffer_duration":{"type":"integer","minimum":1,"default":60},"inactive_timeout":{"type":"integer","minimum":1,"default":5},"batch_max_size":{"type":"integer","minimum":1,"default":1000},"include_req_body":{"type":"boolean","default":false},"access_key_secret":{"type":"string"},"access_key_id":{"type":"string"},"logstore":{"type":"string"},"project":{"type":"string"},"port":{"type":"integer"},"host":{"type":"string"},"max_retry_count":{"type":"integer","minimum":0,"default":0},"timeout":{"type":"integer","minimum":1,"default":5000}},"$comment":"this is a mark for our injected plugin schema","required":["host","port","project","logstore","access_key_id","access_key_secret"]},"priority":406,"version":0.1},"wolf-rbac":{"type":"auth","schema":{"type":"object","properties":{"server":{"type":"string","default":"http:\/\/127.0.0.1:10080"},"header_prefix":{"type":"string","default":"X-"},"appid":{"type":"string","default":"unset"},"disable":{"type":"boolean"}},"$comment":"this is a mark for our injected plugin schema"},"version":0.1,"priority":2555},"request-id":{"schema":{"type":"object","properties":{"include_in_response":{"type":"boolean","default":true},"disable":{"type":"boolean"},"header_name":{"type":"string","default":"X-Request-Id"}},"$comment":"this is a mark for our injected plugin schema"},"priority":11010,"version":0.1},"ip-restriction":{"schema":{"type":"object","oneOf":[{"title":"whitelist","properties":{"whitelist":{"type":"array","minItems":1,"items":{"anyOf":[{"title":"IPv4","format":"ipv4","type":"string"},{"title":"IPv4\/CIDR","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$","type":"string"},{"title":"IPv6","format":"ipv6","type":"string"},{"title":"IPv6\/CIDR","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$","type":"string"}]}}},"additionalProperties":false,"required":["whitelist"]},{"title":"blacklist","properties":{"blacklist":{"type":"array","minItems":1,"items":{"anyOf":[{"title":"IPv4","format":"ipv4","type":"string"},{"title":"IPv4\/CIDR","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$","type":"string"},{"title":"IPv6","format":"ipv6","type":"string"},{"title":"IPv6\/CIDR","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$","type":"string"}]}}},"additionalProperties":false,"required":["blacklist"]}],"properties":{"disable":{"type":"boolean"}},"$comment":"this is a mark for our injected plugin schema"},"priority":3000,"version":0.1},"syslog":{"schema":{"type":"object","properties":{"disable":{"type":"boolean"},"name":{"type":"string","default":"sys logger"},"tls":{"type":"boolean","default":false},"buffer_duration":{"type":"integer","minimum":1,"default":60},"port":{"type":"integer"},"batch_max_size":{"type":"integer","minimum":1,"default":1000},"include_req_body":{"type":"boolean","default":false},"pool_size":{"type":"integer","minimum":5,"default":5},"flush_limit":{"type":"integer","minimum":1,"default":4096},"drop_limit":{"type":"integer","default":1048576},"sock_type":{"type":"string","default":"tcp","enum":["tcp","udp"]},"max_retry_times":{"type":"integer","minimum":1,"default":1},"host":{"type":"string"},"retry_interval":{"type":"integer","minimum":0,"default":1},"timeout":{"type":"integer","minimum":1,"default":3}},"$comment":"this is a mark for our injected plugin schema","required":["host","port"]},"priority":401,"version":0.1},"node-status":{"schema":{"type":"object","properties":{"disable":{"type":"boolean"}},"additionalProperties":false,"$comment":"this is a mark for our injected plugin schema"},"priority":1000,"version":0.1},"api-breaker":{"schema":{"type":"object","properties":{"healthy":{"type":"object","properties":{"successes":{"type":"integer","minimum":1,"default":3},"http_statuses":{"type":"array","default":[200],"minItems":1,"items":{"type":"integer","minimum":200,"maximum":499},"uniqueItems":true}},"default":{"successes":3,"http_statuses":[200]}},"disable":{"type":"boolean"},"unhealthy":{"type":"object","properties":{"failures":{"type":"integer","minimum":1,"default":3},"http_statuses":{"type":"array","default":[500],"minItems":1,"items":{"type":"integer","minimum":500,"maximum":599},"uniqueItems":true}},"default":{"failures":3,"http_statuses":[500]}},"break_response_code":{"type":"integer","minimum":200,"maximum":599},"max_breaker_sec":{"type":"integer","minimum":3,"default":300}},"$comment":"this is a mark for our injected plugin schema","required":["break_response_code"]},"priority":1005,"version":0.1},"proxy-rewrite":{"schema":{"type":"object","properties":{"scheme":{"type":"string","enum":["http","https"],"description":"new scheme for upstream"},"uri":{"type":"string","description":"new uri for upstream","pattern":"^\\\/.*","minLength":1,"maxLength":4096},"disable":{"type":"boolean"},"host":{"type":"string","pattern":"^[0-9a-zA-Z-.]+(:\\d{1,5})?$","description":"new host for upstream"},"regex_uri":{"type":"array","items":{"type":"string","description":"regex uri"},"minItems":2,"maxItems":2,"description":"new uri that substitute from client uri for upstream, lower priority than uri property"},"headers":{"type":"object","minProperties":1,"description":"new headers for request"}},"additionalProperties":false,"$comment":"this is a mark for our injected plugin schema","minProperties":1},"priority":1008,"version":0.1},"basic-auth":{"type":"auth","consumer_schema":{"type":"object","properties":{"password":{"type":"string"},"username":{"type":"string"}},"additionalProperties":false,"title":"work with consumer object","required":["username","password"]},"priority":2520,"schema":{"type":"object","properties":{"disable":{"type":"boolean"}},"additionalProperties":false,"$comment":"this is a mark for our injected plugin schema","title":"work with route or service object"},"version":0.1},"hmac-auth":{"type":"auth","consumer_schema":{"type":"object","properties":{"encode_uri_params":{"type":"boolean","default":true,"title":"Whether to escape the uri parameter"},"keep_headers":{"type":"boolean","default":false,"title":"whether to keep the http request header"},"clock_skew":{"type":"integer","default":0},"signed_headers":{"type":"array","items":{"type":"string","minLength":1,"maxLength":50}},"access_key":{"type":"string","minLength":1,"maxLength":256},"secret_key":{"type":"string","minLength":1,"maxLength":256},"algorithm":{"type":"string","default":"hmac-sha256","enum":["hmac-sha1","hmac-sha256","hmac-sha512"]}},"additionalProperties":false,"title":"work with consumer object","required":["access_key","secret_key"]},"priority":2530,"schema":{"type":"object","properties":{"disable":{"type":"boolean"}},"additionalProperties":false,"$comment":"this is a mark for our injected plugin schema","title":"work with route or service object"},"version":0.1},"serverless-pre-function":{"version":0.1,"priority":10000,"schema":{"type":"object","properties":{"phase":{"type":"string","default":"access","enum":["rewrite","access","header_filter","body_filter","log","balancer"]},"functions":{"type":"array","minItems":1,"items":{"type":"string"}},"disable":{"type":"boolean"}},"$comment":"this is a mark for our injected plugin schema","required":["functions"]}},"redirect":{"schema":{"type":"object","properties":{"uri":{"type":"string","pattern":"(\\\\\\$[0-9a-zA-Z_]+)|\\$\\{([0-9a-zA-Z_]+)\\}|\\$([0-9a-zA-Z_]+)|(\\$|[^$\\\\]+)","minLength":2},"disable":{"type":"boolean"},"ret_code":{"type":"integer","minimum":200,"default":302},"http_to_https":{"type":"boolean"}},"oneOf":[{"required":["uri"]},{"required":["http_to_https"]}],"$comment":"this is a mark for our injected plugin schema"},"priority":900,"version":0.1},"zipkin":{"version":0.1,"priority":11011,"schema":{"type":"object","properties":{"endpoint":{"type":"string"},"sample_ratio":{"type":"number","minimum":1e-05,"maximum":1},"disable":{"type":"boolean"},"service_name":{"type":"string","default":"APISIX","description":"service name for zipkin reporter"},"server_addr":{"type":"string","pattern":"^[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}$","description":"default is $server_addr, you can specify your external ip address"},"span_version":{"enum":[1,2],"default":2}},"$comment":"this is a mark for our injected plugin schema","required":["endpoint","sample_ratio"]}},"request-validation":{"type":"validation","version":0.1,"schema":{"type":"object","properties":{"disable":{"type":"boolean"}},"anyOf":[{"title":"Body schema","properties":{"body_schema":{"type":"object"}},"required":["body_schema"]},{"title":"Header schema","properties":{"header_schema":{"type":"object"}},"required":["header_schema"]}],"$comment":"this is a mark for our injected plugin schema"},"priority":2800},"openid-connect":{"schema":{"type":"object","properties":{"client_id":{"type":"string"},"public_key":{"type":"string"},"introspection_endpoint_auth_method":{"type":"string","default":"client_secret_basic"},"bearer_only":{"type":"boolean","default":false},"ssl_verify":{"type":"boolean","default":false},"logout_path":{"type":"string","default":"\/logout"},"redirect_uri":{"type":"string","description":"use ngx.var.request_uri if not configured"},"token_signing_alg_values_expected":{"type":"string"},"set_access_token_header":{"type":"boolean","default":true,"description":"Whether the access token should be added as a header to the request for downstream"},"access_token_in_authorization_header":{"type":"boolean","default":false,"description":"Whether the access token should be added in the Authorization header as opposed to the X-Access-Token header."},"disable":{"type":"boolean"},"set_id_token_header":{"type":"boolean","default":true,"description":"Whether the ID token should be added in the X-ID-Token header to the request for downstream."},"scope":{"type":"string","default":"openid"},"timeout":{"type":"integer","minimum":1,"default":3,"description":"timeout in seconds"},"set_userinfo_header":{"type":"boolean","default":true,"description":"Whether the user info token should be added in the X-Userinfo header to the request for downstream."},"discovery":{"type":"string"},"introspection_endpoint":{"type":"string"},"client_secret":{"type":"string"},"realm":{"type":"string","default":"apisix"}},"$comment":"this is a mark for our injected plugin schema","required":["client_id","client_secret","discovery"]},"priority":2599,"version":0.1},"prometheus":{"version":0.2,"priority":500,"schema":{"type":"object","properties":{"disable":{"type":"boolean"}},"additionalProperties":false,"$comment":"this is a mark for our injected plugin schema"}},"serverless-post-function":{"version":0.1,"priority":-2000,"schema":{"type":"object","properties":{"phase":{"type":"string","default":"access","enum":["rewrite","access","header_filter","body_filter","log","balancer"]},"functions":{"type":"array","minItems":1,"items":{"type":"string"}},"disable":{"type":"boolean"}},"$comment":"this is a mark for our injected plugin schema","required":["functions"]}},"jwt-auth":{"type":"auth","consumer_schema":{"type":"object","properties":{"exp":{"type":"integer","minimum":1,"default":86400},"secret":{"type":"string"},"key":{"type":"string"},"base64_secret":{"type":"boolean","default":false},"algorithm":{"type":"string","default":"HS256","enum":["HS256","HS512","RS256"]}},"dependencies":{"algorithm":{"oneOf":[{"properties":{"algorithm":{"enum":["HS256","HS512"],"default":"HS256"}}},{"required":["public_key","private_key"],"properties":{"public_key":{"type":"string"},"private_key":{"type":"string"},"algorithm":{"enum":["RS256"]}}}]}},"required":["key"]},"priority":2510,"schema":{"type":"object","properties":{"disable":{"type":"boolean"}},"additionalProperties":false,"$comment":"this is a mark for our injected plugin schema"},"version":0.1},"mqtt-proxy":{"schema":{"type":"object","properties":{"disable":{"type":"boolean"},"protocol_name":{"type":"string"},"protocol_level":{"type":"integer"},"upstream":{"type":"object","properties":{"ip":{"type":"string"},"port":{"type":"number"}}}},"$comment":"this is a mark for our injected plugin schema","required":["protocol_name","protocol_level","upstream"]},"priority":1000,"version":0.1},"identity-server4":{"type":"auth","version":0.1,"schema":{"type":"object","properties":{"public_key":{"type":"string","minItems":1},"disable":{"type":"boolean"},"identity_server_admin_api_uri":{"type":"string","minItems":1},"identity_server_uri":{"type":"string","minItems":1},"apisix_api_name":{"type":"string","minItems":1},"apisix_api_secrets":{"type":"string","minItems":1},"introspect_type":{"type":"string","enum":["public_key","identity_server"]}},"$comment":"this is a mark for our injected plugin schema","dependencies":{"introspect_type":{"oneOf":[{"required":["introspect_type","public_key"],"properties":{"public_key":{"type":"string"},"introspect_type":{"type":"string","enum":["public_key"]}}},{"required":["introspect_type","identity_server_uri","apisix_api_secrets","apisix_api_name"],"properties":{"identity_server_uri":{"type":"string"},"apisix_api_name":{"type":"string"},"apisix_api_secrets":{"type":"string"},"introspect_type":{"type":"string","enum":["identity_server"]}}}]}},"required":["identity_server_admin_api_uri","introspect_type"]},"priority":2599},"fault-injection":{"schema":{"type":"object","properties":{"disable":{"type":"boolean"},"delay":{"type":"object","properties":{"duration":{"type":"number","minimum":0},"vars":{"type":"array","item":{"type":"array"},"maxItems":20},"percentage":{"type":"integer","minimum":0,"maximum":100}},"required":["duration"]},"abort":{"type":"object","properties":{"body":{"type":"string","minLength":0},"http_status":{"type":"integer","minimum":200},"vars":{"type":"array","item":{"type":"array"},"maxItems":20},"percentage":{"type":"integer","minimum":0,"maximum":100}},"required":["http_status"]}},"minProperties":1,"$comment":"this is a mark for our injected plugin schema"},"priority":11000,"version":0.1},"server-info":{"version":0.1,"priority":990,"schema":{"type":"object","properties":{"disable":{"type":"boolean"}},"additionalProperties":false,"$comment":"this is a mark for our injected plugin schema"}},"udp-logger":{"schema":{"type":"object","properties":{"name":{"type":"string","default":"udp logger"},"buffer_duration":{"type":"integer","minimum":1,"default":60},"port":{"type":"integer","minimum":0},"batch_max_size":{"type":"integer","minimum":1,"default":1000},"include_req_body":{"type":"boolean","default":false},"disable":{"type":"boolean"},"host":{"type":"string"},"inactive_timeout":{"type":"integer","minimum":1,"default":5},"timeout":{"type":"integer","minimum":1,"default":3}},"$comment":"this is a mark for our injected plugin schema","required":["host","port"]},"priority":400,"version":0.1},"cors":{"schema":{"type":"object","properties":{"allow_origins":{"type":"string","default":"*","description":"you can use '*' to allow all origins when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple origin use ',' to split. default: *."},"max_age":{"type":"integer","default":5,"description":"maximum number of seconds the results can be cached.-1 mean no cached,the max value is depend on browser,more detail plz check MDN. default: 5."},"expose_headers":{"type":"string","default":"*","description":"you can use '*' to expose all header when no credentials,multiple header use ',' to split. default: *."},"allow_origins_by_regex":{"type":"array","uniqueItems":true,"minItems":1,"items":{"type":"string","minLength":1,"maxLength":4096},"description":"you can use regex to allow specific origins when no credentials,for example use [.*\\.test.com] to allow a.test.com and b.test.com"},"allow_methods":{"type":"string","default":"*","description":"you can use '*' to allow all methods when no credentials and '**','**' to allow forcefully(it will bring some security risks, be carefully),multiple method use ',' to split. default: *."},"disable":{"type":"boolean"},"allow_credential":{"type":"boolean","default":false,"description":"allow client append credential. according to CORS specification,if you set this option to 'true', you can not use '*' for other options."},"allow_headers":{"type":"string","default":"*","description":"you can use '*' to allow all header when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple header use ',' to split. default: *."}},"$comment":"this is a mark for our injected plugin schema"},"priority":4000,"version":0.1},"authz-keycloak":{"schema":{"type":"object","properties":{"client_id":{"type":"string","minLength":1,"maxLength":100},"token_endpoint":{"type":"string","minLength":1,"maxLength":4096},"resource_registration_endpoint":{"type":"string","minLength":1,"maxLength":4096},"keepalive_timeout":{"type":"integer","minimum":1000,"default":60000},"client_secret":{"type":"string","minLength":1,"maxLength":100},"keepalive":{"type":"boolean","default":true},"ssl_verify":{"type":"boolean","default":true},"timeout":{"type":"integer","minimum":1000,"default":3000},"lazy_load_paths":{"type":"boolean","default":false},"http_method_as_scope":{"type":"boolean","default":false},"cache_ttl_seconds":{"type":"integer","minimum":1,"default":86400},"disable":{"type":"boolean"},"grant_type":{"type":"string","enum":["urn:ietf:params:oauth:grant-type:uma-ticket"],"default":"urn:ietf:params:oauth:grant-type:uma-ticket","minLength":1,"maxLength":100},"permissions":{"type":"array","items":{"type":"string","minLength":1,"maxLength":100},"uniqueItems":true},"discovery":{"type":"string","minLength":1,"maxLength":4096},"policy_enforcement_mode":{"type":"string","default":"ENFORCING","enum":["ENFORCING","PERMISSIVE"]},"keepalive_pool":{"type":"integer","minimum":1,"default":5},"audience":{"type":"string","description":"Deprecated, use `client_id` instead.","minLength":1,"maxLength":100}},"$comment":"this is a mark for our injected plugin schema","allOf":[{"anyOf":[{"required":["discovery"]},{"required":["token_endpoint"]}]},{"anyOf":[{"required":["client_id"]},{"required":["audience"]}]},{"anyOf":[{"properties":{"lazy_load_paths":{"enum":[false]}}},{"anyOf":[{"required":["discovery"]},{"required":["resource_registration_endpoint"]}],"properties":{"lazy_load_paths":{"enum":[true]}}}]}]},"priority":2000,"version":0.1},"tcp-logger":{"schema":{"type":"object","properties":{"max_retry_count":{"type":"integer","minimum":0,"default":0},"retry_delay":{"type":"integer","minimum":0,"default":1},"buffer_duration":{"type":"integer","minimum":1,"default":60},"port":{"type":"integer","minimum":0},"batch_max_size":{"type":"integer","minimum":1,"default":1000},"include_req_body":{"type":"boolean","default":false},"tls_options":{"type":"string"},"disable":{"type":"boolean"},"inactive_timeout":{"type":"integer","minimum":1,"default":5},"name":{"type":"string","default":"tcp logger"},"tls":{"type":"boolean","default":false},"host":{"type":"string"},"timeout":{"type":"integer","minimum":1,"default":1000}},"$comment":"this is a mark for our injected plugin schema","required":["host","port"]},"priority":405,"version":0.1},"batch-requests":{"metadata_schema":{"type":"object","properties":{"max_body_size":{"type":"integer","default":1048576,"exclusiveMinimum":0,"description":"max pipeline body size in bytes"}},"additionalProperties":false},"schema":{"type":"object","properties":{"disable":{"type":"boolean"}},"additionalProperties":false,"$comment":"this is a mark for our injected plugin schema"},"version":0.1,"priority":4010},"echo":{"version":0.1,"priority":412,"schema":{"type":"object","properties":{"before_body":{"type":"string","description":"body before the filter phase."},"disable":{"type":"boolean"},"body":{"type":"string","description":"body to replace upstream response."},"after_body":{"type":"string","description":"body after the modification of filter phase."},"auth_value":{"type":"string","description":"auth value"},"headers":{"type":"object","minProperties":1,"description":"new headers for response"}},"anyOf":[{"required":["before_body"]},{"required":["body"]},{"required":["after_body"]}],"$comment":"this is a mark for our injected plugin schema","minProperties":1,"additionalProperties":false}}}}
