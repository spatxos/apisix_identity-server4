{"main":{"upstream_hash_header_schema":{"type":"string","pattern":"^[a-zA-Z0-9-_]+$"},"plugins":{"type":"array","items":{"type":"object","properties":{"stream":{"type":"boolean"},"name":{"type":"string","minLength":1},"additionalProperties":false},"required":["name"]}},"route":{"not":{"anyOf":[{"required":["script","plugins"]},{"required":["script","plugin_config_id"]}]},"properties":{"plugins":{"type":"object"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"service_protocol":{"enum":["grpc","http"]},"status":{"description":"route status, 1 to enable, 0 to disable","default":1,"type":"integer","enum":[1,0]},"remote_addr":{"description":"client IP","type":"string","anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4\/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6\/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}]},"service_id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64,"minLength":1},{"type":"integer","minimum":1}]},"desc":{"type":"string","maxLength":256},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64,"minLength":1},{"type":"integer","minimum":1}]},"update_time":{"type":"integer"},"upstream_id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64,"minLength":1},{"type":"integer","minimum":1}]},"enable_websocket":{"description":"enable websocket for request","type":"boolean"},"plugin_config_id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64,"minLength":1},{"type":"integer","minimum":1}]},"priority":{"type":"integer","default":0},"name":{"type":"string","maxLength":100,"minLength":1},"uris":{"type":"array","uniqueItems":true,"minItems":1,"items":{"description":"HTTP uri","type":"string"}},"script":{"type":"string","maxLength":102400,"minLength":10},"methods":{"type":"array","uniqueItems":true,"items":{"description":"HTTP method","type":"string","enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE"]}},"upstream":{"properties":{"scheme":{"enum":["grpc","grpcs","http","https"],"default":"http"},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"name":{"type":"string","maxLength":100,"minLength":1},"desc":{"type":"string","maxLength":256},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64,"minLength":1},{"type":"integer","minimum":1}]},"update_time":{"type":"integer"},"checks":{"type":"object","anyOf":[{"required":["active"]},{"required":["active","passive"]}],"properties":{"passive":{"type":"object","properties":{"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"healthy":{"type":"object","properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"type":"array","uniqueItems":true},"successes":{"type":"integer","default":5,"minimum":1,"maximum":254}}},"unhealthy":{"type":"object","properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"default":[429,500,503],"type":"array","uniqueItems":true},"timeouts":{"type":"integer","default":7,"minimum":1,"maximum":254},"tcp_failures":{"type":"integer","default":2,"minimum":1,"maximum":254},"http_failures":{"type":"integer","default":5,"minimum":1,"maximum":254}}}}},"active":{"type":"object","properties":{"port":{"type":"integer","minimum":1,"maximum":65535},"concurrency":{"type":"integer","default":10},"http_path":{"type":"string","default":"\/"},"healthy":{"type":"object","properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"default":[200,302],"type":"array","uniqueItems":true},"successes":{"type":"integer","default":2,"minimum":1,"maximum":254},"interval":{"type":"integer","minimum":1,"default":1}}},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"unhealthy":{"type":"object","properties":{"tcp_failures":{"type":"integer","default":2,"minimum":1,"maximum":254},"timeouts":{"type":"integer","default":3,"minimum":1,"maximum":254},"interval":{"type":"integer","minimum":1,"default":1},"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"default":[429,404,500,501,502,503,504,505],"type":"array","uniqueItems":true},"http_failures":{"type":"integer","default":5,"minimum":1,"maximum":254}}},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"req_headers":{"type":"array","minItems":1,"items":{"type":"string","uniqueItems":true}},"timeout":{"type":"number","default":1},"https_verify_certificate":{"type":"boolean","default":true}}}},"additionalProperties":false},"create_time":{"type":"integer"},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"description":"weight of node","minimum":0,"type":"integer"}}},{"type":"array","items":{"type":"object","properties":{"weight":{"description":"weight of node","minimum":0,"type":"integer"},"priority":{"description":"priority of node","type":"integer","default":0},"port":{"description":"port of node","minimum":1,"type":"integer"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"metadata":{"description":"metadata of node","type":"object"}},"required":["host","port","weight"]}}]},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"service_name":{"type":"string","maxLength":256,"minLength":1},"hash_on":{"type":"string","enum":["vars","header","cookie","consumer","vars_combinations"],"default":"vars"},"type":{"description":"algorithms of load balancing","type":"string","enum":["chash","roundrobin","ewma","least_conn"]},"timeout":{"type":"object","properties":{"read":{"type":"number","exclusiveMinimum":0},"send":{"type":"number","exclusiveMinimum":0},"connect":{"type":"number","exclusiveMinimum":0}},"required":["connect","send","read"]},"retries":{"type":"integer","minimum":0},"pass_host":{"description":"mod of host passing","default":"pass","type":"string","enum":["pass","node","rewrite"]},"labels":{"description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","minLength":1,"maxLength":64,"type":"string","pattern":"^\\S+$"}},"maxProperties":16,"type":"object"},"discovery_type":{"description":"discovery type","type":"string"}},"additionalProperties":false,"type":"object","oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}]},"hosts":{"type":"array","uniqueItems":true,"minItems":1,"items":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"}},"remote_addrs":{"type":"array","uniqueItems":true,"minItems":1,"items":{"description":"client IP","type":"string","anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4\/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6\/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}]}},"vars":{"type":"array"},"create_time":{"type":"integer"},"script_id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64,"minLength":1},{"type":"integer","minimum":1}]},"uri":{"type":"string","maxLength":4096,"minLength":1},"labels":{"description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","minLength":1,"maxLength":64,"type":"string","pattern":"^\\S+$"}},"maxProperties":16,"type":"object"},"filter_func":{"type":"string","pattern":"^function","minLength":10}},"additionalProperties":false,"type":"object","allOf":[{"oneOf":[{"required":["uri"]},{"required":["uris"]}]},{"oneOf":[{"not":{"anyOf":[{"required":["host"]},{"required":["hosts"]}]}},{"required":["host"]},{"required":["hosts"]}]},{"oneOf":[{"not":{"anyOf":[{"required":["remote_addr"]},{"required":["remote_addrs"]}]}},{"required":["remote_addr"]},{"required":["remote_addrs"]}]}],"anyOf":[{"required":["plugins","uri"]},{"required":["upstream","uri"]},{"required":["upstream_id","uri"]},{"required":["service_id","uri"]},{"required":["plugins","uris"]},{"required":["upstream","uris"]},{"required":["upstream_id","uris"]},{"required":["service_id","uris"]},{"required":["script","uri"]},{"required":["script","uris"]}]},"upstream":{"properties":{"scheme":{"enum":["grpc","grpcs","http","https"],"default":"http"},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"name":{"type":"string","maxLength":100,"minLength":1},"desc":{"type":"string","maxLength":256},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64,"minLength":1},{"type":"integer","minimum":1}]},"update_time":{"type":"integer"},"checks":{"type":"object","anyOf":[{"required":["active"]},{"required":["active","passive"]}],"properties":{"passive":{"type":"object","properties":{"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"healthy":{"type":"object","properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"type":"array","uniqueItems":true},"successes":{"type":"integer","default":5,"minimum":1,"maximum":254}}},"unhealthy":{"type":"object","properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"default":[429,500,503],"type":"array","uniqueItems":true},"timeouts":{"type":"integer","default":7,"minimum":1,"maximum":254},"tcp_failures":{"type":"integer","default":2,"minimum":1,"maximum":254},"http_failures":{"type":"integer","default":5,"minimum":1,"maximum":254}}}}},"active":{"type":"object","properties":{"port":{"type":"integer","minimum":1,"maximum":65535},"concurrency":{"type":"integer","default":10},"http_path":{"type":"string","default":"\/"},"healthy":{"type":"object","properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"default":[200,302],"type":"array","uniqueItems":true},"successes":{"type":"integer","default":2,"minimum":1,"maximum":254},"interval":{"type":"integer","minimum":1,"default":1}}},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"unhealthy":{"type":"object","properties":{"tcp_failures":{"type":"integer","default":2,"minimum":1,"maximum":254},"timeouts":{"type":"integer","default":3,"minimum":1,"maximum":254},"interval":{"type":"integer","minimum":1,"default":1},"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"default":[429,404,500,501,502,503,504,505],"type":"array","uniqueItems":true},"http_failures":{"type":"integer","default":5,"minimum":1,"maximum":254}}},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"req_headers":{"type":"array","minItems":1,"items":{"type":"string","uniqueItems":true}},"timeout":{"type":"number","default":1},"https_verify_certificate":{"type":"boolean","default":true}}}},"additionalProperties":false},"create_time":{"type":"integer"},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"description":"weight of node","minimum":0,"type":"integer"}}},{"type":"array","items":{"type":"object","properties":{"weight":{"description":"weight of node","minimum":0,"type":"integer"},"priority":{"description":"priority of node","type":"integer","default":0},"port":{"description":"port of node","minimum":1,"type":"integer"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"metadata":{"description":"metadata of node","type":"object"}},"required":["host","port","weight"]}}]},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"service_name":{"type":"string","maxLength":256,"minLength":1},"hash_on":{"type":"string","enum":["vars","header","cookie","consumer","vars_combinations"],"default":"vars"},"type":{"description":"algorithms of load balancing","type":"string","enum":["chash","roundrobin","ewma","least_conn"]},"timeout":{"type":"object","properties":{"read":{"type":"number","exclusiveMinimum":0},"send":{"type":"number","exclusiveMinimum":0},"connect":{"type":"number","exclusiveMinimum":0}},"required":["connect","send","read"]},"retries":{"type":"integer","minimum":0},"pass_host":{"description":"mod of host passing","default":"pass","type":"string","enum":["pass","node","rewrite"]},"labels":{"description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","minLength":1,"maxLength":64,"type":"string","pattern":"^\\S+$"}},"maxProperties":16,"type":"object"},"discovery_type":{"description":"discovery type","type":"string"}},"additionalProperties":false,"type":"object","oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}]},"proto":{"type":"object","required":["content"],"properties":{"create_time":{"type":"integer"},"desc":{"type":"string","maxLength":256},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64,"minLength":1},{"type":"integer","minimum":1}]},"update_time":{"type":"integer"},"content":{"type":"string","maxLength":1048576,"minLength":1}},"additionalProperties":false},"stream_route":{"type":"object","properties":{"server_port":{"description":"server port","type":"integer"},"create_time":{"type":"integer"},"upstream":{"properties":{"scheme":{"enum":["grpc","grpcs","http","https"],"default":"http"},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"name":{"type":"string","maxLength":100,"minLength":1},"desc":{"type":"string","maxLength":256},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64,"minLength":1},{"type":"integer","minimum":1}]},"update_time":{"type":"integer"},"checks":{"type":"object","anyOf":[{"required":["active"]},{"required":["active","passive"]}],"properties":{"passive":{"type":"object","properties":{"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"healthy":{"type":"object","properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"type":"array","uniqueItems":true},"successes":{"type":"integer","default":5,"minimum":1,"maximum":254}}},"unhealthy":{"type":"object","properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"default":[429,500,503],"type":"array","uniqueItems":true},"timeouts":{"type":"integer","default":7,"minimum":1,"maximum":254},"tcp_failures":{"type":"integer","default":2,"minimum":1,"maximum":254},"http_failures":{"type":"integer","default":5,"minimum":1,"maximum":254}}}}},"active":{"type":"object","properties":{"port":{"type":"integer","minimum":1,"maximum":65535},"concurrency":{"type":"integer","default":10},"http_path":{"type":"string","default":"\/"},"healthy":{"type":"object","properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"default":[200,302],"type":"array","uniqueItems":true},"successes":{"type":"integer","default":2,"minimum":1,"maximum":254},"interval":{"type":"integer","minimum":1,"default":1}}},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"unhealthy":{"type":"object","properties":{"tcp_failures":{"type":"integer","default":2,"minimum":1,"maximum":254},"timeouts":{"type":"integer","default":3,"minimum":1,"maximum":254},"interval":{"type":"integer","minimum":1,"default":1},"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"default":[429,404,500,501,502,503,504,505],"type":"array","uniqueItems":true},"http_failures":{"type":"integer","default":5,"minimum":1,"maximum":254}}},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"req_headers":{"type":"array","minItems":1,"items":{"type":"string","uniqueItems":true}},"timeout":{"type":"number","default":1},"https_verify_certificate":{"type":"boolean","default":true}}}},"additionalProperties":false},"create_time":{"type":"integer"},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"description":"weight of node","minimum":0,"type":"integer"}}},{"type":"array","items":{"type":"object","properties":{"weight":{"description":"weight of node","minimum":0,"type":"integer"},"priority":{"description":"priority of node","type":"integer","default":0},"port":{"description":"port of node","minimum":1,"type":"integer"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"metadata":{"description":"metadata of node","type":"object"}},"required":["host","port","weight"]}}]},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"service_name":{"type":"string","maxLength":256,"minLength":1},"hash_on":{"type":"string","enum":["vars","header","cookie","consumer","vars_combinations"],"default":"vars"},"type":{"description":"algorithms of load balancing","type":"string","enum":["chash","roundrobin","ewma","least_conn"]},"timeout":{"type":"object","properties":{"read":{"type":"number","exclusiveMinimum":0},"send":{"type":"number","exclusiveMinimum":0},"connect":{"type":"number","exclusiveMinimum":0}},"required":["connect","send","read"]},"retries":{"type":"integer","minimum":0},"pass_host":{"description":"mod of host passing","default":"pass","type":"string","enum":["pass","node","rewrite"]},"labels":{"description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","minLength":1,"maxLength":64,"type":"string","pattern":"^\\S+$"}},"maxProperties":16,"type":"object"},"discovery_type":{"description":"discovery type","type":"string"}},"additionalProperties":false,"type":"object","oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}]},"server_addr":{"description":"server IP","type":"string","anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4\/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6\/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}]},"remote_addr":{"description":"client IP","type":"string","anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4\/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6\/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}]},"plugins":{"type":"object"},"desc":{"type":"string","maxLength":256},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64,"minLength":1},{"type":"integer","minimum":1}]},"update_time":{"type":"integer"},"upstream_id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64,"minLength":1},{"type":"integer","minimum":1}]}}},"consumer":{"type":"object","required":["username"],"properties":{"username":{"type":"string","pattern":"^[a-zA-Z0-9_]+$","maxLength":32,"minLength":1},"create_time":{"type":"integer"},"desc":{"type":"string","maxLength":256},"update_time":{"type":"integer"},"labels":{"description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","minLength":1,"maxLength":64,"type":"string","pattern":"^\\S+$"}},"maxProperties":16,"type":"object"},"plugins":{"type":"object"}},"additionalProperties":false},"global_rule":{"required":["plugins"],"properties":{"update_time":{"type":"integer"},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64,"minLength":1},{"type":"integer","minimum":1}]},"plugins":{"type":"object"},"create_time":{"type":"integer"}},"additionalProperties":false,"type":"object"},"plugin_config":{"type":"object","required":["id","plugins"],"properties":{"plugins":{"type":"object"},"update_time":{"type":"integer"},"desc":{"type":"string","maxLength":256},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64,"minLength":1},{"type":"integer","minimum":1}]},"labels":{"description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","minLength":1,"maxLength":64,"type":"string","pattern":"^\\S+$"}},"maxProperties":16,"type":"object"},"create_time":{"type":"integer"}},"additionalProperties":false},"upstream_hash_vars_schema":{"type":"string","pattern":"^((uri|server_name|server_addr|request_uri|remote_port|remote_addr|query_string|host|hostname)|arg_[0-9a-zA-z_-]+)$"},"ssl":{"type":"object","oneOf":[{"required":["sni","key","cert"]},{"required":["snis","key","cert"]}],"properties":{"cert":{"type":"string","maxLength":65536,"minLength":128},"snis":{"type":"array","minItems":1,"items":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-.]+$"}},"certs":{"type":"array","items":{"type":"string","maxLength":65536,"minLength":128}},"sni":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-.]+$"},"validity_start":{"type":"integer"},"update_time":{"type":"integer"},"key":{"type":"string","maxLength":65536,"minLength":128},"exptime":{"type":"integer","minimum":1588262400},"create_time":{"type":"integer"},"validity_end":{"type":"integer"},"status":{"description":"ssl status, 1 to enable, 0 to disable","default":1,"type":"integer","enum":[1,0]},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64,"minLength":1},{"type":"integer","minimum":1}]},"labels":{"description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","minLength":1,"maxLength":64,"type":"string","pattern":"^\\S+$"}},"maxProperties":16,"type":"object"},"keys":{"type":"array","items":{"type":"string","maxLength":65536,"minLength":128}}},"additionalProperties":false},"service":{"type":"object","properties":{"enable_websocket":{"description":"enable websocket for request","type":"boolean"},"plugins":{"type":"object"},"script":{"type":"string","maxLength":102400,"minLength":10},"upstream":{"properties":{"scheme":{"enum":["grpc","grpcs","http","https"],"default":"http"},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"name":{"type":"string","maxLength":100,"minLength":1},"desc":{"type":"string","maxLength":256},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64,"minLength":1},{"type":"integer","minimum":1}]},"update_time":{"type":"integer"},"checks":{"type":"object","anyOf":[{"required":["active"]},{"required":["active","passive"]}],"properties":{"passive":{"type":"object","properties":{"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"healthy":{"type":"object","properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"type":"array","uniqueItems":true},"successes":{"type":"integer","default":5,"minimum":1,"maximum":254}}},"unhealthy":{"type":"object","properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"default":[429,500,503],"type":"array","uniqueItems":true},"timeouts":{"type":"integer","default":7,"minimum":1,"maximum":254},"tcp_failures":{"type":"integer","default":2,"minimum":1,"maximum":254},"http_failures":{"type":"integer","default":5,"minimum":1,"maximum":254}}}}},"active":{"type":"object","properties":{"port":{"type":"integer","minimum":1,"maximum":65535},"concurrency":{"type":"integer","default":10},"http_path":{"type":"string","default":"\/"},"healthy":{"type":"object","properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"default":[200,302],"type":"array","uniqueItems":true},"successes":{"type":"integer","default":2,"minimum":1,"maximum":254},"interval":{"type":"integer","minimum":1,"default":1}}},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"unhealthy":{"type":"object","properties":{"tcp_failures":{"type":"integer","default":2,"minimum":1,"maximum":254},"timeouts":{"type":"integer","default":3,"minimum":1,"maximum":254},"interval":{"type":"integer","minimum":1,"default":1},"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"default":[429,404,500,501,502,503,504,505],"type":"array","uniqueItems":true},"http_failures":{"type":"integer","default":5,"minimum":1,"maximum":254}}},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"req_headers":{"type":"array","minItems":1,"items":{"type":"string","uniqueItems":true}},"timeout":{"type":"number","default":1},"https_verify_certificate":{"type":"boolean","default":true}}}},"additionalProperties":false},"create_time":{"type":"integer"},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"description":"weight of node","minimum":0,"type":"integer"}}},{"type":"array","items":{"type":"object","properties":{"weight":{"description":"weight of node","minimum":0,"type":"integer"},"priority":{"description":"priority of node","type":"integer","default":0},"port":{"description":"port of node","minimum":1,"type":"integer"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"metadata":{"description":"metadata of node","type":"object"}},"required":["host","port","weight"]}}]},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"service_name":{"type":"string","maxLength":256,"minLength":1},"hash_on":{"type":"string","enum":["vars","header","cookie","consumer","vars_combinations"],"default":"vars"},"type":{"description":"algorithms of load balancing","type":"string","enum":["chash","roundrobin","ewma","least_conn"]},"timeout":{"type":"object","properties":{"read":{"type":"number","exclusiveMinimum":0},"send":{"type":"number","exclusiveMinimum":0},"connect":{"type":"number","exclusiveMinimum":0}},"required":["connect","send","read"]},"retries":{"type":"integer","minimum":0},"pass_host":{"description":"mod of host passing","default":"pass","type":"string","enum":["pass","node","rewrite"]},"labels":{"description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","minLength":1,"maxLength":64,"type":"string","pattern":"^\\S+$"}},"maxProperties":16,"type":"object"},"discovery_type":{"description":"discovery type","type":"string"}},"additionalProperties":false,"type":"object","oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}]},"update_time":{"type":"integer"},"name":{"type":"string","maxLength":100,"minLength":1},"create_time":{"type":"integer"},"desc":{"type":"string","maxLength":256},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64,"minLength":1},{"type":"integer","minimum":1}]},"labels":{"description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","minLength":1,"maxLength":64,"type":"string","pattern":"^\\S+$"}},"maxProperties":16,"type":"object"},"upstream_id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64,"minLength":1},{"type":"integer","minimum":1}]}},"additionalProperties":false}},"plugins":{"grpc-transcode":{"schema":{"required":["proto_id","service","method"],"properties":{"pb_option":{"type":"array","minItems":1,"items":{"type":"string","anyOf":[{"description":"enum as result","type":"string","enum":["int64_as_number","int64_as_string","int64_as_hexstring"]},{"description":"int64 as result","type":"string","enum":["enum_as_name","enum_as_value"]},{"description":"default values option","type":"string","enum":["auto_default_values","no_default_values","use_default_values","use_default_metatable"]},{"description":"hooks option","type":"string","enum":["enable_hooks","disable_hooks"]}]}},"method":{"description":"the method name in the grpc service.","type":"string"},"proto_id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64,"minLength":1},{"type":"integer","minimum":1}]},"disable":{"type":"boolean"},"deadline":{"description":"deadline for grpc, millisecond","type":"number","default":0},"service":{"description":"the grpc service name","type":"string"}},"additionalProperties":true,"type":"object","$comment":"this is a mark for our injected plugin schema"},"priority":506,"version":0.1},"ip-restriction":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","oneOf":[{"title":"whitelist","required":["whitelist"],"properties":{"whitelist":{"type":"array","minItems":1,"items":{"anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4\/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6\/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}]}}},"additionalProperties":false},{"title":"blacklist","required":["blacklist"],"properties":{"blacklist":{"type":"array","minItems":1,"items":{"anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4\/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6\/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}]}}},"additionalProperties":false}],"properties":{"disable":{"type":"boolean"}}},"priority":3000,"version":0.1},"batch-requests":{"metadata_schema":{"type":"object","properties":{"max_body_size":{"description":"max pipeline body size in bytes","exclusiveMinimum":0,"type":"integer","default":1048576}},"additionalProperties":false},"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"}},"additionalProperties":false},"priority":4010,"version":0.1},"zipkin":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"server_addr":{"type":"string","description":"default is $server_addr, you can specify your external ip address","pattern":"^[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}$"},"sample_ratio":{"type":"number","minimum":1e-05,"maximum":1},"endpoint":{"type":"string"},"span_version":{"default":2,"enum":[1,2]},"service_name":{"type":"string","description":"service name for zipkin reporter","default":"APISIX"}},"required":["endpoint","sample_ratio"]},"priority":11011,"version":0.1},"api-breaker":{"version":0.1,"priority":1005,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"break_response_code":{"type":"integer","minimum":200,"maximum":599},"max_breaker_sec":{"type":"integer","minimum":3,"default":300},"unhealthy":{"type":"object","properties":{"http_statuses":{"items":{"type":"integer","minimum":500,"maximum":599},"minItems":1,"default":[500],"type":"array","uniqueItems":true},"failures":{"type":"integer","minimum":1,"default":3}},"default":{"http_statuses":[500],"failures":3}},"healthy":{"type":"object","properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":499},"minItems":1,"default":[200],"type":"array","uniqueItems":true},"successes":{"type":"integer","minimum":1,"default":3}},"default":{"http_statuses":[200],"successes":3}},"disable":{"type":"boolean"}},"required":["break_response_code"]}},"prometheus":{"version":0.2,"priority":500,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"}},"additionalProperties":false}},"node-status":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"}},"additionalProperties":false},"priority":1000,"version":0.1},"syslog":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"flush_limit":{"type":"integer","minimum":1,"default":4096},"drop_limit":{"type":"integer","default":1048576},"sock_type":{"type":"string","enum":["tcp","udp"],"default":"tcp"},"max_retry_times":{"type":"integer","minimum":1,"default":1},"retry_interval":{"type":"integer","minimum":0,"default":1},"batch_max_size":{"type":"integer","minimum":1,"default":1000},"host":{"type":"string"},"include_req_body":{"type":"boolean","default":false},"disable":{"type":"boolean"},"name":{"type":"string","default":"sys logger"},"tls":{"type":"boolean","default":false},"timeout":{"type":"integer","minimum":1,"default":3},"buffer_duration":{"type":"integer","minimum":1,"default":60},"pool_size":{"type":"integer","minimum":5,"default":5},"port":{"type":"integer"}},"required":["host","port"]},"priority":401,"version":0.1},"mqtt-proxy":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"protocol_name":{"type":"string"},"protocol_level":{"type":"integer"},"upstream":{"type":"object","properties":{"ip":{"type":"string"},"port":{"type":"number"}}}},"required":["protocol_name","protocol_level","upstream"]},"priority":1000,"version":0.1},"response-rewrite":{"schema":{"properties":{"headers":{"description":"new headers for response","minProperties":1,"type":"object"},"status_code":{"description":"new status code for response","type":"integer","minimum":200,"maximum":598},"disable":{"type":"boolean"},"vars":{"type":"array"},"body":{"description":"new body for response","type":"string"},"body_base64":{"description":"whether new body for response need base64 decode before return","type":"boolean","default":false}},"additionalProperties":false,"type":"object","minProperties":1,"$comment":"this is a mark for our injected plugin schema"},"priority":899,"version":0.1},"server-info":{"version":0.1,"priority":990,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"}},"additionalProperties":false}},"jwt-auth":{"version":0.1,"priority":2510,"type":"auth","schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"}},"additionalProperties":false},"consumer_schema":{"type":"object","required":["key"],"properties":{"key":{"type":"string"},"base64_secret":{"type":"boolean","default":false},"algorithm":{"type":"string","default":"HS256","enum":["HS256","HS512","RS256"]},"exp":{"type":"integer","minimum":1,"default":86400},"secret":{"type":"string"}},"dependencies":{"algorithm":{"oneOf":[{"properties":{"algorithm":{"default":"HS256","enum":["HS256","HS512"]}}},{"properties":{"algorithm":{"enum":["RS256"]},"private_key":{"type":"string"},"public_key":{"type":"string"}},"required":["public_key","private_key"]}]}}}},"referer-restriction":{"schema":{"required":["whitelist"],"properties":{"bypass_missing":{"type":"boolean","default":false},"disable":{"type":"boolean"},"whitelist":{"type":"array","minItems":1,"items":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"}}},"additionalProperties":false,"type":"object","$comment":"this is a mark for our injected plugin schema"},"priority":2990,"version":0.1},"proxy-cache":{"schema":{"type":"object","properties":{"cache_zone":{"type":"string","default":"disk_cache_one","maxLength":100,"minLength":1},"cache_key":{"type":"array","items":{"description":"a key for caching","type":"string","pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)"},"minItems":1,"default":["$host","$request_uri"]},"hide_cache_headers":{"type":"boolean","default":false},"cache_bypass":{"type":"array","minItems":1,"items":{"type":"string","pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)"}},"no_cache":{"type":"array","minItems":1,"items":{"type":"string","pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)"}},"disable":{"type":"boolean"},"cache_http_status":{"items":{"description":"http response status","type":"integer","minimum":200,"maximum":599},"minItems":1,"default":[200,301,404],"type":"array","uniqueItems":true},"cache_method":{"items":{"description":"http method","type":"string","enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE"]},"minItems":1,"default":["GET","HEAD"],"type":"array","uniqueItems":true}},"$comment":"this is a mark for our injected plugin schema"},"priority":1009,"version":0.1},"authz-keycloak":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"token_endpoint":{"type":"string","maxLength":4096,"minLength":1},"resource_registration_endpoint":{"type":"string","maxLength":4096,"minLength":1},"client_id":{"type":"string","maxLength":100,"minLength":1},"audience":{"type":"string","description":"Deprecated, use `client_id` instead.","maxLength":100,"minLength":1},"client_secret":{"type":"string","maxLength":100,"minLength":1},"grant_type":{"minLength":1,"type":"string","maxLength":100,"default":"urn:ietf:params:oauth:grant-type:uma-ticket","enum":["urn:ietf:params:oauth:grant-type:uma-ticket"]},"policy_enforcement_mode":{"type":"string","default":"ENFORCING","enum":["ENFORCING","PERMISSIVE"]},"keepalive":{"type":"boolean","default":true},"timeout":{"type":"integer","minimum":1000,"default":3000},"permissions":{"type":"array","uniqueItems":true,"items":{"type":"string","maxLength":100,"minLength":1}},"lazy_load_paths":{"type":"boolean","default":false},"ssl_verify":{"type":"boolean","default":true},"cache_ttl_seconds":{"type":"integer","minimum":1,"default":86400},"keepalive_timeout":{"type":"integer","minimum":1000,"default":60000},"discovery":{"type":"string","maxLength":4096,"minLength":1},"disable":{"type":"boolean"},"keepalive_pool":{"type":"integer","minimum":1,"default":5},"http_method_as_scope":{"type":"boolean","default":false}},"allOf":[{"anyOf":[{"required":["discovery"]},{"required":["token_endpoint"]}]},{"anyOf":[{"required":["client_id"]},{"required":["audience"]}]},{"anyOf":[{"properties":{"lazy_load_paths":{"enum":[false]}}},{"properties":{"lazy_load_paths":{"enum":[true]}},"anyOf":[{"required":["discovery"]},{"required":["resource_registration_endpoint"]}]}]}]},"priority":2000,"version":0.1},"kafka-logger":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"meta_format":{"type":"string","enum":["default","origin"],"default":"default"},"batch_max_size":{"type":"integer","minimum":1,"default":1000},"broker_list":{"type":"object"},"kafka_topic":{"type":"string"},"key":{"type":"string"},"include_req_body":{"type":"boolean","default":false},"retry_delay":{"type":"integer","minimum":0,"default":1},"max_retry_count":{"type":"integer","minimum":0,"default":0},"timeout":{"type":"integer","minimum":1,"default":3},"inactive_timeout":{"type":"integer","minimum":1,"default":5},"buffer_duration":{"type":"integer","minimum":1,"default":60},"name":{"type":"string","default":"kafka logger"}},"required":["broker_list","kafka_topic"]},"priority":403,"version":0.1},"udp-logger":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"port":{"type":"integer","minimum":0},"batch_max_size":{"type":"integer","minimum":1,"default":1000},"buffer_duration":{"type":"integer","minimum":1,"default":60},"include_req_body":{"type":"boolean","default":false},"name":{"type":"string","default":"udp logger"},"inactive_timeout":{"type":"integer","minimum":1,"default":5},"host":{"type":"string"},"timeout":{"type":"integer","minimum":1,"default":3}},"required":["host","port"]},"priority":400,"version":0.1},"cors":{"schema":{"type":"object","properties":{"expose_headers":{"description":"you can use '*' to expose all header when no credentials,multiple header use ',' to split. default: *.","type":"string","default":"*"},"disable":{"type":"boolean"},"allow_methods":{"description":"you can use '*' to allow all methods when no credentials and '**','**' to allow forcefully(it will bring some security risks, be carefully),multiple method use ',' to split. default: *.","type":"string","default":"*"},"allow_origins_by_regex":{"items":{"type":"string","maxLength":4096,"minLength":1},"minItems":1,"type":"array","uniqueItems":true,"description":"you can use regex to allow specific origins when no credentials,for example use [.*\\.test.com] to allow a.test.com and b.test.com"},"allow_origins":{"description":"you can use '*' to allow all origins when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple origin use ',' to split. default: *.","type":"string","default":"*"},"allow_headers":{"description":"you can use '*' to allow all header when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple header use ',' to split. default: *.","type":"string","default":"*"},"allow_credential":{"description":"allow client append credential. according to CORS specification,if you set this option to 'true', you can not use '*' for other options.","type":"boolean","default":false},"max_age":{"description":"maximum number of seconds the results can be cached.-1 mean no cached,the max value is depend on browser,more detail plz check MDN. default: 5.","type":"integer","default":5}},"$comment":"this is a mark for our injected plugin schema"},"priority":4000,"version":0.1},"redirect":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"uri":{"type":"string","pattern":"(\\\\\\$[0-9a-zA-Z_]+)|\\$\\{([0-9a-zA-Z_]+)\\}|\\$([0-9a-zA-Z_]+)|(\\$|[^$\\\\]+)","minLength":2},"disable":{"type":"boolean"},"ret_code":{"type":"integer","minimum":200,"default":302},"http_to_https":{"type":"boolean"}},"oneOf":[{"required":["uri"]},{"required":["http_to_https"]}]},"priority":900,"version":0.1},"serverless-pre-function":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"functions":{"type":"array","minItems":1,"items":{"type":"string"}},"disable":{"type":"boolean"},"phase":{"type":"string","enum":["rewrite","access","header_filter","body_filter","log","balancer"],"default":"access"}},"required":["functions"]},"priority":10000,"version":0.1},"uri-blocker":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"rejected_code":{"type":"integer","minimum":200,"default":403},"disable":{"type":"boolean"},"block_rules":{"type":"array","uniqueItems":true,"items":{"type":"string","maxLength":4096,"minLength":1}}},"required":["block_rules"]},"priority":2900,"version":0.1},"request-id":{"schema":{"type":"object","properties":{"include_in_response":{"type":"boolean","default":true},"header_name":{"type":"string","default":"X-Request-Id"},"disable":{"type":"boolean"}},"$comment":"this is a mark for our injected plugin schema"},"priority":11010,"version":0.1},"proxy-mirror":{"schema":{"required":["host"],"properties":{"host":{"type":"string","pattern":"^http(s)?:\\\/\\\/[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+(:[0-9]{1,5})?$"},"disable":{"type":"boolean"}},"type":"object","minProperties":1,"$comment":"this is a mark for our injected plugin schema"},"priority":1010,"version":0.1},"fault-injection":{"schema":{"type":"object","minProperties":1,"properties":{"delay":{"type":"object","properties":{"percentage":{"type":"integer","minimum":0,"maximum":100},"duration":{"type":"number","minimum":0},"vars":{"type":"array","item":{"type":"array"},"maxItems":20}},"required":["duration"]},"disable":{"type":"boolean"},"abort":{"type":"object","properties":{"http_status":{"type":"integer","minimum":200},"vars":{"type":"array","item":{"type":"array"},"maxItems":20},"body":{"type":"string","minLength":0},"percentage":{"type":"integer","minimum":0,"maximum":100}},"required":["http_status"]}},"$comment":"this is a mark for our injected plugin schema"},"priority":11000,"version":0.1},"key-auth":{"version":0.1,"priority":2500,"type":"auth","schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"}},"additionalProperties":false},"consumer_schema":{"type":"object","required":["key"],"properties":{"key":{"type":"string"}},"additionalProperties":false}},"identity-server4":{"type":"auth","version":0.1,"priority":2599,"schema":{"required":["issuer","introspect_type"],"properties":{"disable":{"type":"boolean"},"introspect_type":{"type":"string","enum":["key","issuer"]},"api_name":{"type":"string","minItems":1},"api_secrets":{"type":"string","minItems":1},"issuer":{"type":"string","minItems":1},"public_key":{"type":"string","minItems":1}},"type":"object","$comment":"this is a mark for our injected plugin schema","dependencies":{"introspect_type":{"oneOf":[{"properties":{"introspect_type":{"type":"string","enum":["key"]},"public_key":{"type":"string"}},"required":["introspect_type","public_key"]},{"properties":{"introspect_type":{"type":"string","enum":["issuer"]},"api_secrets":{"type":"string"},"api_name":{"type":"string"}},"required":["introspect_type","api_secrets","api_name"]}]}}}},"openid-connect":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"token_signing_alg_values_expected":{"type":"string"},"set_access_token_header":{"description":"Whether the access token should be added as a header to the request for downstream","type":"boolean","default":true},"access_token_in_authorization_header":{"description":"Whether the access token should be added in the Authorization header as opposed to the X-Access-Token header.","type":"boolean","default":false},"introspection_endpoint_auth_method":{"type":"string","default":"client_secret_basic"},"bearer_only":{"type":"boolean","default":false},"realm":{"type":"string","default":"apisix"},"logout_path":{"type":"string","default":"\/logout"},"timeout":{"type":"integer","description":"timeout in seconds","minimum":1,"default":3},"ssl_verify":{"type":"boolean","default":false},"disable":{"type":"boolean"},"public_key":{"type":"string"},"discovery":{"type":"string"},"set_userinfo_header":{"description":"Whether the user info token should be added in the X-Userinfo header to the request for downstream.","type":"boolean","default":true},"set_id_token_header":{"description":"Whether the ID token should be added in the X-ID-Token header to the request for downstream.","type":"boolean","default":true},"scope":{"type":"string","default":"openid"},"client_secret":{"type":"string"},"introspection_endpoint":{"type":"string"},"redirect_uri":{"type":"string","description":"use ngx.var.request_uri if not configured"},"client_id":{"type":"string"}},"required":["client_id","client_secret","discovery"]},"priority":2599,"version":0.1},"http-logger":{"metadata_schema":{"type":"object","properties":{"log_format":{"type":"object","default":{"@timestamp":"$time_iso8601","host":"$host","client_ip":"$remote_addr"}}},"additionalProperties":false},"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"auth_header":{"type":"string","default":""},"batch_max_size":{"type":"integer","minimum":1,"default":1000},"buffer_duration":{"type":"integer","minimum":1,"default":60},"include_req_body":{"type":"boolean","default":false},"concat_method":{"type":"string","enum":["json","new_line"],"default":"json"},"name":{"type":"string","default":"http logger"},"max_retry_count":{"type":"integer","minimum":0,"default":0},"inactive_timeout":{"type":"integer","minimum":1,"default":5},"timeout":{"type":"integer","minimum":1,"default":3},"retry_delay":{"type":"integer","minimum":0,"default":1},"uri":{"type":"string","pattern":"^[^\\\/]+:\\\/\\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?"}},"required":["uri"]},"priority":410,"version":0.1},"basic-auth":{"version":0.1,"priority":2520,"type":"auth","schema":{"properties":{"disable":{"type":"boolean"}},"additionalProperties":false,"type":"object","$comment":"this is a mark for our injected plugin schema","title":"work with route or service object"},"consumer_schema":{"required":["username","password"],"properties":{"password":{"type":"string"},"username":{"type":"string"}},"additionalProperties":false,"type":"object","title":"work with consumer object"}},"limit-req":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"rejected_code":{"type":"integer","default":503,"minimum":200,"maximum":599},"rate":{"type":"number","exclusiveMinimum":0},"burst":{"type":"number","minimum":0},"disable":{"type":"boolean"},"key":{"type":"string","enum":["remote_addr","server_addr","http_x_real_ip","http_x_forwarded_for","consumer_name"]}},"required":["rate","burst","key"]},"priority":1001,"version":0.1},"request-validation":{"type":"validation","version":0.1,"priority":2800,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"}},"anyOf":[{"title":"Body schema","properties":{"body_schema":{"type":"object"}},"required":["body_schema"]},{"title":"Header schema","properties":{"header_schema":{"type":"object"}},"required":["header_schema"]}]}},"limit-count":{"schema":{"required":["count","time_window"],"properties":{"key":{"type":"string","default":"remote_addr","enum":["remote_addr","server_addr","http_x_real_ip","http_x_forwarded_for","consumer_name","service_id"]},"policy":{"type":"string","default":"local","enum":["local","redis","redis-cluster"]},"disable":{"type":"boolean"},"time_window":{"type":"integer","exclusiveMinimum":0},"count":{"type":"integer","exclusiveMinimum":0},"rejected_code":{"type":"integer","default":503,"minimum":200,"maximum":599}},"type":"object","$comment":"this is a mark for our injected plugin schema","dependencies":{"policy":{"oneOf":[{"properties":{"policy":{"enum":["local"]}}},{"properties":{"redis_timeout":{"type":"integer","minimum":1,"default":1000},"policy":{"enum":["redis"]},"redis_host":{"type":"string","minLength":2},"redis_port":{"type":"integer","minimum":1,"default":6379},"redis_password":{"type":"string","minLength":0},"redis_database":{"type":"integer","minimum":0,"default":0}},"required":["redis_host"]},{"properties":{"redis_timeout":{"type":"integer","minimum":1,"default":1000},"redis_cluster_nodes":{"type":"array","minItems":2,"items":{"type":"string","maxLength":100,"minLength":2}},"redis_password":{"type":"string","minLength":0},"policy":{"enum":["redis-cluster"]}},"required":["redis_cluster_nodes"]}]}}},"priority":1002,"version":0.4},"proxy-rewrite":{"schema":{"properties":{"scheme":{"description":"new scheme for upstream","type":"string","enum":["http","https"]},"regex_uri":{"description":"new uri that substitute from client uri for upstream, lower priority than uri property","minItems":2,"maxItems":2,"type":"array","items":{"description":"regex uri","type":"string"}},"uri":{"description":"new uri for upstream","minLength":1,"maxLength":4096,"type":"string","pattern":"^\\\/.*"},"disable":{"type":"boolean"},"host":{"description":"new host for upstream","type":"string","pattern":"^[0-9a-zA-Z-.]+(:\\d{1,5})?$"},"headers":{"description":"new headers for request","minProperties":1,"type":"object"}},"additionalProperties":false,"type":"object","minProperties":1,"$comment":"this is a mark for our injected plugin schema"},"priority":1008,"version":0.1},"sls-logger":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"logstore":{"type":"string"},"access_key_id":{"type":"string"},"port":{"type":"integer"},"disable":{"type":"boolean"},"batch_max_size":{"type":"integer","minimum":1,"default":1000},"buffer_duration":{"type":"integer","minimum":1,"default":60},"include_req_body":{"type":"boolean","default":false},"access_key_secret":{"type":"string"},"name":{"type":"string","default":"sls-logger"},"retry_delay":{"type":"integer","minimum":0,"default":1},"max_retry_count":{"type":"integer","minimum":0,"default":0},"inactive_timeout":{"type":"integer","minimum":1,"default":5},"host":{"type":"string"},"timeout":{"type":"integer","minimum":1,"default":5000},"project":{"type":"string"}},"required":["host","port","project","logstore","access_key_id","access_key_secret"]},"priority":406,"version":0.1},"wolf-rbac":{"type":"auth","version":0.1,"priority":2555,"schema":{"type":"object","properties":{"header_prefix":{"type":"string","default":"X-"},"appid":{"type":"string","default":"unset"},"disable":{"type":"boolean"},"server":{"type":"string","default":"http:\/\/127.0.0.1:10080"}},"$comment":"this is a mark for our injected plugin schema"}},"limit-conn":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"conn":{"type":"integer","exclusiveMinimum":0},"disable":{"type":"boolean"},"burst":{"type":"integer","minimum":0},"default_conn_delay":{"type":"number","exclusiveMinimum":0},"rejected_code":{"type":"integer","default":503,"minimum":200,"maximum":599},"key":{"type":"string","enum":["remote_addr","server_addr","http_x_real_ip","http_x_forwarded_for","consumer_name"]}},"required":["conn","burst","default_conn_delay","key"]},"priority":1003,"version":0.1},"hmac-auth":{"version":0.1,"priority":2530,"type":"auth","schema":{"properties":{"disable":{"type":"boolean"}},"additionalProperties":false,"type":"object","$comment":"this is a mark for our injected plugin schema","title":"work with route or service object"},"consumer_schema":{"required":["access_key","secret_key"],"properties":{"algorithm":{"type":"string","default":"hmac-sha256","enum":["hmac-sha1","hmac-sha256","hmac-sha512"]},"encode_uri_params":{"type":"boolean","title":"Whether to escape the uri parameter","default":true},"access_key":{"type":"string","maxLength":256,"minLength":1},"secret_key":{"type":"string","maxLength":256,"minLength":1},"clock_skew":{"type":"integer","default":0},"signed_headers":{"type":"array","items":{"type":"string","maxLength":50,"minLength":1}},"keep_headers":{"type":"boolean","title":"whether to keep the http request header","default":false}},"additionalProperties":false,"type":"object","title":"work with consumer object"}},"echo":{"schema":{"properties":{"headers":{"description":"new headers for response","minProperties":1,"type":"object"},"after_body":{"description":"body after the modification of filter phase.","type":"string"},"auth_value":{"description":"auth value","type":"string"},"disable":{"type":"boolean"},"body":{"description":"body to replace upstream response.","type":"string"},"before_body":{"description":"body before the filter phase.","type":"string"}},"additionalProperties":false,"type":"object","minProperties":1,"$comment":"this is a mark for our injected plugin schema","anyOf":[{"required":["before_body"]},{"required":["body"]},{"required":["after_body"]}]},"priority":412,"version":0.1},"consumer-restriction":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"rejected_code":{"type":"integer","minimum":200,"default":403},"allowed_by_methods":{"type":"array","items":{"type":"object","properties":{"user":{"type":"string"},"methods":{"type":"array","minItems":1,"items":{"type":"string","enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE"]}}}}},"type":{"type":"string","default":"consumer_name","enum":["consumer_name","service_id"]},"disable":{"type":"boolean"},"whitelist":{"type":"array","minItems":1,"items":{"type":"string"}},"blacklist":{"type":"array","minItems":1,"items":{"type":"string"}}},"anyOf":[{"required":["blacklist"]},{"required":["whitelist"]},{"required":["allowed_by_methods"]}]},"priority":2400,"version":0.1},"serverless-post-function":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"functions":{"type":"array","minItems":1,"items":{"type":"string"}},"disable":{"type":"boolean"},"phase":{"type":"string","enum":["rewrite","access","header_filter","body_filter","log","balancer"],"default":"access"}},"required":["functions"]},"priority":-2000,"version":0.1},"tcp-logger":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"port":{"type":"integer","minimum":0},"batch_max_size":{"type":"integer","minimum":1,"default":1000},"host":{"type":"string"},"include_req_body":{"type":"boolean","default":false},"inactive_timeout":{"type":"integer","minimum":1,"default":5},"buffer_duration":{"type":"integer","minimum":1,"default":60},"retry_delay":{"type":"integer","minimum":0,"default":1},"max_retry_count":{"type":"integer","minimum":0,"default":0},"timeout":{"type":"integer","minimum":1,"default":1000},"tls":{"type":"boolean","default":false},"name":{"type":"string","default":"tcp logger"},"tls_options":{"type":"string"}},"required":["host","port"]},"priority":405,"version":0.1},"traffic-split":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"rules":{"type":"array","items":{"type":"object","properties":{"match":{"type":"array","items":{"type":"object","properties":{"vars":{"type":"array"}}},"default":[{"vars":[["server_port",">",0]]}]},"weighted_upstreams":{"items":{"type":"object","properties":{"upstream_id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64,"minLength":1},{"type":"integer","minimum":1}]},"weight":{"description":"used to split traffic between differentupstreams for plugin configuration","type":"integer","minimum":0,"default":1},"upstream":{"properties":{"scheme":{"enum":["grpc","grpcs","http","https"],"default":"http"},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"name":{"type":"string","maxLength":100,"minLength":1},"desc":{"type":"string","maxLength":256},"id":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z0-9-_.]+$","maxLength":64,"minLength":1},{"type":"integer","minimum":1}]},"update_time":{"type":"integer"},"checks":{"type":"object","anyOf":[{"required":["active"]},{"required":["active","passive"]}],"properties":{"passive":{"type":"object","properties":{"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"healthy":{"type":"object","properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"type":"array","uniqueItems":true},"successes":{"type":"integer","default":5,"minimum":1,"maximum":254}}},"unhealthy":{"type":"object","properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"default":[429,500,503],"type":"array","uniqueItems":true},"timeouts":{"type":"integer","default":7,"minimum":1,"maximum":254},"tcp_failures":{"type":"integer","default":2,"minimum":1,"maximum":254},"http_failures":{"type":"integer","default":5,"minimum":1,"maximum":254}}}}},"active":{"type":"object","properties":{"port":{"type":"integer","minimum":1,"maximum":65535},"concurrency":{"type":"integer","default":10},"http_path":{"type":"string","default":"\/"},"healthy":{"type":"object","properties":{"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"default":[200,302],"type":"array","uniqueItems":true},"successes":{"type":"integer","default":2,"minimum":1,"maximum":254},"interval":{"type":"integer","minimum":1,"default":1}}},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"unhealthy":{"type":"object","properties":{"tcp_failures":{"type":"integer","default":2,"minimum":1,"maximum":254},"timeouts":{"type":"integer","default":3,"minimum":1,"maximum":254},"interval":{"type":"integer","minimum":1,"default":1},"http_statuses":{"items":{"type":"integer","minimum":200,"maximum":599},"minItems":1,"default":[429,404,500,501,502,503,504,505],"type":"array","uniqueItems":true},"http_failures":{"type":"integer","default":5,"minimum":1,"maximum":254}}},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"req_headers":{"type":"array","minItems":1,"items":{"type":"string","uniqueItems":true}},"timeout":{"type":"number","default":1},"https_verify_certificate":{"type":"boolean","default":true}}}},"additionalProperties":false},"create_time":{"type":"integer"},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"description":"weight of node","minimum":0,"type":"integer"}}},{"type":"array","items":{"type":"object","properties":{"weight":{"description":"weight of node","minimum":0,"type":"integer"},"priority":{"description":"priority of node","type":"integer","default":0},"port":{"description":"port of node","minimum":1,"type":"integer"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"metadata":{"description":"metadata of node","type":"object"}},"required":["host","port","weight"]}}]},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"service_name":{"type":"string","maxLength":256,"minLength":1},"hash_on":{"type":"string","enum":["vars","header","cookie","consumer","vars_combinations"],"default":"vars"},"type":{"description":"algorithms of load balancing","type":"string","enum":["chash","roundrobin","ewma","least_conn"]},"timeout":{"type":"object","properties":{"read":{"type":"number","exclusiveMinimum":0},"send":{"type":"number","exclusiveMinimum":0},"connect":{"type":"number","exclusiveMinimum":0}},"required":["connect","send","read"]},"retries":{"type":"integer","minimum":0},"pass_host":{"description":"mod of host passing","default":"pass","type":"string","enum":["pass","node","rewrite"]},"labels":{"description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","minLength":1,"maxLength":64,"type":"string","pattern":"^\\S+$"}},"maxProperties":16,"type":"object"},"discovery_type":{"description":"discovery type","type":"string"}},"additionalProperties":false,"type":"object","oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}]}}},"minItems":1,"default":[{"weight":1}],"type":"array","maxItems":20}},"additionalProperties":false}}},"additionalProperties":false},"priority":966,"version":0.1}}}
