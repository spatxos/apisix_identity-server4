{"main":{"consumer":{"type":"object","additionalProperties":false,"required":["username"],"properties":{"desc":{"type":"string","maxLength":256},"create_time":{"type":"integer"},"username":{"type":"string","minLength":1,"maxLength":32,"pattern":"^[a-zA-Z0-9_]+$"},"plugins":{"type":"object"},"labels":{"type":"object","description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","maxLength":64,"type":"string","pattern":"^\\S+$","minLength":1}},"maxProperties":16},"update_time":{"type":"integer"}}},"global_rule":{"properties":{"update_time":{"type":"integer"},"plugins":{"type":"object"},"id":{"anyOf":[{"type":"string","minLength":1,"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"create_time":{"type":"integer"}},"additionalProperties":false,"type":"object","required":["plugins"]},"stream_route":{"type":"object","properties":{"update_time":{"type":"integer"},"id":{"anyOf":[{"type":"string","minLength":1,"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"server_addr":{"type":"string","description":"server IP","anyOf":[{"type":"string","title":"IPv4","format":"ipv4"},{"type":"string","title":"IPv4\/CIDR","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"type":"string","title":"IPv6","format":"ipv6"},{"type":"string","title":"IPv6\/CIDR","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}]},"remote_addr":{"type":"string","description":"client IP","anyOf":[{"type":"string","title":"IPv4","format":"ipv4"},{"type":"string","title":"IPv4\/CIDR","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"type":"string","title":"IPv6","format":"ipv6"},{"type":"string","title":"IPv6\/CIDR","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}]},"upstream":{"properties":{"type":{"type":"string","description":"algorithms of load balancing","enum":["chash","roundrobin","ewma","least_conn"]},"id":{"anyOf":[{"type":"string","minLength":1,"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"name":{"type":"string","minLength":1,"maxLength":100},"key":{"type":"string","description":"the key of chash for dynamic load balancing"},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"read":{"type":"number","exclusiveMinimum":0},"send":{"type":"number","exclusiveMinimum":0},"connect":{"type":"number","exclusiveMinimum":0}}},"pass_host":{"type":"string","description":"mod of host passing","default":"pass","enum":["pass","node","rewrite"]},"hash_on":{"type":"string","default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"]},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"update_time":{"type":"integer"},"scheme":{"default":"http","enum":["grpc","grpcs","http","https"]},"labels":{"type":"object","description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","maxLength":64,"type":"string","pattern":"^\\S+$","minLength":1}},"maxProperties":16},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"type":"integer","description":"weight of node","minimum":0}}},{"type":"array","items":{"type":"object","required":["host","port","weight"],"properties":{"metadata":{"type":"object","description":"metadata of node"},"weight":{"type":"integer","description":"weight of node","minimum":0},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"port":{"type":"integer","description":"port of node","minimum":1},"priority":{"type":"integer","description":"priority of node","default":0}}}}]},"checks":{"type":"object","additionalProperties":false,"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"properties":{"passive":{"type":"object","properties":{"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"healthy":{"type":"object","properties":{"successes":{"type":"integer","maximum":254,"default":5,"minimum":1},"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"items":{"type":"integer","maximum":599,"minimum":200}}}},"unhealthy":{"type":"object","properties":{"http_failures":{"type":"integer","maximum":254,"default":5,"minimum":1},"tcp_failures":{"type":"integer","maximum":254,"default":2,"minimum":1},"timeouts":{"type":"integer","maximum":254,"default":7,"minimum":1},"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[429,500,503],"items":{"type":"integer","maximum":599,"minimum":200}}}}}},"active":{"type":"object","properties":{"healthy":{"type":"object","properties":{"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[200,302],"items":{"type":"integer","maximum":599,"minimum":200}},"successes":{"type":"integer","maximum":254,"default":2,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1}}},"req_headers":{"type":"array","items":{"type":"string","uniqueItems":true},"minItems":1},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"unhealthy":{"type":"object","properties":{"http_failures":{"type":"integer","maximum":254,"default":5,"minimum":1},"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[429,404,500,501,502,503,504,505],"items":{"type":"integer","maximum":599,"minimum":200}},"timeouts":{"type":"integer","maximum":254,"default":3,"minimum":1},"tcp_failures":{"type":"integer","maximum":254,"default":2,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1}}},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"concurrency":{"type":"integer","default":10},"port":{"type":"integer","maximum":65535,"minimum":1},"http_path":{"type":"string","default":"\/"},"https_verify_certificate":{"type":"boolean","default":true},"timeout":{"type":"number","default":1}}}}},"desc":{"type":"string","maxLength":256},"create_time":{"type":"integer"},"retries":{"type":"integer","minimum":0},"service_name":{"type":"string","minLength":1,"maxLength":256},"discovery_type":{"type":"string","description":"discovery type"}},"additionalProperties":false,"type":"object","oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}]},"create_time":{"type":"integer"},"upstream_id":{"anyOf":[{"type":"string","minLength":1,"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"plugins":{"type":"object"},"desc":{"type":"string","maxLength":256},"server_port":{"type":"integer","description":"server port"}}},"upstream":{"properties":{"type":{"type":"string","description":"algorithms of load balancing","enum":["chash","roundrobin","ewma","least_conn"]},"id":{"anyOf":[{"type":"string","minLength":1,"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"name":{"type":"string","minLength":1,"maxLength":100},"key":{"type":"string","description":"the key of chash for dynamic load balancing"},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"read":{"type":"number","exclusiveMinimum":0},"send":{"type":"number","exclusiveMinimum":0},"connect":{"type":"number","exclusiveMinimum":0}}},"pass_host":{"type":"string","description":"mod of host passing","default":"pass","enum":["pass","node","rewrite"]},"hash_on":{"type":"string","default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"]},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"update_time":{"type":"integer"},"scheme":{"default":"http","enum":["grpc","grpcs","http","https"]},"labels":{"type":"object","description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","maxLength":64,"type":"string","pattern":"^\\S+$","minLength":1}},"maxProperties":16},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"type":"integer","description":"weight of node","minimum":0}}},{"type":"array","items":{"type":"object","required":["host","port","weight"],"properties":{"metadata":{"type":"object","description":"metadata of node"},"weight":{"type":"integer","description":"weight of node","minimum":0},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"port":{"type":"integer","description":"port of node","minimum":1},"priority":{"type":"integer","description":"priority of node","default":0}}}}]},"checks":{"type":"object","additionalProperties":false,"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"properties":{"passive":{"type":"object","properties":{"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"healthy":{"type":"object","properties":{"successes":{"type":"integer","maximum":254,"default":5,"minimum":1},"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"items":{"type":"integer","maximum":599,"minimum":200}}}},"unhealthy":{"type":"object","properties":{"http_failures":{"type":"integer","maximum":254,"default":5,"minimum":1},"tcp_failures":{"type":"integer","maximum":254,"default":2,"minimum":1},"timeouts":{"type":"integer","maximum":254,"default":7,"minimum":1},"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[429,500,503],"items":{"type":"integer","maximum":599,"minimum":200}}}}}},"active":{"type":"object","properties":{"healthy":{"type":"object","properties":{"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[200,302],"items":{"type":"integer","maximum":599,"minimum":200}},"successes":{"type":"integer","maximum":254,"default":2,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1}}},"req_headers":{"type":"array","items":{"type":"string","uniqueItems":true},"minItems":1},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"unhealthy":{"type":"object","properties":{"http_failures":{"type":"integer","maximum":254,"default":5,"minimum":1},"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[429,404,500,501,502,503,504,505],"items":{"type":"integer","maximum":599,"minimum":200}},"timeouts":{"type":"integer","maximum":254,"default":3,"minimum":1},"tcp_failures":{"type":"integer","maximum":254,"default":2,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1}}},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"concurrency":{"type":"integer","default":10},"port":{"type":"integer","maximum":65535,"minimum":1},"http_path":{"type":"string","default":"\/"},"https_verify_certificate":{"type":"boolean","default":true},"timeout":{"type":"number","default":1}}}}},"desc":{"type":"string","maxLength":256},"create_time":{"type":"integer"},"retries":{"type":"integer","minimum":0},"service_name":{"type":"string","minLength":1,"maxLength":256},"discovery_type":{"type":"string","description":"discovery type"}},"additionalProperties":false,"type":"object","oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}]},"upstream_hash_header_schema":{"type":"string","pattern":"^[a-zA-Z0-9-_]+$"},"route":{"properties":{"status":{"type":"integer","description":"route status, 1 to enable, 0 to disable","default":1,"enum":[1,0]},"uris":{"type":"array","minItems":1,"uniqueItems":true,"items":{"type":"string","description":"HTTP uri"}},"methods":{"type":"array","uniqueItems":true,"items":{"type":"string","description":"HTTP method","enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE"]}},"id":{"anyOf":[{"type":"string","minLength":1,"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"hosts":{"type":"array","minItems":1,"uniqueItems":true,"items":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"}},"remote_addrs":{"type":"array","minItems":1,"uniqueItems":true,"items":{"type":"string","description":"client IP","anyOf":[{"type":"string","title":"IPv4","format":"ipv4"},{"type":"string","title":"IPv4\/CIDR","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"type":"string","title":"IPv6","format":"ipv6"},{"type":"string","title":"IPv6\/CIDR","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}]}},"filter_func":{"type":"string","minLength":10,"pattern":"^function"},"script_id":{"anyOf":[{"type":"string","minLength":1,"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"enable_websocket":{"type":"boolean","description":"enable websocket for request"},"plugin_config_id":{"anyOf":[{"type":"string","minLength":1,"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"service_protocol":{"enum":["grpc","http"]},"service_id":{"anyOf":[{"type":"string","minLength":1,"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"vars":{"type":"array"},"upstream_id":{"anyOf":[{"type":"string","minLength":1,"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"update_time":{"type":"integer"},"upstream":{"properties":{"type":{"type":"string","description":"algorithms of load balancing","enum":["chash","roundrobin","ewma","least_conn"]},"id":{"anyOf":[{"type":"string","minLength":1,"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"name":{"type":"string","minLength":1,"maxLength":100},"key":{"type":"string","description":"the key of chash for dynamic load balancing"},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"read":{"type":"number","exclusiveMinimum":0},"send":{"type":"number","exclusiveMinimum":0},"connect":{"type":"number","exclusiveMinimum":0}}},"pass_host":{"type":"string","description":"mod of host passing","default":"pass","enum":["pass","node","rewrite"]},"hash_on":{"type":"string","default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"]},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"update_time":{"type":"integer"},"scheme":{"default":"http","enum":["grpc","grpcs","http","https"]},"labels":{"type":"object","description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","maxLength":64,"type":"string","pattern":"^\\S+$","minLength":1}},"maxProperties":16},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"type":"integer","description":"weight of node","minimum":0}}},{"type":"array","items":{"type":"object","required":["host","port","weight"],"properties":{"metadata":{"type":"object","description":"metadata of node"},"weight":{"type":"integer","description":"weight of node","minimum":0},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"port":{"type":"integer","description":"port of node","minimum":1},"priority":{"type":"integer","description":"priority of node","default":0}}}}]},"checks":{"type":"object","additionalProperties":false,"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"properties":{"passive":{"type":"object","properties":{"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"healthy":{"type":"object","properties":{"successes":{"type":"integer","maximum":254,"default":5,"minimum":1},"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"items":{"type":"integer","maximum":599,"minimum":200}}}},"unhealthy":{"type":"object","properties":{"http_failures":{"type":"integer","maximum":254,"default":5,"minimum":1},"tcp_failures":{"type":"integer","maximum":254,"default":2,"minimum":1},"timeouts":{"type":"integer","maximum":254,"default":7,"minimum":1},"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[429,500,503],"items":{"type":"integer","maximum":599,"minimum":200}}}}}},"active":{"type":"object","properties":{"healthy":{"type":"object","properties":{"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[200,302],"items":{"type":"integer","maximum":599,"minimum":200}},"successes":{"type":"integer","maximum":254,"default":2,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1}}},"req_headers":{"type":"array","items":{"type":"string","uniqueItems":true},"minItems":1},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"unhealthy":{"type":"object","properties":{"http_failures":{"type":"integer","maximum":254,"default":5,"minimum":1},"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[429,404,500,501,502,503,504,505],"items":{"type":"integer","maximum":599,"minimum":200}},"timeouts":{"type":"integer","maximum":254,"default":3,"minimum":1},"tcp_failures":{"type":"integer","maximum":254,"default":2,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1}}},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"concurrency":{"type":"integer","default":10},"port":{"type":"integer","maximum":65535,"minimum":1},"http_path":{"type":"string","default":"\/"},"https_verify_certificate":{"type":"boolean","default":true},"timeout":{"type":"number","default":1}}}}},"desc":{"type":"string","maxLength":256},"create_time":{"type":"integer"},"retries":{"type":"integer","minimum":0},"service_name":{"type":"string","minLength":1,"maxLength":256},"discovery_type":{"type":"string","description":"discovery type"}},"additionalProperties":false,"type":"object","oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}]},"labels":{"type":"object","description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","maxLength":64,"type":"string","pattern":"^\\S+$","minLength":1}},"maxProperties":16},"uri":{"type":"string","minLength":1,"maxLength":4096},"remote_addr":{"type":"string","description":"client IP","anyOf":[{"type":"string","title":"IPv4","format":"ipv4"},{"type":"string","title":"IPv4\/CIDR","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"type":"string","title":"IPv6","format":"ipv6"},{"type":"string","title":"IPv6\/CIDR","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}]},"script":{"type":"string","minLength":10,"maxLength":102400},"desc":{"type":"string","maxLength":256},"create_time":{"type":"integer"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"plugins":{"type":"object"},"priority":{"type":"integer","default":0},"name":{"type":"string","minLength":1,"maxLength":100}},"additionalProperties":false,"allOf":[{"oneOf":[{"required":["uri"]},{"required":["uris"]}]},{"oneOf":[{"not":{"anyOf":[{"required":["host"]},{"required":["hosts"]}]}},{"required":["host"]},{"required":["hosts"]}]},{"oneOf":[{"not":{"anyOf":[{"required":["remote_addr"]},{"required":["remote_addrs"]}]}},{"required":["remote_addr"]},{"required":["remote_addrs"]}]}],"type":"object","anyOf":[{"required":["plugins","uri"]},{"required":["upstream","uri"]},{"required":["upstream_id","uri"]},{"required":["service_id","uri"]},{"required":["plugins","uris"]},{"required":["upstream","uris"]},{"required":["upstream_id","uris"]},{"required":["service_id","uris"]},{"required":["script","uri"]},{"required":["script","uris"]}],"not":{"anyOf":[{"required":["script","plugins"]},{"required":["script","plugin_config_id"]}]}},"plugin_config":{"type":"object","additionalProperties":false,"required":["id","plugins"],"properties":{"desc":{"type":"string","maxLength":256},"create_time":{"type":"integer"},"update_time":{"type":"integer"},"id":{"anyOf":[{"type":"string","minLength":1,"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"labels":{"type":"object","description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","maxLength":64,"type":"string","pattern":"^\\S+$","minLength":1}},"maxProperties":16},"plugins":{"type":"object"}}},"upstream_hash_vars_schema":{"type":"string","pattern":"^((uri|server_name|server_addr|request_uri|remote_port|remote_addr|query_string|host|hostname)|arg_[0-9a-zA-z_-]+)$"},"proto":{"type":"object","additionalProperties":false,"required":["content"],"properties":{"content":{"type":"string","minLength":1,"maxLength":1048576},"desc":{"type":"string","maxLength":256},"create_time":{"type":"integer"},"update_time":{"type":"integer"},"id":{"anyOf":[{"type":"string","minLength":1,"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]}}},"service":{"type":"object","additionalProperties":false,"properties":{"update_time":{"type":"integer"},"id":{"anyOf":[{"type":"string","minLength":1,"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"labels":{"type":"object","description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","maxLength":64,"type":"string","pattern":"^\\S+$","minLength":1}},"maxProperties":16},"upstream_id":{"anyOf":[{"type":"string","minLength":1,"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"name":{"type":"string","minLength":1,"maxLength":100},"script":{"type":"string","minLength":10,"maxLength":102400},"upstream":{"properties":{"type":{"type":"string","description":"algorithms of load balancing","enum":["chash","roundrobin","ewma","least_conn"]},"id":{"anyOf":[{"type":"string","minLength":1,"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"name":{"type":"string","minLength":1,"maxLength":100},"key":{"type":"string","description":"the key of chash for dynamic load balancing"},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"read":{"type":"number","exclusiveMinimum":0},"send":{"type":"number","exclusiveMinimum":0},"connect":{"type":"number","exclusiveMinimum":0}}},"pass_host":{"type":"string","description":"mod of host passing","default":"pass","enum":["pass","node","rewrite"]},"hash_on":{"type":"string","default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"]},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"update_time":{"type":"integer"},"scheme":{"default":"http","enum":["grpc","grpcs","http","https"]},"labels":{"type":"object","description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","maxLength":64,"type":"string","pattern":"^\\S+$","minLength":1}},"maxProperties":16},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"type":"integer","description":"weight of node","minimum":0}}},{"type":"array","items":{"type":"object","required":["host","port","weight"],"properties":{"metadata":{"type":"object","description":"metadata of node"},"weight":{"type":"integer","description":"weight of node","minimum":0},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"port":{"type":"integer","description":"port of node","minimum":1},"priority":{"type":"integer","description":"priority of node","default":0}}}}]},"checks":{"type":"object","additionalProperties":false,"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"properties":{"passive":{"type":"object","properties":{"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"healthy":{"type":"object","properties":{"successes":{"type":"integer","maximum":254,"default":5,"minimum":1},"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"items":{"type":"integer","maximum":599,"minimum":200}}}},"unhealthy":{"type":"object","properties":{"http_failures":{"type":"integer","maximum":254,"default":5,"minimum":1},"tcp_failures":{"type":"integer","maximum":254,"default":2,"minimum":1},"timeouts":{"type":"integer","maximum":254,"default":7,"minimum":1},"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[429,500,503],"items":{"type":"integer","maximum":599,"minimum":200}}}}}},"active":{"type":"object","properties":{"healthy":{"type":"object","properties":{"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[200,302],"items":{"type":"integer","maximum":599,"minimum":200}},"successes":{"type":"integer","maximum":254,"default":2,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1}}},"req_headers":{"type":"array","items":{"type":"string","uniqueItems":true},"minItems":1},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"unhealthy":{"type":"object","properties":{"http_failures":{"type":"integer","maximum":254,"default":5,"minimum":1},"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[429,404,500,501,502,503,504,505],"items":{"type":"integer","maximum":599,"minimum":200}},"timeouts":{"type":"integer","maximum":254,"default":3,"minimum":1},"tcp_failures":{"type":"integer","maximum":254,"default":2,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1}}},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"concurrency":{"type":"integer","default":10},"port":{"type":"integer","maximum":65535,"minimum":1},"http_path":{"type":"string","default":"\/"},"https_verify_certificate":{"type":"boolean","default":true},"timeout":{"type":"number","default":1}}}}},"desc":{"type":"string","maxLength":256},"create_time":{"type":"integer"},"retries":{"type":"integer","minimum":0},"service_name":{"type":"string","minLength":1,"maxLength":256},"discovery_type":{"type":"string","description":"discovery type"}},"additionalProperties":false,"type":"object","oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}]},"create_time":{"type":"integer"},"plugins":{"type":"object"},"enable_websocket":{"type":"boolean","description":"enable websocket for request"},"desc":{"type":"string","maxLength":256}}},"plugins":{"type":"array","items":{"type":"object","required":["name"],"properties":{"name":{"type":"string","minLength":1},"stream":{"type":"boolean"},"additionalProperties":false}}},"ssl":{"type":"object","additionalProperties":false,"oneOf":[{"required":["sni","key","cert"]},{"required":["snis","key","cert"]}],"properties":{"snis":{"type":"array","minItems":1,"items":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-.]+$"}},"certs":{"type":"array","items":{"type":"string","minLength":128,"maxLength":65536}},"validity_end":{"type":"integer"},"cert":{"type":"string","minLength":128,"maxLength":65536},"id":{"anyOf":[{"type":"string","minLength":1,"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"labels":{"type":"object","description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","maxLength":64,"type":"string","pattern":"^\\S+$","minLength":1}},"maxProperties":16},"keys":{"type":"array","items":{"type":"string","minLength":128,"maxLength":65536}},"update_time":{"type":"integer"},"key":{"type":"string","minLength":128,"maxLength":65536},"exptime":{"type":"integer","minimum":1588262400},"create_time":{"type":"integer"},"sni":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-.]+$"},"validity_start":{"type":"integer"},"status":{"type":"integer","description":"ssl status, 1 to enable, 0 to disable","default":1,"enum":[1,0]}}}},"plugins":{"proxy-cache":{"version":0.1,"priority":1009,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"cache_method":{"minItems":1,"uniqueItems":true,"type":"array","default":["GET","HEAD"],"items":{"type":"string","description":"http method","enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE"]}},"cache_zone":{"type":"string","minLength":1,"maxLength":100,"default":"disk_cache_one"},"cache_key":{"type":"array","items":{"type":"string","description":"a key for caching","pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)"},"default":["$host","$request_uri"],"minItems":1},"cache_bypass":{"type":"array","items":{"type":"string","pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)"},"minItems":1},"no_cache":{"type":"array","items":{"type":"string","pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)"},"minItems":1},"disable":{"type":"boolean"},"cache_http_status":{"minItems":1,"uniqueItems":true,"type":"array","default":[200,301,404],"items":{"type":"integer","description":"http response status","maximum":599,"minimum":200}},"hide_cache_headers":{"type":"boolean","default":false}}}},"consumer-restriction":{"version":0.1,"priority":2400,"schema":{"type":"object","anyOf":[{"required":["blacklist"]},{"required":["whitelist"]},{"required":["allowed_by_methods"]}],"$comment":"this is a mark for our injected plugin schema","properties":{"whitelist":{"type":"array","items":{"type":"string"},"minItems":1},"allowed_by_methods":{"type":"array","items":{"type":"object","properties":{"methods":{"type":"array","items":{"type":"string","enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE"]},"minItems":1},"user":{"type":"string"}}}},"type":{"type":"string","default":"consumer_name","enum":["consumer_name","service_id"]},"rejected_code":{"type":"integer","default":403,"minimum":200},"disable":{"type":"boolean"},"blacklist":{"type":"array","items":{"type":"string"},"minItems":1}}}},"grpc-transcode":{"version":0.1,"priority":506,"schema":{"properties":{"deadline":{"type":"number","description":"deadline for grpc, millisecond","default":0},"proto_id":{"anyOf":[{"type":"string","minLength":1,"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"pb_option":{"type":"array","minItems":1,"items":{"type":"string","anyOf":[{"type":"string","description":"enum as result","enum":["int64_as_number","int64_as_string","int64_as_hexstring"]},{"type":"string","description":"int64 as result","enum":["enum_as_name","enum_as_value"]},{"type":"string","description":"default values option","enum":["auto_default_values","no_default_values","use_default_values","use_default_metatable"]},{"type":"string","description":"hooks option","enum":["enable_hooks","disable_hooks"]}]}},"service":{"type":"string","description":"the grpc service name"},"method":{"type":"string","description":"the method name in the grpc service."},"disable":{"type":"boolean"}},"additionalProperties":true,"type":"object","required":["proto_id","service","method"],"$comment":"this is a mark for our injected plugin schema"}},"jwt-auth":{"version":0.1,"priority":2510,"schema":{"type":"object","additionalProperties":false,"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"}}},"type":"auth","consumer_schema":{"type":"object","dependencies":{"algorithm":{"oneOf":[{"properties":{"algorithm":{"default":"HS256","enum":["HS256","HS512"]}}},{"properties":{"private_key":{"type":"string"},"public_key":{"type":"string"},"algorithm":{"enum":["RS256"]}},"required":["public_key","private_key"]}]}},"required":["key"],"properties":{"key":{"type":"string"},"base64_secret":{"type":"boolean","default":false},"secret":{"type":"string"},"exp":{"type":"integer","default":86400,"minimum":1},"algorithm":{"type":"string","default":"HS256","enum":["HS256","HS512","RS256"]}}}},"limit-req":{"version":0.1,"priority":1001,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["rate","burst","key"],"properties":{"rate":{"type":"number","exclusiveMinimum":0},"burst":{"type":"number","minimum":0},"key":{"type":"string","enum":["remote_addr","server_addr","http_x_real_ip","http_x_forwarded_for","consumer_name"]},"rejected_code":{"type":"integer","maximum":599,"default":503,"minimum":200},"disable":{"type":"boolean"}}}},"sls-logger":{"version":0.1,"priority":406,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["host","port","project","logstore","access_key_id","access_key_secret"],"properties":{"batch_max_size":{"type":"integer","default":1000,"minimum":1},"include_req_body":{"type":"boolean","default":false},"access_key_id":{"type":"string"},"access_key_secret":{"type":"string"},"disable":{"type":"boolean"},"logstore":{"type":"string"},"project":{"type":"string"},"name":{"type":"string","default":"sls-logger"},"port":{"type":"integer"},"host":{"type":"string"},"timeout":{"type":"integer","default":5000,"minimum":1},"max_retry_count":{"type":"integer","default":0,"minimum":0},"retry_delay":{"type":"integer","default":1,"minimum":0},"buffer_duration":{"type":"integer","default":60,"minimum":1},"inactive_timeout":{"type":"integer","default":5,"minimum":1}}}},"identity-server4":{"type":"auth","version":0.1,"priority":2599,"schema":{"properties":{"identity_server_admin_api_client_client_id":{"type":"string","minItems":1},"identity_server_admin_api_client_grant_type":{"type":"string","minItems":1},"identity_server_admin_api_client_client_secret":{"type":"string","minItems":1},"introspect_type":{"type":"string","enum":["public_key","identity_server"]},"public_key":{"type":"string","minItems":1},"disable":{"type":"boolean"},"identity_server_admin_api_client_scopes":{"type":"string","minItems":1},"identity_server_admin_api_uri":{"type":"string","minItems":1},"identity_server_uri":{"type":"string","minItems":1},"apisix_api_name":{"type":"string","minItems":1},"apisix_api_secrets":{"type":"string","minItems":1}},"type":"object","dependencies":{"introspect_type":{"oneOf":[{"properties":{"introspect_type":{"type":"string","enum":["public_key"]},"public_key":{"type":"string"}},"required":["introspect_type","public_key"]},{"properties":{"introspect_type":{"type":"string","enum":["identity_server"]},"apisix_api_name":{"type":"string"},"apisix_api_secrets":{"type":"string"}},"required":["introspect_type","apisix_api_secrets","apisix_api_name"]}]}},"required":["identity_server_uri","introspect_type","identity_server_admin_api_uri","identity_server_admin_api_client_client_id","identity_server_admin_api_client_grant_type","identity_server_admin_api_client_client_secret","identity_server_admin_api_client_scopes"],"$comment":"this is a mark for our injected plugin schema"}},"request-id":{"version":0.1,"priority":11010,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"header_name":{"type":"string","default":"X-Request-Id"},"disable":{"type":"boolean"},"include_in_response":{"type":"boolean","default":true}}}},"proxy-mirror":{"version":0.1,"priority":1010,"schema":{"properties":{"host":{"type":"string","pattern":"^http(s)?:\\\/\\\/[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+(:[0-9]{1,5})?$"},"disable":{"type":"boolean"}},"minProperties":1,"type":"object","required":["host"],"$comment":"this is a mark for our injected plugin schema"}},"openid-connect":{"version":0.1,"priority":2599,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["client_id","client_secret","discovery"],"properties":{"redirect_uri":{"type":"string","description":"use ngx.var.request_uri if not configured"},"token_signing_alg_values_expected":{"type":"string"},"set_access_token_header":{"type":"boolean","description":"Whether the access token should be added as a header to the request for downstream","default":true},"public_key":{"type":"string"},"client_id":{"type":"string"},"access_token_in_authorization_header":{"type":"boolean","description":"Whether the access token should be added in the Authorization header as opposed to the X-Access-Token header.","default":false},"set_id_token_header":{"type":"boolean","description":"Whether the ID token should be added in the X-ID-Token header to the request for downstream.","default":true},"introspection_endpoint":{"type":"string"},"timeout":{"type":"integer","description":"timeout in seconds","default":3,"minimum":1},"ssl_verify":{"type":"boolean","default":false},"client_secret":{"type":"string"},"scope":{"type":"string","default":"openid"},"disable":{"type":"boolean"},"set_userinfo_header":{"type":"boolean","description":"Whether the user info token should be added in the X-Userinfo header to the request for downstream.","default":true},"introspection_endpoint_auth_method":{"type":"string","default":"client_secret_basic"},"discovery":{"type":"string"},"bearer_only":{"type":"boolean","default":false},"realm":{"type":"string","default":"apisix"},"logout_path":{"type":"string","default":"\/logout"}}}},"zipkin":{"version":0.1,"priority":11011,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["endpoint","sample_ratio"],"properties":{"service_name":{"type":"string","description":"service name for zipkin reporter","default":"APISIX"},"disable":{"type":"boolean"},"span_version":{"default":2,"enum":[1,2]},"endpoint":{"type":"string"},"sample_ratio":{"type":"number","maximum":1,"minimum":1e-05},"server_addr":{"type":"string","description":"default is $server_addr, you can specify your external ip address","pattern":"^[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}$"}}}},"syslog":{"version":0.1,"priority":401,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["host","port"],"properties":{"batch_max_size":{"type":"integer","default":1000,"minimum":1},"include_req_body":{"type":"boolean","default":false},"disable":{"type":"boolean"},"name":{"type":"string","default":"sys logger"},"sock_type":{"type":"string","default":"tcp","enum":["tcp","udp"]},"pool_size":{"type":"integer","default":5,"minimum":5},"retry_interval":{"type":"integer","default":1,"minimum":0},"flush_limit":{"type":"integer","default":4096,"minimum":1},"drop_limit":{"type":"integer","default":1048576},"host":{"type":"string"},"max_retry_times":{"type":"integer","default":1,"minimum":1},"port":{"type":"integer"},"timeout":{"type":"integer","default":3,"minimum":1},"buffer_duration":{"type":"integer","default":60,"minimum":1},"tls":{"type":"boolean","default":false}}}},"mqtt-proxy":{"version":0.1,"priority":1000,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["protocol_name","protocol_level","upstream"],"properties":{"disable":{"type":"boolean"},"protocol_name":{"type":"string"},"protocol_level":{"type":"integer"},"upstream":{"type":"object","properties":{"ip":{"type":"string"},"port":{"type":"number"}}}}}},"hmac-auth":{"version":0.1,"priority":2530,"schema":{"properties":{"disable":{"type":"boolean"}},"additionalProperties":false,"type":"object","title":"work with route or service object","$comment":"this is a mark for our injected plugin schema"},"type":"auth","consumer_schema":{"properties":{"access_key":{"type":"string","minLength":1,"maxLength":256},"secret_key":{"type":"string","minLength":1,"maxLength":256},"encode_uri_params":{"type":"boolean","title":"Whether to escape the uri parameter","default":true},"clock_skew":{"type":"integer","default":0},"signed_headers":{"type":"array","items":{"type":"string","minLength":1,"maxLength":50}},"keep_headers":{"type":"boolean","title":"whether to keep the http request header","default":false},"algorithm":{"type":"string","default":"hmac-sha256","enum":["hmac-sha1","hmac-sha256","hmac-sha512"]}},"additionalProperties":false,"type":"object","title":"work with consumer object","required":["access_key","secret_key"]}},"server-info":{"version":0.1,"priority":990,"schema":{"type":"object","additionalProperties":false,"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"}}}},"proxy-rewrite":{"version":0.1,"priority":1008,"schema":{"properties":{"host":{"type":"string","description":"new host for upstream","pattern":"^[0-9a-zA-Z-.]+(:\\d{1,5})?$"},"regex_uri":{"minItems":2,"description":"new uri that substitute from client uri for upstream, lower priority than uri property","type":"array","items":{"type":"string","description":"regex uri"},"maxItems":2},"disable":{"type":"boolean"},"scheme":{"type":"string","description":"new scheme for upstream","enum":["http","https"]},"headers":{"type":"object","description":"new headers for request","minProperties":1},"uri":{"description":"new uri for upstream","maxLength":4096,"type":"string","pattern":"^\\\/.*","minLength":1}},"additionalProperties":false,"minProperties":1,"type":"object","$comment":"this is a mark for our injected plugin schema"}},"tcp-logger":{"version":0.1,"priority":405,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["host","port"],"properties":{"batch_max_size":{"type":"integer","default":1000,"minimum":1},"include_req_body":{"type":"boolean","default":false},"tls_options":{"type":"string"},"disable":{"type":"boolean"},"inactive_timeout":{"type":"integer","default":5,"minimum":1},"name":{"type":"string","default":"tcp logger"},"timeout":{"type":"integer","default":1000,"minimum":1},"host":{"type":"string"},"port":{"type":"integer","minimum":0},"max_retry_count":{"type":"integer","default":0,"minimum":0},"retry_delay":{"type":"integer","default":1,"minimum":0},"buffer_duration":{"type":"integer","default":60,"minimum":1},"tls":{"type":"boolean","default":false}}}},"key-auth":{"version":0.1,"priority":2500,"schema":{"type":"object","additionalProperties":false,"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"}}},"type":"auth","consumer_schema":{"type":"object","additionalProperties":false,"required":["key"],"properties":{"key":{"type":"string"}}}},"authz-keycloak":{"version":0.1,"priority":2000,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","allOf":[{"anyOf":[{"required":["discovery"]},{"required":["token_endpoint"]}]},{"anyOf":[{"required":["client_id"]},{"required":["audience"]}]},{"anyOf":[{"properties":{"lazy_load_paths":{"enum":[false]}}},{"properties":{"lazy_load_paths":{"enum":[true]}},"anyOf":[{"required":["discovery"]},{"required":["resource_registration_endpoint"]}]}]}],"properties":{"cache_ttl_seconds":{"type":"integer","default":86400,"minimum":1},"client_id":{"type":"string","minLength":1,"maxLength":100},"discovery":{"type":"string","minLength":1,"maxLength":4096},"keepalive":{"type":"boolean","default":true},"disable":{"type":"boolean"},"token_endpoint":{"type":"string","minLength":1,"maxLength":4096},"resource_registration_endpoint":{"type":"string","minLength":1,"maxLength":4096},"audience":{"type":"string","minLength":1,"maxLength":100,"description":"Deprecated, use `client_id` instead."},"keepalive_pool":{"type":"integer","default":5,"minimum":1},"keepalive_timeout":{"type":"integer","default":60000,"minimum":1000},"grant_type":{"minLength":1,"default":"urn:ietf:params:oauth:grant-type:uma-ticket","type":"string","maxLength":100,"enum":["urn:ietf:params:oauth:grant-type:uma-ticket"]},"client_secret":{"type":"string","minLength":1,"maxLength":100},"policy_enforcement_mode":{"type":"string","default":"ENFORCING","enum":["ENFORCING","PERMISSIVE"]},"ssl_verify":{"type":"boolean","default":true},"timeout":{"type":"integer","default":3000,"minimum":1000},"permissions":{"type":"array","uniqueItems":true,"items":{"type":"string","minLength":1,"maxLength":100}},"lazy_load_paths":{"type":"boolean","default":false},"http_method_as_scope":{"type":"boolean","default":false}}}},"cors":{"version":0.1,"priority":4000,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"expose_headers":{"type":"string","description":"you can use '*' to expose all header when no credentials,multiple header use ',' to split. default: *.","default":"*"},"disable":{"type":"boolean"},"allow_methods":{"type":"string","description":"you can use '*' to allow all methods when no credentials and '**','**' to allow forcefully(it will bring some security risks, be carefully),multiple method use ',' to split. default: *.","default":"*"},"allow_origins_by_regex":{"minItems":1,"description":"you can use regex to allow specific origins when no credentials,for example use [.*\\.test.com] to allow a.test.com and b.test.com","uniqueItems":true,"type":"array","items":{"type":"string","minLength":1,"maxLength":4096}},"allow_credential":{"type":"boolean","description":"allow client append credential. according to CORS specification,if you set this option to 'true', you can not use '*' for other options.","default":false},"allow_headers":{"type":"string","description":"you can use '*' to allow all header when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple header use ',' to split. default: *.","default":"*"},"allow_origins":{"type":"string","description":"you can use '*' to allow all origins when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple origin use ',' to split. default: *.","default":"*"},"max_age":{"type":"integer","description":"maximum number of seconds the results can be cached.-1 mean no cached,the max value is depend on browser,more detail plz check MDN. default: 5.","default":5}}}},"http-logger":{"metadata_schema":{"type":"object","additionalProperties":false,"properties":{"log_format":{"type":"object","default":{"@timestamp":"$time_iso8601","host":"$host","client_ip":"$remote_addr"}}}},"version":0.1,"priority":410,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["uri"],"properties":{"batch_max_size":{"type":"integer","default":1000,"minimum":1},"include_req_body":{"type":"boolean","default":false},"auth_header":{"type":"string","default":""},"concat_method":{"type":"string","default":"json","enum":["json","new_line"]},"uri":{"type":"string","pattern":"^[^\\\/]+:\\\/\\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?"},"name":{"type":"string","default":"http logger"},"disable":{"type":"boolean"},"timeout":{"type":"integer","default":3,"minimum":1},"max_retry_count":{"type":"integer","default":0,"minimum":0},"retry_delay":{"type":"integer","default":1,"minimum":0},"buffer_duration":{"type":"integer","default":60,"minimum":1},"inactive_timeout":{"type":"integer","default":5,"minimum":1}}}},"batch-requests":{"metadata_schema":{"type":"object","additionalProperties":false,"properties":{"max_body_size":{"type":"integer","description":"max pipeline body size in bytes","default":1048576,"exclusiveMinimum":0}}},"version":0.1,"priority":4010,"schema":{"type":"object","additionalProperties":false,"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"}}}},"echo":{"version":0.1,"priority":412,"schema":{"properties":{"auth_value":{"type":"string","description":"auth value"},"before_body":{"type":"string","description":"body before the filter phase."},"body":{"type":"string","description":"body to replace upstream response."},"after_body":{"type":"string","description":"body after the modification of filter phase."},"headers":{"type":"object","description":"new headers for response","minProperties":1},"disable":{"type":"boolean"}},"additionalProperties":false,"minProperties":1,"type":"object","anyOf":[{"required":["before_body"]},{"required":["body"]},{"required":["after_body"]}],"$comment":"this is a mark for our injected plugin schema"}},"udp-logger":{"version":0.1,"priority":400,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["host","port"],"properties":{"batch_max_size":{"type":"integer","default":1000,"minimum":1},"include_req_body":{"type":"boolean","default":false},"name":{"type":"string","default":"udp logger"},"host":{"type":"string"},"disable":{"type":"boolean"},"port":{"type":"integer","minimum":0},"timeout":{"type":"integer","default":3,"minimum":1},"buffer_duration":{"type":"integer","default":60,"minimum":1},"inactive_timeout":{"type":"integer","default":5,"minimum":1}}}},"fault-injection":{"version":0.1,"priority":11000,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"delay":{"type":"object","required":["duration"],"properties":{"duration":{"type":"number","minimum":0},"percentage":{"type":"integer","maximum":100,"minimum":0},"vars":{"type":"array","maxItems":20,"item":{"type":"array"}}}},"abort":{"type":"object","required":["http_status"],"properties":{"http_status":{"type":"integer","minimum":200},"vars":{"type":"array","maxItems":20,"item":{"type":"array"}},"percentage":{"type":"integer","maximum":100,"minimum":0},"body":{"type":"string","minLength":0}}},"disable":{"type":"boolean"}},"minProperties":1}},"redirect":{"version":0.1,"priority":900,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","oneOf":[{"required":["uri"]},{"required":["http_to_https"]}],"properties":{"http_to_https":{"type":"boolean"},"ret_code":{"type":"integer","default":302,"minimum":200},"disable":{"type":"boolean"},"uri":{"type":"string","minLength":2,"pattern":"(\\\\\\$[0-9a-zA-Z_]+)|\\$\\{([0-9a-zA-Z_]+)\\}|\\$([0-9a-zA-Z_]+)|(\\$|[^$\\\\]+)"}}}},"kafka-logger":{"version":0.1,"priority":403,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["broker_list","kafka_topic"],"properties":{"batch_max_size":{"type":"integer","default":1000,"minimum":1},"include_req_body":{"type":"boolean","default":false},"disable":{"type":"boolean"},"timeout":{"type":"integer","default":3,"minimum":1},"meta_format":{"type":"string","default":"default","enum":["default","origin"]},"name":{"type":"string","default":"kafka logger"},"broker_list":{"type":"object"},"key":{"type":"string"},"kafka_topic":{"type":"string"},"max_retry_count":{"type":"integer","default":0,"minimum":0},"retry_delay":{"type":"integer","default":1,"minimum":0},"buffer_duration":{"type":"integer","default":60,"minimum":1},"inactive_timeout":{"type":"integer","default":5,"minimum":1}}}},"prometheus":{"version":0.2,"priority":500,"schema":{"type":"object","additionalProperties":false,"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"}}}},"wolf-rbac":{"type":"auth","version":0.1,"priority":2555,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"header_prefix":{"type":"string","default":"X-"},"server":{"type":"string","default":"http:\/\/127.0.0.1:10080"},"disable":{"type":"boolean"},"appid":{"type":"string","default":"unset"}}}},"serverless-pre-function":{"version":0.1,"priority":10000,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["functions"],"properties":{"phase":{"type":"string","default":"access","enum":["rewrite","access","header_filter","body_filter","log","balancer"]},"functions":{"type":"array","minItems":1,"items":{"type":"string"}},"disable":{"type":"boolean"}}}},"traffic-split":{"version":0.1,"priority":966,"schema":{"type":"object","additionalProperties":false,"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"rules":{"type":"array","items":{"type":"object","additionalProperties":false,"properties":{"match":{"type":"array","default":[{"vars":[["server_port",">",0]]}],"items":{"type":"object","properties":{"vars":{"type":"array"}}}},"weighted_upstreams":{"minItems":1,"maxItems":20,"default":[{"weight":1}],"type":"array","items":{"type":"object","properties":{"weight":{"type":"integer","description":"used to split traffic between differentupstreams for plugin configuration","default":1,"minimum":0},"upstream":{"properties":{"type":{"type":"string","description":"algorithms of load balancing","enum":["chash","roundrobin","ewma","least_conn"]},"id":{"anyOf":[{"type":"string","minLength":1,"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]},"name":{"type":"string","minLength":1,"maxLength":100},"key":{"type":"string","description":"the key of chash for dynamic load balancing"},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"read":{"type":"number","exclusiveMinimum":0},"send":{"type":"number","exclusiveMinimum":0},"connect":{"type":"number","exclusiveMinimum":0}}},"pass_host":{"type":"string","description":"mod of host passing","default":"pass","enum":["pass","node","rewrite"]},"hash_on":{"type":"string","default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"]},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"update_time":{"type":"integer"},"scheme":{"default":"http","enum":["grpc","grpcs","http","https"]},"labels":{"type":"object","description":"key\/value pairs to specify attributes","patternProperties":{".*":{"description":"value of label","maxLength":64,"type":"string","pattern":"^\\S+$","minLength":1}},"maxProperties":16},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"type":"integer","description":"weight of node","minimum":0}}},{"type":"array","items":{"type":"object","required":["host","port","weight"],"properties":{"metadata":{"type":"object","description":"metadata of node"},"weight":{"type":"integer","description":"weight of node","minimum":0},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"port":{"type":"integer","description":"port of node","minimum":1},"priority":{"type":"integer","description":"priority of node","default":0}}}}]},"checks":{"type":"object","additionalProperties":false,"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"properties":{"passive":{"type":"object","properties":{"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"healthy":{"type":"object","properties":{"successes":{"type":"integer","maximum":254,"default":5,"minimum":1},"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"items":{"type":"integer","maximum":599,"minimum":200}}}},"unhealthy":{"type":"object","properties":{"http_failures":{"type":"integer","maximum":254,"default":5,"minimum":1},"tcp_failures":{"type":"integer","maximum":254,"default":2,"minimum":1},"timeouts":{"type":"integer","maximum":254,"default":7,"minimum":1},"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[429,500,503],"items":{"type":"integer","maximum":599,"minimum":200}}}}}},"active":{"type":"object","properties":{"healthy":{"type":"object","properties":{"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[200,302],"items":{"type":"integer","maximum":599,"minimum":200}},"successes":{"type":"integer","maximum":254,"default":2,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1}}},"req_headers":{"type":"array","items":{"type":"string","uniqueItems":true},"minItems":1},"type":{"type":"string","default":"http","enum":["http","https","tcp"]},"unhealthy":{"type":"object","properties":{"http_failures":{"type":"integer","maximum":254,"default":5,"minimum":1},"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[429,404,500,501,502,503,504,505],"items":{"type":"integer","maximum":599,"minimum":200}},"timeouts":{"type":"integer","maximum":254,"default":3,"minimum":1},"tcp_failures":{"type":"integer","maximum":254,"default":2,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1}}},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"},"concurrency":{"type":"integer","default":10},"port":{"type":"integer","maximum":65535,"minimum":1},"http_path":{"type":"string","default":"\/"},"https_verify_certificate":{"type":"boolean","default":true},"timeout":{"type":"number","default":1}}}}},"desc":{"type":"string","maxLength":256},"create_time":{"type":"integer"},"retries":{"type":"integer","minimum":0},"service_name":{"type":"string","minLength":1,"maxLength":256},"discovery_type":{"type":"string","description":"discovery type"}},"additionalProperties":false,"type":"object","oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}]},"upstream_id":{"anyOf":[{"type":"string","minLength":1,"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$"},{"type":"integer","minimum":1}]}}}}}}}}}},"uri-blocker":{"version":0.1,"priority":2900,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["block_rules"],"properties":{"rejected_code":{"type":"integer","default":403,"minimum":200},"block_rules":{"type":"array","uniqueItems":true,"items":{"type":"string","minLength":1,"maxLength":4096}},"disable":{"type":"boolean"}}}},"request-validation":{"type":"validation","version":0.1,"priority":2800,"schema":{"type":"object","anyOf":[{"properties":{"body_schema":{"type":"object"}},"title":"Body schema","required":["body_schema"]},{"properties":{"header_schema":{"type":"object"}},"title":"Header schema","required":["header_schema"]}],"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"}}}},"api-breaker":{"version":0.1,"priority":1005,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["break_response_code"],"properties":{"healthy":{"type":"object","default":{"successes":3,"http_statuses":[200]},"properties":{"successes":{"type":"integer","default":3,"minimum":1},"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[200],"items":{"type":"integer","maximum":499,"minimum":200}}}},"max_breaker_sec":{"type":"integer","default":300,"minimum":3},"break_response_code":{"type":"integer","maximum":599,"minimum":200},"disable":{"type":"boolean"},"unhealthy":{"type":"object","default":{"failures":3,"http_statuses":[500]},"properties":{"failures":{"type":"integer","default":3,"minimum":1},"http_statuses":{"minItems":1,"uniqueItems":true,"type":"array","default":[500],"items":{"type":"integer","maximum":599,"minimum":500}}}}}}},"ip-restriction":{"version":0.1,"priority":3000,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"}},"oneOf":[{"properties":{"whitelist":{"type":"array","minItems":1,"items":{"anyOf":[{"type":"string","title":"IPv4","format":"ipv4"},{"type":"string","title":"IPv4\/CIDR","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"type":"string","title":"IPv6","format":"ipv6"},{"type":"string","title":"IPv6\/CIDR","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}]}}},"title":"whitelist","required":["whitelist"],"additionalProperties":false},{"properties":{"blacklist":{"type":"array","minItems":1,"items":{"anyOf":[{"type":"string","title":"IPv4","format":"ipv4"},{"type":"string","title":"IPv4\/CIDR","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"type":"string","title":"IPv6","format":"ipv6"},{"type":"string","title":"IPv6\/CIDR","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}]}}},"title":"blacklist","required":["blacklist"],"additionalProperties":false}]}},"response-rewrite":{"version":0.1,"priority":899,"schema":{"properties":{"body_base64":{"type":"boolean","description":"whether new body for response need base64 decode before return","default":false},"body":{"type":"string","description":"new body for response"},"status_code":{"type":"integer","description":"new status code for response","maximum":598,"minimum":200},"disable":{"type":"boolean"},"headers":{"type":"object","description":"new headers for response","minProperties":1},"vars":{"type":"array"}},"additionalProperties":false,"minProperties":1,"type":"object","$comment":"this is a mark for our injected plugin schema"}},"node-status":{"version":0.1,"priority":1000,"schema":{"type":"object","additionalProperties":false,"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"}}}},"referer-restriction":{"version":0.1,"priority":2990,"schema":{"properties":{"disable":{"type":"boolean"},"bypass_missing":{"type":"boolean","default":false},"whitelist":{"type":"array","minItems":1,"items":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._]+$"}}},"additionalProperties":false,"type":"object","required":["whitelist"],"$comment":"this is a mark for our injected plugin schema"}},"limit-count":{"version":0.4,"priority":1002,"schema":{"properties":{"key":{"type":"string","default":"remote_addr","enum":["remote_addr","server_addr","http_x_real_ip","http_x_forwarded_for","consumer_name","service_id"]},"policy":{"type":"string","default":"local","enum":["local","redis","redis-cluster"]},"rejected_code":{"type":"integer","maximum":599,"default":503,"minimum":200},"disable":{"type":"boolean"},"count":{"type":"integer","exclusiveMinimum":0},"time_window":{"type":"integer","exclusiveMinimum":0}},"type":"object","dependencies":{"policy":{"oneOf":[{"properties":{"policy":{"enum":["local"]}}},{"properties":{"redis_password":{"type":"string","minLength":0},"redis_database":{"type":"integer","default":0,"minimum":0},"redis_timeout":{"type":"integer","default":1000,"minimum":1},"policy":{"enum":["redis"]},"redis_host":{"type":"string","minLength":2},"redis_port":{"type":"integer","default":6379,"minimum":1}},"required":["redis_host"]},{"properties":{"redis_password":{"type":"string","minLength":0},"policy":{"enum":["redis-cluster"]},"redis_timeout":{"type":"integer","default":1000,"minimum":1},"redis_cluster_nodes":{"type":"array","items":{"type":"string","minLength":2,"maxLength":100},"minItems":2}},"required":["redis_cluster_nodes"]}]}},"required":["count","time_window"],"$comment":"this is a mark for our injected plugin schema"}},"serverless-post-function":{"version":0.1,"priority":-2000,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["functions"],"properties":{"phase":{"type":"string","default":"access","enum":["rewrite","access","header_filter","body_filter","log","balancer"]},"functions":{"type":"array","minItems":1,"items":{"type":"string"}},"disable":{"type":"boolean"}}}},"basic-auth":{"version":0.1,"priority":2520,"schema":{"properties":{"disable":{"type":"boolean"}},"additionalProperties":false,"type":"object","title":"work with route or service object","$comment":"this is a mark for our injected plugin schema"},"type":"auth","consumer_schema":{"properties":{"username":{"type":"string"},"password":{"type":"string"}},"additionalProperties":false,"type":"object","title":"work with consumer object","required":["username","password"]}},"limit-conn":{"version":0.1,"priority":1003,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["conn","burst","default_conn_delay","key"],"properties":{"burst":{"type":"integer","minimum":0},"key":{"type":"string","enum":["remote_addr","server_addr","http_x_real_ip","http_x_forwarded_for","consumer_name"]},"default_conn_delay":{"type":"number","exclusiveMinimum":0},"rejected_code":{"type":"integer","maximum":599,"default":503,"minimum":200},"disable":{"type":"boolean"},"conn":{"type":"integer","exclusiveMinimum":0}}}}}}
